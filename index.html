<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Classroom History Challenge</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Akaya+Kanadaka&family=Architects+Daughter&family=Montserrat:wght@400;700;900&family=VT323&display=swap" rel="stylesheet">
    <style>
        /* Basic Animations */
        @keyframes gradient-animation {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        @keyframes shake {
            0% { transform: translate(1px, 1px) rotate(0deg); }
            10% { transform: translate(-1px, -2px) rotate(-1deg); }
            20% { transform: translate(-3px, 0px) rotate(1deg); }
            30% { transform: translate(3px, 2px) rotate(0deg); }
            40% { transform: translate(1px, -1px) rotate(1deg); }
            50% { transform: translate(-1px, 2px) rotate(-1deg); }
            60% { transform: translate(-3px, 1px) rotate(0deg); }
            70% { transform: translate(3px, 1px) rotate(-1deg); }
            80% { transform: translate(-1px, -1px) rotate(1deg); }
            90% { transform: translate(1px, 2px) rotate(0deg); }
            100% { transform: translate(1px, -2px) rotate(-1deg); }
        }
        @keyframes jiggle {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-1px); }
            50% { transform: translateX(1px); }
            75% { transform: translateX(-1px); }
        }
        @keyframes glow {
            0% { text-shadow: 0 0 5px #fff, 0 0 10px #fff; }
            50% { text-shadow: 0 0 10px #fff, 0 0 20px #fff, 0 0 30px #fff; }
            100% { text-shadow: 0 0 5px #fff, 0 0 10px #fff; }
        }
        @keyframes pulse-glow {
            0% { box-shadow: 8px 8px 0px #92400e, 0 0 15px #f59e0b; }
            50% { box-shadow: 8px 8px 0px #92400e, 0 0 30px #f97316, 0 0 15px #f59e0b; }
            100% { box-shadow: 8px 8px 0px #92400e, 0 0 15px #f59e0b; }
        }
        @keyframes active-boost-wiggle {
            0%, 100% { transform: rotate(0); }
            25% { transform: rotate(-3deg); }
            50% { transform: rotate(3deg); }
            75% { transform: rotate(-3deg); }
        }
        @keyframes red-flash-animation {
            0% { background-color: transparent; }
            50% { background-color: rgba(239, 68, 68, 0.5); }
            100% { background-color: transparent; }
        }
        @keyframes passive-ready-glow {
            0% { box-shadow: 6px 6px 0px #15803d, 0 0 10px #4ade80; }
            50% { box-shadow: 6px 6px 0px #15803d, 0 0 20px #4ade80, 0 0 10px #4ade80; }
            100% { box-shadow: 6px 6px 0px #15803d, 0 0 10px #4ade80; }
        }
        @keyframes pulse-green {
            0% { transform: scale(1); box-shadow: 8px 8px 0px #14532d; }
            50% { transform: scale(1.02); box-shadow: 10px 10px 5px #14532d; }
            100% { transform: scale(1); box-shadow: 8px 8px 0px #14532d; }
        }
        @keyframes timer-flash-green {
            0%, 100% { color: white; }
            50% { color: #86efac; }
        }
        @keyframes scanline {
            0% { background-position: 0 0; }
            100% { background-position: 0 100%; }
        }
        @keyframes scan-line-anim {
            0% { top: -10%; }
            100% { top: 110%; }
        }
        @keyframes glitch-anim {
            0%, 95% {
                transform: translate(0, 0);
            }
            96% {
                transform: translate(-1px, 1px);
            }
            98% {
                transform: translate(1px, -1px);
            }
            100% {
                transform: translate(0, 0);
            }
        }

        @keyframes typing {
            from { width: 0; }
            to { width: 100%; }
        }


        @keyframes store-glow {
            0%, 100% { box-shadow: 4px 4px 0px #111827, 0 0 5px #f59e0b; }
            50% { box-shadow: 4px 4px 0px #111827, 0 0 20px #f97316, 0 0 10px #f59e0b; }
        }
        @keyframes store-jiggle {
            0%, 100% { transform: rotate(0); }
            25% { transform: rotate(-2deg); }
            50% { transform: rotate(2deg); }
            75% { transform: rotate(-2deg); }
        }
        .first-letter-btn-glow {
            overflow: hidden;
            white-space: nowrap;
            animation: typing 1s steps(60, end);
        }

        /* NEW MODAL ANIMATIONS */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes scaleUp {
            from {
                opacity: 0;
                transform: scale(0.95) translateY(10px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        /* NEW Game Mode Selector Grid */
        .mode-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            grid-template-columns: repeat(3, 1fr);
            width: 100%;
            margin: 0 auto;
        }
        .mode-card {
            background-color: var(--main-color, #f3f4f6);
            border: clamp(3px, 0.5vw, 5px) solid #111827;
            border-radius: 1rem;
            padding: clamp(0.5rem, 2vw, 1.25rem);
            text-align: left;
            color: white;
            cursor: pointer;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .mode-card:hover {
            transform: translateY(-10px) scale(1.03);
            box-shadow: 8px 8px 0px var(--shadow-color, #111827);
        }
        .mode-card.simple:hover {
            transform: translateY(-10px) scale(1.03);
            box-shadow: 8px 8px 0px var(--shadow-color, #111827);
        }
        .mode-card h3 {
            font-family: 'Akaya Kanadaka', cursive;
            font-size: clamp(1rem, 2.5vw, 1.75rem);
            border-bottom: clamp(3px, 0.4vw, 4px) solid rgba(255, 255, 255, 0.5);
            padding-bottom: clamp(0.25rem, 1vh, 0.5rem);
            margin-bottom: clamp(0.5rem, 1.5vh, 0.75rem);
            color: white;
        }
        .mode-card.simple h3 {
            font-size: clamp(1.5rem, 4vw, 2.25rem);
            border-bottom: none;
            padding-bottom: 0;
            margin-bottom: 0;
            text-align: center;
        }
        .mode-card h3 span.text-5xl { /* Target the emoji specifically */
            font-size: clamp(1.5rem, 4vw, 2.75rem);
        }
        .mode-details {
            font-size: clamp(0.6rem, 1.8vw, 0.85rem);
            line-height: 1.4;
        }
        .mode-grid {
            gap: clamp(0.5rem, 1.5vw, 1rem);
        }
        .mode-details .detail-row {
            display: flex;
            justify-content: space-between;
            padding: clamp(0.1rem, 0.4vh, 0.2rem) 0;
        }

        /* General Body and Layout */
        body {
            font-family: 'Montserrat', sans-serif;
            color: #111827;
            background: linear-gradient(-45deg, #f97316, #c026d3, #0ea5e9, #10b981);
            background-size: 400% 400%;
            animation: gradient-animation 15s ease infinite;
            overflow: hidden;
            height: 100vh;
            width: 100vw;
        }
        .red-flash::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            animation: red-flash-animation 0.5s ease-in-out;
            z-index: -1;
        }
        .main-container {
            display: grid;
            grid-template-columns: 3fr 1fr;
            grid-template-rows: auto 1fr;
            gap: clamp(0.5rem, 2vh, 1.5rem);
            padding: clamp(0.5rem, 2vh, 1.5rem);
            height: 100%;
            min-height: 0;
        }
        .header-grid {
            grid-column: 1 / -1;
            display: grid;
            grid-template-columns: 1.5fr 2.5fr 1.5fr 1.5fr 2fr;
            gap: clamp(0.5rem, 2vw, 1.5rem);
        }
        .right-panel {
            display: flex;
            flex-direction: column;
            gap: clamp(0.5rem, 2vh, 1.5rem);
            min-height: 0;
        }

        /* Stacked Streak/Correct Cards */
        .streak-correct-stack {
            display: flex;
            flex-direction: column;
            gap: clamp(0.25rem, 1vh, 0.75rem);
            min-height: 0;
        }
        .streak-correct-stack .card {
            flex: 1; /* Allow cards to grow and fill the space */
            padding: clamp(0.1rem, 0.5vw, 0.25rem); /* Reduced padding */
        }
        .streak-correct-stack .card h2 {
            font-size: clamp(0.6rem, 1.2vw, 0.9rem); /* Smaller title */
            margin-bottom: 0;
        }
        .streak-correct-stack .card .content {
            font-size: clamp(1rem, 2vw, 1.5rem); /* Smaller content font */
            line-height: 1;
        }

        /* Card Styles */
        .card {
            border: 6px solid #111827;
            border-radius: 1.5rem;
            padding: clamp(0.5rem, 1vw, 1rem);
            box-shadow: 8px 8px 0px #111827;
            text-align: center;
            font-weight: 700;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-color: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(10px);
        }
        .card h2 {
            font-family: 'Montserrat', sans-serif;
            font-weight: 900;
            text-transform: uppercase;
            font-size: clamp(0.7rem, 1.5vw, 1.1rem);
            margin-bottom: 0.25rem;
            color: rgba(0,0,0,0.6);
        }
        .card.time-card h2, .card.score-card h2, .card.streak-card h2, .card.correct-card h2 {
            color: rgba(255,255,255,0.7);
        }
        .card .content {
            font-family: 'Architects Daughter', cursive;
            font-size: clamp(1.5rem, 3vw, 2.5rem);
            line-height: 1.1;
        }
        .time-card { background-color: #ef4444; color: white; border-color: #991b1b; box-shadow: 8px 8px 0px #991b1b;}
        .time-card.flash-green { animation: timer-flash-green 0.5s ease-in-out 2; }
        .score-card { background-color: #22c55e; color: white; border-color: #14532d; box-shadow: 8px 8px 0px #14532d; animation: pulse-green 2s infinite ease-in-out;}
        .score-card .content {
            font-size: clamp(2rem, 4vw, 3.5rem);
            font-weight: 900;
            text-shadow: 3px 3px 0px rgba(0,0,0,0.2);
        }
        .streak-card { background-color: #a855f7; color: white; border-color: #5b21b6; box-shadow: 8px 8px 0px #5b21b6;}
        .correct-card { background-color: #2dd4bf; color: white; border-color: #0d9488; box-shadow: 8px 8px 0px #0d9488;}
        
        /* Header Buttons */
        .button-cluster {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: clamp(0.25rem, 1vh, 0.5rem);
            padding: 0; background: transparent; border: none; box-shadow: none; align-content: center;
        }
        .header-btn {
            color: white; border: 4px solid #111827; border-radius: 1rem; padding: 0.5rem;
            font-size: clamp(0.7rem, 2vh, 1rem); font-weight: 900; cursor: pointer; transition: all 0.2s;
            box-shadow: 4px 4px 0px #111827;
        }
        .header-btn:hover { transform: translate(2px, 2px); box-shadow: 2px 2px 0px #111827; }
        #storeBtn { background-color: #f59e0b; }
        #endTurnBtn { background-color: #8b5cf6; }
        #storeBtn.store-ready {
            animation: store-glow 1.5s infinite, store-jiggle 0.4s infinite;
        }
        #resetAllBtn { background-color: #ec4899; }
        #aboutBtn { background-color: #10b981; }

        /* Question Area */
        .question-container {
            background-color: #334155; border-color: #111827; box-shadow: 8px 8px 0px #111827;
            display: flex; flex-direction: column; gap: clamp(0.5rem, 2vh, 1.5rem);
            transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
            min-height: 0;
        }
        .question-container.switching { opacity: 0; transform: scale(0.95); }
        .question-container.shake { animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both; }
        .question-box {
            background-color: #fde047; border-color: #ca8a04; box-shadow: 8px 8px 0px #ca8a04;
            padding: 1.5rem; flex: 1 1 0; display: flex; flex-direction: column; align-items: center; justify-content: space-between; gap: 1rem;
        }
        #questionText { 
            flex-grow: 1; 
            /* font-size is now set by JS */
            text-align: center; 
            user-select: none;
            -webkit-user-select: none;
            -ms-user-select: none;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.1;
            padding: 0;
            margin: 0;
        }
        #hintBtn {
            background-color: #fb923c; border: 4px solid #c2410c; box-shadow: 4px 4px 0px #c2410c;
            border-radius: 50%; width: clamp(40px, 5vw, 60px); height: clamp(40px, 5vw, 60px); font-size: 1.5rem; font-weight: 900;
            flex-shrink: 0; cursor: pointer; transition: all 0.2s;
        }
        #hintBtn:hover { transform: translate(2px, 2px); box-shadow: 2px 2px 0px #c2410c; }
        .answer-grid { 
            display: grid; grid-template-columns: 1fr 1fr; gap: clamp(0.5rem, 2vh, 1.5rem); 
            flex: 2 1 0; min-height: 0;
        }
        .answer-choice {
            background-color: #f59e0b; border-color: #92400e; box-shadow: 8px 8px 0px #92400e;
            cursor: pointer; transition: all 0.2s; display: flex; align-items: center;
            justify-content: center; padding: clamp(0.5rem, 2vh, 1rem);
            font-size: clamp(0.8rem, 2.5vh, 1.5rem);
            font-weight: 900;
        }
        .answer-choice:hover { transform: translate(4px, 4px); box-shadow: 4px 4px 0px #92400e; }
        .answer-choice.removed { 
            opacity: 0.3; cursor: not-allowed; background-color: #9ca3af; 
            border-color: #4b5563; box-shadow: none; transform: none; 
        }
        .correct { background-color: #22c55e !important; color: white !important; border-color: #14532d !important; box-shadow: 8px 8px 0px #14532d !important; }
        .incorrect { background-color: #ef4444 !important; color: white !important; border-color: #991b1b !important; box-shadow: 8px 8px 0px #991b1b !important; }

        /* Abilities Section */
        .abilities-container {
            background-color: #fde047; border-color: #ca8a04; box-shadow: 8px 8px 0px #ca8a04;
            padding: clamp(0.5rem, 1.5vw, 1rem);
            flex: 1 1 0; 
            min-height: 0; 
            display: flex; 
            flex-direction: column;
        }
        .abilities-title {
            font-family: 'Akaya Kanadaka', cursive; 
            font-size: clamp(1rem, 3.5vw, 1.75rem); 
            padding-bottom: clamp(0.1rem, 1vh, 0.25rem);
            margin-bottom: clamp(0.25rem, 1vh, 0.5rem); 
            color: #ca8a04;
            width: 100%;
            text-align: center;
            flex-shrink: 0;
        }
        .abilities-layout {
            display: flex;
            flex-direction: column;
            gap: clamp(0.5rem, 1.5vh, 1rem); 
            width: 100%;
            flex-grow: 1;
            min-height: 0;
            /* Distribute space to fill the container vertically */
            justify-content: space-around;
        }
        .top-abilities {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: clamp(0.25rem, 1vh, 0.5rem);
        }
        .ability-btn {
            background-color: #fefce8; border: 4px solid #eab308; box-shadow: 4px 4px 0px #eab308;
            padding: clamp(0.1rem, 1vh, 0.5rem);
            transition: all 0.2s; border-radius: 1rem; font-weight: 900; line-height: 1.2;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            position: relative;
            width: 100%;
            font-size: clamp(0.6rem, 2vh, 0.9rem); 
            /* Allow buttons to grow to fill space */
            flex-grow: 1;
            flex-shrink: 1;
        }
        .ability-btn.locked { opacity: 0.5; cursor: not-allowed; background-color: #e2e8f0; }
        .ability-btn.earned { cursor: pointer; }
        .ability-btn.earned:hover { transform: translateY(-2px); box-shadow: 6px 6px 0px #eab308; }
        .ability-btn.active { border-color: #92400e; }
        #abilityBoost {
            font-size: clamp(0.7rem, 2.5vh, 1.1rem); 
        }
        #abilityBoost.active:not(.locked) {
            animation: pulse-glow 1.5s infinite, active-boost-wiggle 0.5s ease-in-out infinite;
        }
        .ability-btn .uses {
            position: absolute; top: -10px; right: -10px; background-color: #dc2626; color: white;
            border-radius: 50%; display: flex; justify-content: center; align-items: center; 
            width: clamp(18px, 3vh, 24px); height: clamp(18px, 3vh, 24px); top: clamp(-12px, -1.5vh, -8px); right: clamp(-12px, -1.5vh, -8px);
            font-size: clamp(0.6rem, 1.5vh, 0.875rem); font-weight: 900; border: 2px solid white;
        }
        #abilityInfoBtn {
            background-color: #fb923c; border-color: #c2410c; box-shadow: 4px 4px 0px #c2410c;
            color: white; 
            font-size: clamp(0.7rem, 2.5vh, 1rem); 
        }
        .passive-abilities-container {
             display: flex; flex-direction: column; gap: clamp(0.1rem, 1vh, 0.25rem);
             /* Allow this container to grow */
             flex-grow: 1;
             justify-content: space-around;
        }
        .passive-ability {
            background-color: #dcfce7; border: 4px solid #16a34a; box-shadow: 6px 6px 0px #15803d;
            border-radius: 1rem; padding: clamp(0.2rem, 1vh, 0.5rem); text-align: left; position: relative;
            width: 100%;
            transition: transform 0.2s;
        }
        .passive-ability.jiggle {
            animation-name: jiggle; /* lgtm [js/useless-assignment-to-local] */
            animation-iteration-count: infinite;
        }
        .passive-ability.ready { animation: passive-ready-glow 1.5s infinite; } 
        .passive-ability-title { font-weight: 900; font-size: clamp(0.6rem, 1.8vh, 0.8rem); line-height: 1.2; }
        .progress-bar-container {
            width: 100%; background-color: #a7f3d0; border-radius: 0.5rem;
            height: clamp(0.75rem, 2vh, 1rem); border: 2px solid #15803d;
        }
        .progress-bar {
            background-color: #22c55e; height: 100%; border-radius: 0.25rem;
            transition: width 0.3s ease-in-out;
        }
        .panther-buck-counter {
            position: absolute; top: -10px; right: -10px; background-color: #a855f7;
            color: white; border-radius: 0.75rem; padding: 0.1rem 0.5rem;
            font-size: clamp(0.75rem, 1.5vh, 0.875rem); font-weight: 900; border: 2px solid white;
        }

        /* Notification Panel */
        #notificationPanel {
            background: #1e293b;
            border: 6px solid #111827;
            box-shadow: 8px 8px 0px #111827, inset 0 0 15px rgba(0,0,0,0.5);
            border-radius: 1.5rem;
            padding: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
            background-image: linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px);
            background-size: 100% 2px;
        }
        #notificationPanel::after {
            content: '';
            position: absolute;
            left: 0;
            width: 100%;
            height: 3px;
            background: rgba(147, 197, 253, 0.5);
            box-shadow: 0 0 10px rgba(147, 197, 253, 0.8);
            animation: scan-line-anim 3s linear infinite;
        }
        #notificationPanel { height: clamp(80px, 12vh, 120px); }
        #notificationText {
            font-family: 'VT323', monospace;
            font-size: clamp(1.1rem, 3vh, 1.5rem);
            color: #93c5fd;
            text-shadow: 0 0 3px #2563eb, 0 0 5px #2563eb;
            width: 100%;
            /* The glitch animation is now applied via a class */
        }
        #notificationText.glitch {
             animation: glitch-anim 4s linear infinite;
        }
        #notificationText.typing {
            display: inline-block; /* Prevent collapsing and allow width animation */
            width: 100%; /* Ensure it doesn't try to exceed its container */
            max-width: 100%;
            overflow: hidden;
            white-space: nowrap;
            animation: typing 1s steps(60, end);
        }
        #notificationText::before, #notificationText::after {
            content: attr(data-text); position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: none;
        }
        /* Modals */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.7); display: flex;
            justify-content: center; align-items: center; z-index: 100;
            padding: 1rem;
            animation: fadeIn 0.3s ease-out; /* MODIFIED */
        }
        .modal-content {
            background-color: white; padding: clamp(1rem, 3vw, 2rem); border-radius: 1.5rem;
            border: clamp(4px, 1vw, 6px) solid #111827;
            box-shadow: clamp(4px, 1vw, 8px) clamp(4px, 1vw, 8px) 0px #111827;
            text-align: left; max-width: min(90vw, 900px); /* General max-width for all modals */
            display: flex;
            max-height: 95vh; /* Responsive max-height */
            overflow-y: auto; /* Allow content to scroll if it overflows vertically */
            flex-direction: column;
            animation: scaleUp 0.3s ease-out; /* MODIFIED */
        }
        .modal-content h2 { font-family: 'Akaya Kanadaka', cursive; text-align: center; }
        .modal-button {
            margin: 0.5rem; padding: clamp(0.5rem, 2vw, 0.75rem) clamp(1rem, 4vw, 2rem); border-radius: 0.75rem;
            border: clamp(3px, 0.5vw, 4px) solid #111827; font-weight: 700; cursor: pointer; transition: all 0.2s;
        }
        .modal-button:hover { transform: translate(4px, 4px); box-shadow: none; }

        #abilityInfoModal .space-y-4 {
            overflow-y: auto;
            padding-right: 1rem;
        }
        /* Store Modal */
        #storeModal .modal-content {
            max-width: 900px;
        }
        .store-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 4px solid #111827;
            padding-bottom: 1rem;
            margin-bottom: 1.5rem;
        }
        .store-score {
            font-size: 1.5rem;
            font-weight: 900;
            background-color: #fde047;
            padding: 0.5rem 1rem;
            border-radius: 1rem;
            border: 4px solid #ca8a04;
        }
        .store-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
            padding: 0.5rem;
            overflow-y: auto;
        }
        .store-item {
            background-color: #f3f4f6;
            border: 4px solid #4b5563;
            box-shadow: 6px 6px 0px #4b5563;
            border-radius: 1.5rem;
            padding: 1rem;
            text-align: center;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            transition: all 0.2s;
        }
        .store-item:hover {
            transform: translateY(-4px);
            box-shadow: 8px 8px 0px #4b5563;
        }
        .store-item-icon {
            font-size: 3rem;
            line-height: 1;
        }
        .store-item-title {
            font-weight: 900;
            font-size: 1.1rem;
            margin-top: 0.5rem;
        }
        .store-item-desc {
            font-size: 0.8rem;
            margin: 0.5rem 0;
            flex-grow: 1;
        }
        .buy-btn {
            background-color: #22c55e;
            color: white;
            border: 4px solid #14532d;
            box-shadow: 4px 4px 0 #14532d;
            font-weight: 900;
            padding: 0.5rem 1rem;
            border-radius: 1rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        .buy-btn:hover {
            transform: translate(2px, 2px);
            box-shadow: 2px 2px 0 #14532d;
        }
        .buy-btn:disabled {
            background-color: #9ca3af;
            border-color: #4b5563;
            box-shadow: 4px 4px 0 #4b5563;
            cursor: not-allowed;
            transform: none;
        }
        .buy-btn.purchased {
            background-color: #a855f7;
            border-color: #5b21b6;
            box-shadow: 4px 4px 0 #5b21b6;
            cursor: default;
        }


        /* FIXES FOR LAYOUT AND TIMER */
        #timer {
            font-family: 'VT323', monospace;
        }
        #notificationPanel {
            flex-shrink: 0; 
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .main-container { grid-template-columns: 1fr; height: auto; overflow-y: auto; }
            .header-grid { grid-template-columns: 1fr 1fr; grid-template-rows: auto auto; }
            .button-cluster { grid-column: 1 / -1; flex-direction: row; grid-row: 3; }
            .right-panel { flex-direction: column; }
            .store-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 1rem;
            }
        .header-grid {
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
        }
        .button-cluster { flex-wrap: wrap; justify-content: center; }
        }

        @media (max-width: 640px) {
            .mode-grid {
                grid-template-columns: repeat(2, 1fr); /* Revert to 2 columns on small screens */
            }


            .modal-content {
                padding: 1rem;
            }
            .store-header {
                padding-bottom: 0.5rem;
                margin-bottom: 1rem;
            }
            .store-header h2 {
                font-size: 1.75rem;
            }
            .store-score {
                font-size: 1rem;
                padding: 0.25rem 0.5rem;
            }
            .store-grid {
                gap: 0.5rem;
            }
            .store-item {
                padding: 0.5rem;
                border-radius: 1rem;
            }
            .store-item-icon {
                font-size: 2rem;
            }
            .store-item-title {
                font-size: 0.8rem;
            }
            .store-item-desc {
                font-size: 0.75rem;
                margin: 0.5rem 0;
            }
            .buy-btn {
                padding: 0.4rem;
                font-size: 0.8rem;
                border-radius: 0.75rem;
            }
            .passive-ability-title {
                font-size: clamp(0.7rem, 1.8vh, 0.9rem);
            }
            .progress-bar-container { height: clamp(0.85rem, 2vh, 1.1rem); }
        }

        /* SIGMA Progress Bar */
        #sigmaProgressContainer {
            background-color: #374151;
            border: 4px solid #111827;
            box-shadow: 6px 6px 0px #111827;
            border-radius: 1rem;
            padding: clamp(0.25rem, 1vh, 0.5rem);
            text-align: center;
            margin-bottom: clamp(0.25rem, 1vh, 0.5rem);
            width: 100%;
        }
        .sigma-progress-title {
            font-weight: 900;
            font-size: clamp(0.7rem, 2vh, 0.9rem);
            color: white;
            text-transform: uppercase;
        }
        #sigmaProgressText {
            font-family: 'VT323', monospace;
            font-size: clamp(0.8rem, 2.2vh, 1rem);
            color: #d1d5db;
        }
        #dokLabel {
            font-size: clamp(0.7rem, 1.8vh, 0.9rem);
            font-weight: 700;
            color: rgba(0,0,0,0.5);
            background-color: rgba(255,255,255,0.5);
            padding: 0.4rem 0.6rem;
            border-radius: 0.5rem;
            border: 2px solid rgba(0,0,0,0.2);
            user-select: none;
        }
    </style>
</head>
<body>

     <div id="difficultyModal" class="modal-overlay">
        <div class="modal-content" style="text-align: center; background-color: #f9fafb;">
            <h2 class="text-4xl font-bold mb-6" style="font-family: 'Akaya Kanadaka', cursive; font-size: clamp(1.75rem, 4vw, 2.5rem);">Choose Your Challenge</h2>
            <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                <!-- Easy Mode -->
                <div id="easyModeBtn" class="mode-card simple" style="--main-color: #3b82f6; --shadow-color: #1d4ed8;">
                    <h3 class="flex flex-col items-center gap-2">
                        <span class="text-5xl">üòä</span>
                        <span>Easy</span>
                    </h3>
                </div>
                <!-- Myth Debunker Mode -->
                <div id="mythModeBtn" class="mode-card simple" style="--main-color: #eab308; --shadow-color: #713f12;">
                    <h3 class="flex flex-col items-center gap-2">
                        <span class="text-5xl">ü§î</span>
                        <span>Myth Debunker</span>
                    </h3>
                </div>
                <!-- Hard Mode -->
                <div id="hardModeBtn" class="mode-card simple" style="--main-color: #f97316; --shadow-color: #9a3412;">
                    <h3 class="flex flex-col items-center gap-2">
                        <span class="text-5xl">üî•</span>
                        <span>Hard</span>
                    </h3>
                </div>
                <!-- Skibidi Mode -->
                <div id="skibidiModeBtn" class="mode-card simple" style="--main-color: #a855f7; --shadow-color: #5b21b6;">
                    <h3 class="flex flex-col items-center gap-2">
                        <span class="text-5xl">‚å®Ô∏è</span>
                        <span>Skibidi</span>
                    </h3>
                </div>
                <!-- Sigma Mode -->
                <div id="sigmaModeBtn" class="mode-card simple col-span-2" style="--main-color: #374151; --shadow-color: #111827;">
                    <h3 class="flex flex-col items-center gap-2">
                        <span class="text-5xl">‚ö°</span>
                        <span>Sigma</span>
                    </h3>
                </div>
            </div>
        </div>
    </div>

    <div id="easyRulesModal" class="modal-overlay hidden">
        <div class="modal-content">
            <h2 class="text-4xl font-bold mb-4">Welcome to Easy Mode! üòä</h2>
            <div class="space-y-4 text-lg">
                <p>The classic way to play. Perfect for learning the ropes or a casual game.</p>
                <ul class="list-disc list-inside ml-4 space-y-2">
                    <li><strong>Question Type:</strong> Standard Multiple Choice.</li>
                    <li><strong>Time Limit:</strong> 5:00 minutes.</li>
                    <li><strong>Abilities:</strong> Earned at a standard rate.</li>
                </ul>
                <p class="font-bold text-center mt-4">Ready to start?</p>
            </div>
            <div class="flex justify-center mt-6">
                <button id="acceptEasyBtn" class="modal-button bg-green-500 text-white" style="box-shadow: 4px 4px 0px #111827;">Let's Go!</button>
                <button id="declineEasyBtn" class="modal-button bg-gray-500 text-white" style="box-shadow: 4px 4px 0px #111827;">Go Back</button>
            </div>
        </div>
    </div>

    <div id="hardRulesModal" class="modal-overlay hidden">
        <div class="modal-content">
            <h2 class="text-4xl font-bold mb-4">Welcome to Hard Mode! üî•</h2>
            <div class="space-y-4 text-lg">
                <p>Face tougher, analytical questions that require deeper historical knowledge.</p>
                <ul class="list-disc list-inside ml-4 space-y-2">
                    <li><strong>Question Type:</strong> Analytical Multiple Choice Questions (DOK 2-6).</li>
                    <li><strong>Time Limit:</strong> 5:00 minutes.</li>
                    <li><strong>Panther Buck Streak:</strong> Earned at a <strong>7-streak</strong> (instead of 10).</li>
                </ul>
                <p class="font-bold text-center mt-4">Think you can handle the heat?</p>
            </div>
            <div class="flex justify-center mt-6">
                <button id="acceptHardBtn" class="modal-button bg-green-500 text-white" style="box-shadow: 4px 4px 0px #111827;">Bring it On!</button>
                <button id="declineHardBtn" class="modal-button bg-gray-500 text-white" style="box-shadow: 4px 4px 0px #111827;">Go Back</button>
            </div>
        </div>
    </div>

    <div id="explanationModal" class="modal-overlay hidden">
        <div class="modal-content border-yellow-500" style="background-color: #fffbeb; text-align: center; overflow-y: auto;">
            <h2 class="text-4xl font-bold mb-4 text-yellow-600">The Real Story... ü§î</h2>
            <p id="explanationText" class="text-xl mb-6 bg-white p-4 rounded-lg border-2 border-yellow-300"></p>
            <button id="closeExplanationBtn" class="modal-button bg-yellow-500 text-white" style="box-shadow: 4px 4px 0px #713f12;">Continue</button>
        </div>
    </div>

    <div id="skibidiRulesModal" class="modal-overlay hidden">
        <div class="modal-content">
            <h2 class="text-4xl font-bold mb-4">Welcome to Skibidi Mode!</h2>
            <div class="space-y-4 text-lg">
                <p>This is the ultimate challenge! Here are the new rules:</p>
                <ul class="list-disc list-inside ml-4 space-y-2">
                    <li><strong>Type Your Answers:</strong> No more multiple choice! You must type the correct word or phrase. Spelling counts!</li>
                    <li><strong>Faster Abilities:</strong> To make it fair, most abilities are earned <strong>faster</strong>.
                        <ul class="list-decimal list-inside ml-6">
                            <li>Time Tinkerer: 2-streak (was 4)</li>
                            <li>Panther Bucks: 5-streak (was 10-streak)</li>
                            <li>Skip: 2-streak (was 3)</li>
                            <li>Redo: 3-streak (was 5)</li>
                            <li>2x Boost: 4-streak (was 7)</li>
                        </ul>
                    </li>
                    <li><strong>No More Hunch:</strong> The "Historian's Hunch" passive ability is disabled in this mode. You're on your own!</li>
                </ul>
                <p class="font-bold text-center mt-4">Are you ready for the challenge?</p>
            </div>
            <div class="flex justify-center mt-6">
                <button id="acceptSkibidiBtn" class="modal-button bg-green-500 text-white" style="box-shadow: 4px 4px 0px #111827;">I Accept</button>
                <button id="declineSkibidiBtn" class="modal-button bg-gray-500 text-white" style="box-shadow: 4px 4px 0px #111827;">Go Back</button>
            </div>
        </div>
    </div>

    <div id="mythRulesModal" class="modal-overlay hidden">
        <div class="modal-content">
            <h2 class="text-4xl font-bold mb-4">Welcome to Myth Debunker Mode!</h2>
            <div class="space-y-4 text-lg">
                <p>This mode challenges your knowledge of historical truths!</p>
                <ul class="list-disc list-inside ml-4 space-y-2">
                    <li><strong>Fact or Myth:</strong> Questions will present a statement, and you'll decide if it's a historical fact or a common myth.</li>
                    <li><strong>Explanations:</strong> After each question, you'll receive a detailed explanation, whether you're right or wrong, to help you learn the real story.</li>
                    <li><strong>No Hints:</strong> The standard hint button is disabled in this mode, as the explanation serves a similar purpose.</li>
                </ul>
                <p class="font-bold text-center mt-4">Are you ready to debunk some myths?</p>
            </div>
            <div class="flex justify-center mt-6">
                <button id="acceptMythBtn" class="modal-button bg-green-500 text-white" style="box-shadow: 4px 4px 0px #111827;">I Accept</button>
                <button id="declineMythBtn" class="modal-button bg-gray-500 text-white" style="box-shadow: 4px 4px 0px #111827;">Go Back</button>
            </div>
        </div>
    </div>


    <div id="sigmaRulesModal" class="modal-overlay hidden">
        <div class="modal-content">
            <h2 class="text-4xl font-bold mb-4">Welcome to Sigma Mode!</h2>
            <div class="space-y-4 text-lg">
                <p>This is a test of speed and knowledge. Here are the rules:</p>
                <ul class="list-disc list-inside ml-4 space-y-2">
                    <li><strong>Beat the Clock:</strong> You start with only <strong>60 seconds</strong>. There is no time limit!</li>
                    <li><strong>Advance Through Stages:</strong> Survive three increasingly difficult stages.</li>
                    <li><strong>Stage 1 (Easy):</strong> Answer all Easy questions. Earn <strong>+15 seconds</strong> per correct answer.</li>
                    <li><strong>Stage 2 (Hard):</strong> Answer all Hard questions. Earn <strong>+20 seconds</strong> per correct answer.</li>
                    <li><strong>Stage 3 (Skibidi):</strong> Answer all Skibidi (typed) questions. Earn <strong>+25 seconds</strong> per correct answer.</li>
                </ul>
                <p class="font-bold text-center mt-4">Can you survive the ultimate challenge?</p>
            </div>
            <div class="flex justify-center mt-6">
                <button id="acceptSigmaBtn" class="modal-button bg-green-500 text-white" style="box-shadow: 4px 4px 0px #111827;">I Accept</button>
                <button id="declineSigmaBtn" class="modal-button bg-gray-500 text-white" style="box-shadow: 4px 4px 0px #111827;">Go Back</button>
            </div>
        </div>
    </div>

    <div id="gradeModal" class="modal-overlay hidden">
        <div class="modal-content" style="text-align: center;">
            <h2 class="text-4xl font-bold mb-4">Select Grade Level</h2>
            <div class="mb-4">
                <select id="gradeLevelSelect" class="w-full p-3 text-xl border-4 border-gray-800 rounded-xl">
                    <option value="grade6">6th Grade</option>
                    <option value="grade7">7th Grade</option>
                    <option value="grade8" selected>8th Grade</option>
                </select>
            </div>
            <div class="flex justify-center gap-4 mt-6">
                <button id="backToDifficultyBtn" class="modal-button bg-gray-500 text-white" style="box-shadow: 4px 4px 0px #111827;">Back</button>
                <button id="startGameBtn" class="modal-button bg-green-500 text-white" style="box-shadow: 4px 4px 0px #111827;">Start Game!</button>
            </div>
        </div>
    </div>

    <div id="storeModal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="store-header">
                <h2 class="text-4xl font-bold">Power-Up Store</h2>
                <div class="store-score">
                    Points: <span id="storeScoreDisplay">0</span>
                </div>
            </div>
            <div class="store-grid">
                <div class="store-item">
                    <div>
                        <div class="store-item-icon">üßä</div>
                        <h3 class="store-item-title">Time Freeze</h3>
                        <p class="store-item-desc">Adds 30 seconds to the clock.</p>
                    </div>
                    <button class="buy-btn" data-item="timeFreeze">Buy (3 Pts)</button>
                </div>
                 <div class="store-item">
                    <div>
                        <div class="store-item-icon">‚è≥</div>
                        <h3 class="store-item-title">Time Boost</h3>
                        <p class="store-item-desc">Adds 60 seconds to the clock.</p>
                    </div>
                    <button class="buy-btn" data-item="timeBoost">Buy (8 Pts)</button>
                </div>
                <div class="store-item">
                    <div>
                        <div class="store-item-icon">üï∞Ô∏è</div>
                        <h3 class="store-item-title">Chronos's Reserve</h3>
                        <p class="store-item-desc">Rewinds the timer 60 seconds. Instant use.</p>
                    </div>
                    <button class="buy-btn" data-item="chronosReserve">Buy (10 Pts)</button>
                </div>
                <div class="store-item">
                    <div>
                        <div class="store-item-icon">ü§ù</div>
                        <h3 class="store-item-title">Diplomat's Pass</h3>
                        <p class="store-item-desc">Next hint won't pause the timer. One-time use.</p>
                    </div>
                    <button class="buy-btn" data-item="diplomatsPass">Buy (8 Pts)</button>
                </div>
                <div class="store-item">
                    <div id="hunchUpgradeStoreItem">
                        <div class="store-item-icon">‚ú®</div>
                        <h3 class="store-item-title">Hunch Upgrade</h3>
                        <p class="store-item-desc">Permanent: Hunch removes 2 wrong answers.</p>
                    </div>
                    <div id="firstLastLetterStoreItem" class="hidden">
                        <div class="store-item-icon">üî†</div>
                        <h3 class="store-item-title">Letter Insight</h3>
                        <p class="store-item-desc">Permanent: The letter hint shows the first AND last letter of the answer.</p>
                    </div>
                    <button class="buy-btn" data-item="hunchUpgrade">Buy (15 Pts)</button>
                </div>
                <div class="store-item">
                    <div>
                        <div class="store-item-icon">üõ°Ô∏è</div>
                        <h3 class="store-item-title">Streak Insurance</h3>
                        <p class="store-item-desc">Save your streak from one mistake. One-time use.</p>
                    </div>
                    <button class="buy-btn" data-item="streakInsurance">Buy (5 Pts)</button>
                </div>
                <div class="store-item">
                    <div>
                        <div class="store-item-icon">üîñ</div>
                        <h3 class="store-item-title">Scholar's Bookmark</h3>
                        <p class="store-item-desc">Instantly grants one use of the "SKIP" ability.</p>
                    </div>
                    <button class="buy-btn" data-item="scholarsBookmark">Buy (4 Pts)</button>
                </div>
                 <div class="store-item">
                    <div>
                        <div class="store-item-icon">üìú</div>
                        <h3 class="store-item-title">Lore Master's Scroll</h3>
                        <p class="store-item-desc">Permanent: Correct answers are worth 1.25 points.</p>
                    </div>
                    <button class="buy-btn" data-item="loreMastersScroll">Buy (25 Pts)</button>
                </div>
            </div>
            <div class="text-center mt-6">
                <button id="closeStoreBtn" class="modal-button bg-gray-500 text-white" style="box-shadow: 4px 4px 0px #111827;">Close</button>
            </div>
        </div>
    </div>


    <div id="endGameModal" class="modal-overlay hidden">
        <div class="modal-content" style="text-align: center;">
            <h2 class="text-5xl font-bold mb-4">Time's Up!</h2>
            <p class="text-3xl mb-2">You scored <span id="finalScore" class="font-bold text-green-500"></span> points!</p>
            <p id="mistakesReviewText" class="text-xl mb-6"></p>
            <div class="flex justify-center gap-4">
                <button id="reviewMistakesBtn" class="modal-button bg-yellow-500 text-white hidden" style="box-shadow: 4px 4px 0px #111827;">Review Mistakes</button>
                <button id="newGameBtn" class="modal-button bg-blue-500 text-white" style="box-shadow: 4px 4px 0px #111827;">Play Again</button>
            </div>
        </div>
    </div>
    <div id="reviewModal" class="modal-overlay hidden">
        <div class="modal-content" style="max-width: 800px;">
            <h2 class="text-4xl font-bold mb-4">Review Mistakes (<span id="reviewCounter"></span>)</h2>
            <div id="reviewContent" class="space-y-4 mb-6">
                <p id="reviewQuestion" class="text-xl font-bold bg-slate-200 p-4 rounded-lg"></p>
                <div id="reviewChoices" class="space-y-2"></div>
                <div id="reviewUserAnswer" class="hidden"><p class="text-lg">Your answer: <span id="reviewUserAnswerText" class="font-bold text-red-500"></span></p></div>
            </div>
            <div class="flex justify-between items-center"><button id="prevReviewBtn" class="modal-button bg-gray-400 text-white">Previous</button><button id="closeReviewBtn" class="modal-button bg-gray-500 text-white">Close</button><button id="nextReviewBtn" class="modal-button bg-gray-400 text-white">Next</button></div>
        </div>
    </div>
    <div id="aboutModal" class="modal-overlay hidden">
        <div class="modal-content" style="text-align: center;">
            <h2 class="text-4xl font-bold mb-4">About the Creator</h2>
            <p class="text-xl mb-6">This app was created by Mr. Lopez Torres, a Social Studies teacher at Woodlawn Middle School, to make learning history fun and interactive for his students. Go Panthers!</p>
            <button id="closeAboutBtn" class="modal-button bg-gray-500 text-white" style="box-shadow: 4px 4px 0px #111827;">Close</button>
        </div>
    </div>
    <div id="resetConfirmModal" class="modal-overlay hidden">
        <div class="modal-content" style="text-align: center;">
            <h2 class="text-4xl font-bold mb-4">Reset Game?</h2>
            <p class="text-xl mb-6">Are you sure? This will restart the game.</p>
            <div>
                <button id="confirmResetBtn" class="modal-button bg-red-500 text-white" style="box-shadow: 4px 4px 0px #111827;">Yes, Reset!</button>
                <button id="cancelResetBtn" class="modal-button bg-gray-500 text-white" style="box-shadow: 4px 4px 0px #111827;">Cancel</button>
            </div>
        </div>
    </div>
    <div id="hintModal" class="modal-overlay hidden">
        <div class="modal-content" style="text-align: center;">
            <h2 class="text-4xl font-bold mb-4">Here's a Hint!</h2>
            <p id="hintText" class="text-2xl mb-6"></p>
            <button id="closeHintBtn" class="modal-button bg-gray-500 text-white" style="box-shadow: 4px 4px 0px #111827;">Got it!</button>
        </div>
    </div>
    <div id="skibidiIncorrectModal" class="modal-overlay hidden">
        <div class="modal-content" style="text-align: center;">
            <h2 class="text-4xl font-bold mb-4 text-red-500">Incorrect</h2>
            <p class="text-xl mb-2">The correct answer was:</p>
            <p id="skibidiCorrectAnswerText" class="text-3xl font-bold mb-6 bg-yellow-200 p-2 rounded-lg"></p>
            <button id="closeSkibidiIncorrectBtn" class="modal-button bg-gray-500 text-white" style="box-shadow: 4px 4px 0px #111827;">Continue</button>
        </div>
    </div>
    <div id="firstLetterModal" class="modal-overlay hidden">
        <div class="modal-content" style="text-align: center;">
            <h2 class="text-4xl font-bold mb-4">Letter Insight</h2>
            <p id="firstLetterText" class="text-3xl font-bold mb-6 bg-yellow-200 p-2 rounded-lg"></p>
            <button id="closeFirstLetterBtn" class="modal-button bg-gray-500 text-white" style="box-shadow: 4px 4px 0px #111827;">Got it!</button>
        </div>
    </div>

    <div id="settingsModal" class="modal-overlay hidden">
        <div class="modal-content" style="text-align: center;">
            <h2 class="text-4xl font-bold mb-6">Settings</h2>
            <div class="flex items-center justify-center gap-4 bg-slate-100 p-4 rounded-lg">
                <label for="soundToggle" class="text-xl font-bold">Game Sounds</label>
                <button id="soundToggle" class="relative inline-flex items-center h-6 rounded-full w-11 transition-colors bg-gray-300">
                    <span id="soundToggleKnob" class="inline-block w-4 h-4 transform bg-white rounded-full transition-transform translate-x-1"></span>
                </button>
            </div>
            <button id="closeSettingsBtn" class="modal-button bg-gray-500 text-white mt-8" style="box-shadow: 4px 4px 0px #111827;">Close</button>
        </div>
    </div>

    <div id="streakModal" class="modal-overlay hidden">
        <div class="modal-content" style="text-align: center;">
            <h2 class="text-5xl font-bold mb-4 text-purple-600 animate-[glow_1.5s_ease-in-out_infinite]">POWER UP!</h2>
            <p id="streakText" class="text-2xl mb-6"></p>
            <button id="closeStreakBtn" class="modal-button bg-purple-500 text-white">Awesome!</button>
        </div>
    </div>
    <div id="abilityInfoModal" class="modal-overlay hidden">
        <div class="modal-content">
            <h2 class="text-4xl font-bold mb-4">Help Center</h2>
            <div id="helpContentContainer" class="space-y-4 text-lg overflow-y-auto pr-2">
                <!-- Content is dynamically generated by showHelpModal() -->
            </div>
            <div class="text-center mt-6">
                 <button id="closeAbilityInfoBtn" class="modal-button bg-gray-500 text-white" style="box-shadow: 4px 4px 0px #111827;">Got It!</button>
            </div>
        </div>
    </div>
    <div id="pantherBuckModal" class="modal-overlay hidden">
        <div class="modal-content" style="text-align: center;">
            <h2 class="text-5xl font-bold mb-4 text-purple-600 animate-[glow_1.5s_ease-in-out_infinite]">PANTHER BUCK!</h2>
            <p class="text-2xl mb-6">You've earned a Panther Buck! See Mr. Lopez Torres to claim your reward!</p>
            <button id="closePantherBuckBtn" class="modal-button bg-purple-500 text-white">Awesome!</button>
        </div>
    </div>

    <div id="sigmaStageUpModal" class="modal-overlay hidden">
        <div class="modal-content" style="text-align: center;">
            <h2 class="text-5xl font-bold mb-4 text-yellow-500 animate-[glow_1.5s_ease-in-out_infinite]">STAGE CLEAR!</h2>
            <p id="sigmaStageUpText" class="text-2xl mb-6"></p>
            <button id="closeSigmaStageUpBtn" class="modal-button bg-blue-500 text-white">Continue</button>
        </div>
    </div>


    <main class="main-container">
        <header id="headerGrid" class="header-grid">
            <div class="card time-card" id="timeCard">
                <h2>Time</h2>
                <p id="timer" class="content">05:00</p>
            </div>
            <div class="card score-card">
                <h2>Score</h2>
                <p id="score" class="content">0</p>
            </div>
            <div class="streak-correct-stack">
                <div class="card streak-card">
                    <h2>Streak</h2>
                    <p id="streak" class="content">0</p>
                </div>
                <div class="card correct-card">
                    <h2>Correct</h2>
                    <p id="correctAnswers" class="content">0</p>
                </div>
            </div>
            <button id="storeBtn" class="header-btn flex items-center justify-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5"><circle cx="9" cy="21" r="1"></circle><circle cx="20" cy="21" r="1"></circle><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path></svg>
                Store
            </button>
            <div class="button-cluster">
                <button id="endTurnBtn" class="header-btn">End Game</button>
                <button id="resetAllBtn" class="header-btn">Reset</button>
                <button id="aboutBtn" class="header-btn">About</button>
                <button id="settingsBtn" class="header-btn bg-slate-500">Settings</button>
            </div>
        </header>

        <section id="gameArea" class="card question-container">
            <div id="questionBox" class="card question-box">
                <p id="questionText"></p>
                <div class="flex justify-center items-center gap-4 mt-2" id="question-controls">
                    <div id="dokLabel" class="hidden"></div>
                    <button id="hintBtn">?</button>
                    <button id="firstLetterBtn" class="hidden bg-blue-500 text-white border-blue-800 shadow-blue-800 hover:shadow-blue-800/50 rounded-full w-12 h-12 text-lg font-black transition-all duration-200 hover:translate-y-1" style="border-width: 4px; box-shadow: 4px 4px 0px #1e40af; flex-shrink: 0; width: clamp(40px, 5vw, 60px); height: clamp(40px, 5vw, 60px);">A_</button>
                </div>
            </div>
            <div id="answerArea">
                <div class="answer-grid">
                    <div class="card answer-choice" data-choice="0"><p></p></div>
                    <div class="card answer-choice" data-choice="1"><p></p></div>
                    <div class="card answer-choice" data-choice="2"><p></p></div>
                    <div class="card answer-choice" data-choice="3"><p></p></div>
                </div>
                <form id="skibidi-form" class="hidden w-full flex flex-col sm:flex-row gap-4 items-center justify-center p-4">
                    <input type="text" id="skibidi-input" class="w-full text-2xl p-3 border-4 border-gray-800 rounded-xl" placeholder="Type your answer...">
                    <button type="submit" id="skibidi-submit" class="modal-button bg-green-500 text-white" style="box-shadow: 4px 4px 0px #111827;">Submit</button>
                </form>
                <!-- NEW: Fact or Myth buttons -->
                <div id="mythAnswerButtons" class="hidden flex justify-center gap-4 mt-4">
                    <button id="factBtn" class="modal-button bg-blue-500 text-white" style="box-shadow: 4px 4px 0px #111827;">Fact</button>
                    <button id="mythBtn" class="modal-button bg-red-500 text-white" style="box-shadow: 4px 4px 0px #111827;">Myth</button>
                </div>
            </div>
        </section>

        <div class="right-panel">
            <section id="abilitiesContainer" class="card abilities-container">
                <h2 class="abilities-title">Abilities</h2>
                <div id="sigmaProgressContainer" class="hidden">
                    <p class="sigma-progress-title">SIGMA Stage <span id="sigmaStageDisplay">1</span> Progress</p>
                    <div class="progress-bar-container bg-gray-600 border-gray-800">
                        <div id="sigmaProgressBar" class="progress-bar bg-yellow-400"></div>
                    </div>
                    <p id="sigmaProgressText" class="text-sm font-semibold"></p>
                </div>
                <div class="abilities-layout">
                    <div class="passive-abilities-container">
                        <div id="hunchAbility" class="passive-ability">
                            <p class="passive-ability-title">Historian's Hunch</p>
                            <div class="progress-bar-container">
                                <div id="hunchProgress" class="progress-bar" style="width: 0%;"></div>
                            </div>
                        </div>
                        <div id="tinkerAbility" class="passive-ability">
                            <p class="passive-ability-title">Time Tinkerer</p>
                            <div class="progress-bar-container">
                                <div id="tinkerProgress" class="progress-bar" style="width: 0%;"></div>
                            </div>
                        </div>
                        <div id="pantherBuckAbility" class="passive-ability">
                                 <div id="pantherBuckCounter" class="panther-buck-counter">0 üêæ</div>
                            <p class="passive-ability-title">Panther Bucks</p>
                            <div class="progress-bar-container">
                                <div id="pantherBuckProgress" class="progress-bar" style="width: 0%;"></div>
                            </div>
                        </div>
                    </div>
                    <div class="top-abilities">
                        <button id="abilitySkip" class="ability-btn locked">
                            <span>SKIP</span>
                            <div id="skipUses" class="uses hidden"></div>
                        </button>
                        <button id="abilityRedo" class="ability-btn locked">
                            <span>REDO</span>
                            <div id="redoUses" class="uses hidden"></div>
                        </button>
                    </div>
                    <button id="abilityBoost" class="ability-btn locked">
                        <span>2x BOOST</span>
                    </button>
                    <button id="abilityInfoBtn" class="ability-btn earned">
                        <span>HELP</span>
                    </button>
                </div>
            </section>
            <div id="notificationPanel">
                <p id="notificationText"></p>
            </div>
        </div>
    <script>
        // --- DATA ---
        const allQuestions = {
            grade6: [
                // Chapter 1: Exploration
                { question: "Which European power was primarily motivated by the '3 Gs' (Gold, God, Glory) in their exploration of the Americas?", choices: ["The French explorers", "The English colonists", "The Spanish conquistadors", "The Dutch traders"], answer: 2, hint: "They were known for seeking wealth and spreading Catholicism.", dok: 1 },
                { question: "The French sought land claims in North America, like Quebec, primarily for what economic activity?", choices: ["Growing cash crops like tobacco", "Trading for valuable animal furs", "Mining for silver and gold", "Establishing large, dense cities"], answer: 1, hint: "They built strong trade relationships with Native Americans for this resource.", dok: 1 },
                { question: "The English settlement at Jamestown was founded with what primary motivation?", choices: ["Seeking religious freedom", "Making scientific discoveries", "Finding economic opportunity", "Waging military conquest"], answer: 2, hint: "The Virginia Company was a business that hoped to make a profit.", dok: 2 },
                { question: "Which of these was a major challenge faced by early European settlers at Jamestown?", choices: ["Surviving harsh, cold winters", "Finding enough available land", "Dealing with disease and starvation", "Fighting off constant French attacks"], answer: 2, hint: "The 'Starving Time' was a period of extreme hardship for this colony.", dok: 1 },
                { question: "A major achievement of French exploration was the mapping of which major river system?", choices: ["The Rio Grande", "The Colorado River", "The Mississippi River", "The Hudson River"], answer: 2, hint: "This river was a key highway for their fur trading network.", dok: 1 },
                { question: "The Dutch established which settlement, focused on trade and commerce, that later became New York City?", choices: ["Jamestown", "New Amsterdam", "Plymouth", "Quebec"], answer: 1, hint: "It was located on a strategic harbor.", dok: 1 },
                { question: "What was a common effect of European land claims on Native American populations?", choices: ["Economic prosperity for all tribes", "Widespread adoption of European languages", "Displacement from their traditional lands", "A formal role in colonial governments"], answer: 2, hint: "As colonists expanded, they pushed native peoples westward.", dok: 2 },
                { question: "The search for a water route through North America to Asia was known as the search for the...", choices: ["Northwest Passage", "Panama Canal Route", "St. Lawrence Seaway", "Great Lakes Channel"], answer: 0, hint: "Explorers from England, France, and the Netherlands all sought this.", dok: 1 },
                { question: "Which European power established missions throughout the American Southwest to convert Native Americans to Catholicism?", choices: ["England", "France", "Netherlands", "Spain"], answer: 3, hint: "These religious outposts were a key part of their colonization strategy.", dok: 1 },
                { question: "The establishment of the Virginia Company by England is an example of what motivation for settlement?", choices: ["A desire for religious freedom", "A quest for political power", "The pursuit of economic gain", "A mission of scientific exploration"], answer: 2, hint: "It was a joint-stock company, designed to make money for investors.", dok: 3 },
                // Chapter 2: Early Settlements
                { question: "The first permanent English settlement in North America, founded in 1607, was located at...", choices: ["Plymouth", "Boston", "Jamestown", "Roanoke"], answer: 2, hint: "This settlement is in modern-day Virginia.", dok: 1 },
                { question: "Who was the Wampanoag leader who initially aided the Pilgrims at Plymouth?", choices: ["Powhatan", "Squanto", "Metacom", "Chief Massasoit"], answer: 3, hint: "He was the sachem, or leader, of the Wampanoag Confederacy.", dok: 1 },
                { question: "What document, signed by the Pilgrims, was an early attempt at self-government?", choices: ["The U.S. Constitution", "The Mayflower Compact", "The Declaration of Independence", "The English Bill of Rights"], answer: 1, hint: "It was an agreement to form a 'civil body politic'.", dok: 2 },
                { question: "Who was the strong leader who helped save Jamestown by enforcing the rule, 'He that will not work, shall not eat'?", choices: ["John Rolfe", "John Smith", "William Bradford", "William Penn"], answer: 1, hint: "His leadership was crucial during the colony's difficult early years.", dok: 1 },
                { question: "Which religious group, also known as Separatists, founded the Plymouth Colony?", choices: ["Quakers", "Puritans", "Pilgrims", "Catholics"], answer: 2, hint: "They wanted to separate completely from the Church of England.", dok: 1 },
                { question: "Who was the Native American who taught the Plymouth colonists how to farm, fish, and survive?", choices: ["Pocahontas", "Sacagawea", "Squanto", "Massasoit"], answer: 2, hint: "He served as an interpreter and guide, and was essential to the colony's survival.", dok: 1 },
                { question: "Who was the founder of the Rhode Island colony after being banished from Massachusetts for his controversial beliefs?", choices: ["John Winthrop", "Roger Williams", "William Bradford", "John Smith"], answer: 1, hint: "He advocated for the separation of church and state.", dok: 2 },
                { question: "The 1621 Autumn Harvest Celebration involved cooperation between the Pilgrims and which Native American tribe?", choices: ["The Powhatan tribe", "The Iroquois tribe", "The Wampanoag tribe", "The Cherokee tribe"], answer: 2, hint: "This event is often remembered as the 'First Thanksgiving'.", dok: 1 },
                { question: "What was the name of the 1675 conflict led by the Wampanoag leader Metacom against New England colonists?", choices: ["Bacon's Rebellion", "The Pequot War", "King Philip's War", "The French and Indian War"], answer: 2, hint: "Metacom was known to the English by an English name.", dok: 1 },
                { question: "Who was the founder of Pennsylvania and a leader of the peaceful religious group known as the Quakers?", choices: ["Anne Hutchinson", "John Rolfe", "William Penn", "Roger Williams"], answer: 2, hint: "He established his colony on principles of religious tolerance and fairness.", dok: 1 },
                { question: "The 1676 uprising of poor Virginia farmers against the governor and wealthy planters was known as...", choices: ["King Philip's War", "The Glorious Revolution", "Bacon's Rebellion", "Shays' Rebellion"], answer: 2, hint: "It was led by Nathaniel Bacon and highlighted tensions between rich and poor.", dok: 2 },
                { question: "Who was the Puritan woman banished from Massachusetts for challenging religious leaders and holding meetings in her home?", choices: ["Pocahontas", "Anne Hutchinson", "Abigail Adams", "Betsy Ross"], answer: 1, hint: "She co-founded the settlement of Portsmouth in what became Rhode Island.", dok: 2 },
                { question: "Who was the long-serving governor of the Plymouth Colony who wrote a detailed history of the settlement?", choices: ["Captain John Smith", "Governor Edward Winslow", "Governor John Winthrop", "Governor William Bradford"], answer: 3, hint: "His journal, 'Of Plymouth Plantation,' is a key historical source.", dok: 1 },
                { question: "The introduction of a profitable strain of tobacco by which individual saved Jamestown's economy?", choices: ["John Smith", "John Rolfe", "William Penn", "Pocahontas"], answer: 1, hint: "His marriage to Pocahontas also helped create peace for a time.", dok: 2 },
                { question: "Which religious group wanted to 'purify' the Church of England and established the Massachusetts Bay Colony?", choices: ["Pilgrims", "Quakers", "Puritans", "Baptists"], answer: 2, hint: "Their leader, John Winthrop, wanted to create a 'city upon a hill'.", dok: 1 },
                // Chapter 3: The Thirteen Colonies
                { question: "The New England colonies' economy was heavily based on shipbuilding, fishing, and...", choices: ["Growing cotton crops", "Commercial trade", "Mining for gold", "Large-scale farming"], answer: 1, hint: "Their location on the Atlantic coast and good harbors were key.", dok: 1 },
                { question: "Which group of colonies was known as the 'breadbasket' for its large production of wheat and other grains?", choices: ["The New England Colonies", "The Southern Colonies", "The Middle Colonies", "The Western Colonies"], answer: 2, hint: "This region had fertile soil and a good climate for farming.", dok: 1 },
                { question: "The Southern colonies' economy was dominated by large farms called plantations that grew cash crops like...", choices: ["Wheat and corn", "Fish and lumber", "Tobacco and rice", "Furs and pelts"], answer: 2, hint: "These crops required a long, warm growing season.", dok: 1 },
                { question: "Which colonial region was the most religiously and ethnically diverse, with settlers from many different countries?", choices: ["The New England region", "The Backcountry region", "The Southern Colonies", "The Middle Colonies"], answer: 3, hint: "Quaker principles of tolerance in Pennsylvania attracted many different groups.", dok: 2 },
                { question: "In which colonial region were town meetings an important part of government, allowing citizens to vote on local issues?", choices: ["The New England region", "The Middle Colonies", "The Southern Colonies", "All of the colonies"], answer: 0, hint: "This was a form of direct democracy common in their small, close-knit communities.", dok: 2 },
                { question: "The social and political life in the Southern colonies was dominated by which group?", choices: ["The small farmers", "The artisans and merchants", "The wealthy plantation owners", "The religious leaders"], answer: 2, hint: "Owning large amounts of land gave this group the most power.", dok: 2 },
                { question: "A person who agreed to work for a set number of years in exchange for passage to America was called an...", choices: ["Enslaved person", "Colonial artisan", "Indentured servant", "Apprentice worker"], answer: 2, hint: "They were not considered property for life, but their conditions were often harsh.", dok: 1 },
                { question: "A skilled craftsperson, such as a blacksmith, silversmith, or cooper, was known as an...", choices: ["Artisan", "Farmer", "Servant", "Landowner"], answer: 0, hint: "These workers were most often found in colonial cities and towns.", dok: 1 },
                { question: "In colonial society, the work of most women was centered on tasks related to the...", choices: ["Government and politics", "Household and family", "Church and ministry", "Shipping and trade"], answer: 1, hint: "They were responsible for cooking, cleaning, making clothes, and raising children.", dok: 1 },
                { question: "The rocky soil and long winters of which colonial region made large-scale farming difficult?", choices: ["The Southern Colonies", "The Middle Colonies", "The New England Colonies", "The Spanish Florida colony"], answer: 2, hint: "This geography pushed them toward other industries like fishing and shipbuilding.", dok: 3 },
                { question: "Which of the following colonies is part of the New England region?", choices: ["Virginia", "Pennsylvania", "New York", "Massachusetts"], answer: 3, hint: "This colony was founded by the Puritans.", dok: 1 },
                { question: "Which of the following colonies is part of the Middle Colonies region?", choices: ["Georgia", "New York", "Maryland", "Connecticut"], answer: 1, hint: "This colony was originally a Dutch settlement called New Amsterdam.", dok: 1 },
                { question: "Which of the following colonies is part of the Southern Colonies region?", choices: ["New Jersey", "Rhode Island", "Delaware", "South Carolina"], answer: 3, hint: "This colony's economy was heavily reliant on rice and indigo plantations.", dok: 1 },
                { question: "Public education was most emphasized in which colonial region, partly so that people could read the Bible?", choices: ["The Southern Colonies", "The New England Colonies", "The Middle Colonies", "The Frontier region"], answer: 1, hint: "This region passed the first laws requiring towns to establish schools.", dok: 2 },
                { question: "The warm climate and long growing season of the Southern colonies was ideal for growing...", choices: ["Cash crops", "Lumber", "Wheat", "Ships"], answer: 0, hint: "Crops like tobacco, rice, and indigo were very profitable.", dok: 1 },
                // Chapter 4: Slavery
                { question: "What was the name for the network of trade routes connecting Europe, Africa, and the Americas?", choices: ["The Silk Road", "The Columbian Exchange", "The Middle Passage", "Triangular Trade"], answer: 3, hint: "It formed a three-sided pattern across the Atlantic Ocean.", dok: 1 },
                { question: "The horrific journey that transported enslaved Africans across the Atlantic Ocean to the Americas was known as the...", choices: ["Final Leg", "Middle Passage", "Great Migration", "Atlantic Crossing"], answer: 1, hint: "The conditions on the ships were brutal and inhumane.", dok: 1 },
                { question: "Which of the following was a common 'good' transported from the Americas to Europe in the triangular trade system?", choices: ["Enslaved African people", "Finished manufactured goods", "Guns and various types of rum", "Sugar, tobacco, and cotton"], answer: 3, hint: "These raw materials were grown on plantations in the colonies.", dok: 1 },
                { question: "Which of the following was a common 'good' transported from Europe to Africa in the triangular trade system?", choices: ["Enslaved African people", "Manufactured goods like guns", "Raw materials like cotton", "Lumber and dried fish"], answer: 1, hint: "Items like guns, cloth, and rum were traded for enslaved people.", dok: 1 },
                { question: "The forced migration of millions of Africans to the Americas had what major impact on the Southern colonies?", choices: ["It decreased their overall population", "It led to the rapid growth of cities", "It provided labor for the plantation economy", "It ended the practice of farming"], answer: 2, hint: "The economy became heavily dependent on the labor of enslaved people.", dok: 2 },
                { question: "Under the system of slavery in the American colonies, enslaved people were legally considered...", choices: ["Citizens with very limited rights", "A type of indentured servant", "The property of their owners", "Temporary farm employees"], answer: 2, hint: "They had no legal rights and could be bought and sold.", dok: 2 },
                { question: "The experience of most enslaved people in the Southern colonies was a life of...", choices: ["Working in skilled artisan shops", "Hard labor on a large plantation", "Serving in the colonial government", "Owning their own small farms"], answer: 1, hint: "They worked long hours in the fields growing cash crops.", dok: 1 },
                { question: "The growth of which industry in the New England colonies was indirectly fueled by the slave trade?", choices: ["The fishing industry", "The lumber industry", "The shipbuilding industry", "The farming industry"], answer: 2, hint: "Merchants in this region built the ships used to transport goods and people.", dok: 3 },
                { question: "Which continent was the source of enslaved people in the triangular trade system?", choices: ["Asia", "Europe", "North America", "Africa"], answer: 3, hint: "People were captured and forced onto ships along its western coast.", dok: 1 },
                { question: "The demand for which crop in the Southern colonies massively increased the demand for enslaved labor?", choices: ["Wheat", "Corn", "Tobacco", "Potatoes"], answer: 2, hint: "This was a very labor-intensive cash crop.", dok: 2 },
            ],
            grade7: [
                // New 7th Grade Easy Mode Questions (50 questions)
                // Foundational Figures and Parties (6 questions)
                { question: "Who was the first President of the United States?", choices: ["Thomas Jefferson", "George Washington", "John Adams", "James Madison"], answer: 1, hint: "He is known as the 'Father of His Country'.", dok: 1 },
                { question: "Who was a key leader of the Federalist political party?", choices: ["Thomas Jefferson", "James Madison", "Alexander Hamilton", "Aaron Burr"], answer: 2, hint: "He was the first Secretary of the Treasury.", dok: 1 },
                { question: "Who was a key leader of the Democratic-Republican political party?", choices: ["Alexander Hamilton", "John Adams", "Thomas Jefferson", "John Jay"], answer: 2, hint: "He wrote the Declaration of Independence.", dok: 1 },
                { question: "Who served as the second President of the United States?", choices: ["George Washington", "Thomas Jefferson", "John Adams", "James Monroe"], answer: 2, hint: "He was a prominent lawyer and diplomat.", dok: 1 },
                { question: "Which political party favored a strong central government and a national bank?", choices: ["The Democratic-Republicans", "The Whig Party", "The Federalist Party", "The Green Party"], answer: 2, hint: "This party believed in a broad interpretation of the Constitution.", dok: 2 },
                { question: "Which political party favored states' rights and an agrarian-based economy?", choices: ["The Federalist Party", "The Democratic-Republicans", "The Whig Party", "The Know-Nothing Party"], answer: 1, hint: "This party believed in a strict interpretation of the Constitution.", dok: 2 },

                // Washington's Presidency and Precedents (4 questions)
                { question: "What was the Whiskey Rebellion a protest against?", choices: ["A tax on imported tea", "A tax on foreign goods", "A tax on domestic whiskey", "A tax on property and land"], answer: 2, hint: "Farmers in Pennsylvania protested this federal tax.", dok: 1 },
                { question: "How did Washington's administration respond to the Whiskey Rebellion?", choices: ["They chose to ignore the protest", "They negotiated a tax compromise", "They sent troops to put it down", "They repealed the tax immediately"], answer: 2, hint: "This showed the strength of the new federal government.", dok: 2 },
                { question: "What did Washington warn against in his Farewell Address?", choices: ["Further westward expansion", "The creation of public education", "Political parties and foreign alliances", "Maintaining a strong national military"], answer: 2, hint: "He feared these would divide and weaken the nation.", dok: 2 },
                { question: "What is a 'precedent' in the context of a presidency?", choices: ["A new law passed by the Congress", "A ruling made by the Supreme Court", "An action that serves as a future example", "A new type of federal tax"], answer: 2, hint: "Washington set many of these as the first president.", dok: 1 },

                // Hamilton vs. Jefferson (5 questions)
                { question: "What was Alexander Hamilton's view on creating a National Bank?", choices: ["He strongly opposed the bank", "He strongly supported the bank", "He was neutral on the issue", "He wanted state banks only"], answer: 1, hint: "He believed it was necessary for a stable economy.", dok: 2 },
                { question: "What was Thomas Jefferson's view on creating a National Bank?", choices: ["He strongly supported the bank", "He strongly opposed the bank", "He was neutral on the issue", "He wanted a global bank"], answer: 1, hint: "He believed it was unconstitutional.", dok: 2 },
                { question: "Which leader favored an economy based on manufacturing, industry, and trade?", choices: ["Thomas Jefferson", "James Madison", "Alexander Hamilton", "George Washington"], answer: 2, hint: "He believed in a strong industrial nation.", dok: 2 },
                { question: "Which leader favored an economy based on agriculture and independent small farmers?", choices: ["Alexander Hamilton", "John Adams", "Thomas Jefferson", "John Jay"], answer: 2, hint: "He envisioned a nation of independent farmers.", dok: 2 },
                { question: "What controversial laws did Jefferson and Hamilton disagree on regarding free speech and immigration?", choices: ["The Stamp and Sugar Acts", "The Townshend Acts", "The Alien and Sedition Acts", "The Intolerable Acts"], answer: 2, hint: "These laws were passed during John Adams' presidency.", dok: 1 },

                // John Adams' Presidency (4 questions)
                { question: "What is the Electoral College used for?", choices: ["To elect members of Congress", "To elect the President", "To appoint Supreme Court justices", "To declare war"], answer: 1, hint: "It's a system for choosing the nation's leader.", dok: 1 },
                { question: "What event involved French agents demanding a bribe from American diplomats?", choices: ["Whiskey Rebellion", "XYZ Affair", "Louisiana Purchase", "War of 1812"], answer: 1, hint: "This led to an undeclared naval war.", dok: 1 },
                { question: "What was significant about the Election of 1800?", choices: ["It was the nation's first election", "It was decided by the Supreme Court", "It was a peaceful transfer of power", "It immediately led to a civil war"], answer: 2, hint: "It showed the new constitutional system could work.", dok: 3 },
                { question: "What laws passed during Adams' presidency were criticized for limiting free speech?", choices: ["The Tariff Acts", "The Navigation Acts", "The Alien and Sedition Acts", "The Quartering Acts"], answer: 2, hint: "These acts targeted immigrants and government critics.", dok: 1 },

                // Jefferson's Presidency (4 questions)
                { question: "What major land deal doubled the size of the United States in 1803?", choices: ["Florida Purchase", "Gadsden Purchase", "Louisiana Purchase", "Alaska Purchase"], answer: 2, hint: "It was bought from France.", dok: 1 },
                { question: "Who did Thomas Jefferson buy the Louisiana Territory from?", choices: ["Spain", "Great Britain", "France", "Mexico"], answer: 2, hint: "Napoleon Bonaparte was the leader of this country.", dok: 1 },
                { question: "Who led the expedition to explore the Louisiana Purchase?", choices: ["Pike and Long", "Lewis and Clark", "Fremont and Carson", "Boone and Crockett"], answer: 1, hint: "They traveled all the way to the Pacific Ocean.", dok: 1 },
                { question: "What amendment changed the way the President and Vice President are elected?", choices: ["First Amendment", "Tenth Amendment", "Twelfth Amendment", "Nineteenth Amendment"], answer: 2, hint: "It was a response to the Election of 1800.", dok: 2 },

                // Louisiana's Statehood (4 questions)
                { question: "What was the 'Neutral Strip'?", choices: ["A fertile farming region", "A disputed, lawless territory", "A Native American reservation", "A military training ground"], answer: 1, hint: "It was a lawless area for a time.", dok: 1 },
                { question: "What was the 'West Florida Controversy' about?", choices: ["A dispute over fishing rights", "A rebellion against Spanish rule", "A debate over the capital city", "A conflict with Native Americans"], answer: 1, hint: "This led to the U.S. annexing parts of present-day Louisiana.", dok: 2 },
                { question: "What city's Spanish fort was captured by American settlers before Louisiana's statehood?", choices: ["New Orleans", "St. Louis", "Baton Rouge", "Natchitoches"], answer: 2, hint: "This event helped solidify U.S. control.", dok: 1 },
                { question: "Who was a prominent figure in Louisiana's push for statehood and its first state senate president?", choices: ["Pirate Jean Lafitte", "General Andrew Jackson", "Julien de Lallande Poydras", "Governor W.C.C. Claiborne"], answer: 2, hint: "He was a wealthy planter and politician.", dok: 1 },

                // War of 1812 Causes (4 questions)
                { question: "What was 'impressment' by the British?", choices: ["Taxing American goods heavily", "Forcing sailors into the British navy", "Blocking all American ports", "Seizing American cargo ships"], answer: 1, hint: "This was a major cause of tension.", dok: 1 },
                { question: "What is a 'blockade' in naval warfare?", choices: ["A special type of warship", "A large-scale naval battle", "Using ships to block enemy ports", "A formal naval peace treaty"], answer: 2, hint: "The British used this against American ports.", dok: 1 },
                { question: "Which European country was Britain fighting during the early 1800s, influencing its policies towards the U.S.?", choices: ["The Spanish Empire", "The German states", "Napoleonic France", "The Russian Empire"], answer: 2, hint: "This larger conflict distracted Britain.", dok: 2 },
                { question: "What group of congressmen strongly pushed for war with Britain in 1812?", choices: ["The Federalists", "The Anti-Federalists", "The War Hawks", "The Peace Doves"], answer: 2, hint: "Henry Clay and John C. Calhoun were prominent members.", dok: 1 },

                // War of 1812 Events (4 questions)
                { question: "What battle gave the U.S. control of Lake Erie in 1813?", choices: ["Battle of the Thames", "Battle of Plattsburgh", "Battle of Lake Erie", "Battle of New Orleans"], answer: 2, hint: "Oliver Hazard Perry famously said, 'We have met the enemy and they are ours.'", dok: 1 },
                { question: "What U.S. city was burned by the British in 1814?", choices: ["New York City", "Philadelphia", "Boston", "Washington D.C."], answer: 3, hint: "The White House was among the buildings destroyed.", dok: 1 },
                { question: "Who wrote 'The Star-Spangled Banner' during the War of 1812?", choices: ["Thomas Jefferson", "Francis Scott Key", "Andrew Jackson", "James Madison"], answer: 1, hint: "He witnessed the bombardment of Fort McHenry.", dok: 1 },
                { question: "What major battle was fought after the peace treaty for the War of 1812 was already signed?", choices: ["The Battle of Lake Champlain", "The Battle of New Orleans", "The Battle of Tippecanoe", "The Battle of Horseshoe Bend"], answer: 1, hint: "News of the Treaty of Ghent had not yet arrived.", dok: 2 },

                // War of 1812 Aftermath (5 questions)
                { question: "What treaty officially ended the War of 1812?", choices: ["Treaty of Paris", "Treaty of Versailles", "Treaty of Ghent", "Treaty of Guadalupe Hidalgo"], answer: 2, hint: "It was signed in Belgium.", dok: 1 },
                { question: "Who was the Native American leader who tried to unite tribes against U.S. expansion before and during the War of 1812?", choices: ["Sitting Bull", "Chief Joseph", "Chief Tecumseh", "Pontiac"], answer: 2, hint: "He was a Shawnee warrior and orator.", dok: 1 },
                { question: "Who was the American general who became a hero at the Battle of New Orleans?", choices: ["George Washington", "William Henry Harrison", "Andrew Jackson", "Zachary Taylor"], answer: 2, hint: "He later became president.", dok: 1 },
                { question: "Who was the pirate who helped Andrew Jackson defend New Orleans?", choices: ["Blackbeard", "Captain Kidd", "Jean Lafitte", "Henry Morgan"], answer: 2, hint: "His knowledge of the local waterways was crucial.", dok: 1 },
                { question: "What was a major outcome of the War of 1812 for the U.S.?", choices: ["Loss of territory", "Increased nationalism", "Economic depression", "Alliance with Britain"], answer: 1, hint: "Americans felt a new sense of pride and identity.", dok: 3 },

                // Era of Good Feelings & American System (4 questions)
                { question: "What was the period of national unity after the War of 1812 called?", choices: ["The Gilded Age", "The Roaring Twenties", "The Era of Good Feelings", "The Progressive Era"], answer: 2, hint: "There was only one major political party for a time.", dok: 1 },
                { question: "What was Henry Clay's plan to promote national economic growth called?", choices: ["The New Deal", "The Great Society", "The American System", "The Square Deal"], answer: 2, hint: "It aimed to make the U.S. economically self-sufficient.", dok: 2 },
                { question: "What did the American System include to protect American industries from foreign competition?", choices: ["Direct government subsidies", "Protective import tariffs", "Total trade embargoes", "Strict import quotas"], answer: 1, hint: "This made imported goods more expensive.", dok: 1 },
                { question: "What did the American System propose to connect the country and facilitate trade?", choices: ["A national railroad system", "Internal improvements like roads", "A series of new airports", "A national telegraph network"], answer: 1, hint: "These projects were funded by the federal government.", dok: 1 },

                // Supreme Court Cases & General Concepts (6 questions)
                { question: "What Supreme Court case established the principle of judicial review?", choices: ["McCulloch v. Maryland", "Gibbons v. Ogden", "Marbury v. Madison", "Worcester v. Georgia"], answer: 2, hint: "This case involved a midnight judge appointment.", dok: 3 },
                { question: "What Supreme Court case upheld the constitutionality of the National Bank?", choices: ["Marbury v. Madison", "McCulloch v. Maryland", "Gibbons v. Ogden", "Dred Scott v. Sandford"], answer: 1, hint: "It affirmed the doctrine of implied powers.", dok: 3 },
                { question: "What Supreme Court case affirmed federal power over interstate commerce?", choices: ["Marbury v. Madison", "McCulloch v. Maryland", "Gibbons v. Ogden", "Worcester v. Georgia"], answer: 2, hint: "This case involved steamboat monopolies.", dok: 3 },
                { question: "What Supreme Court case ruled in favor of the Cherokee Nation against Georgia?", choices: ["Marbury v. Madison", "McCulloch v. Maryland", "Gibbons v. Ogden", "Worcester v. Georgia"], answer: 3, hint: "President Jackson famously defied this ruling.", dok: 2 },
                { question: "What is the term for the power of the Supreme Court to declare laws unconstitutional?", choices: ["Executive privilege", "The presidential veto", "Judicial review", "Checks and balances"], answer: 2, hint: "It was established in Marbury v. Madison.", dok: 1 },
                { question: "What is the term for a strong feeling of pride in and devotion to one's country?", choices: ["Sectionalism", "Isolationism", "Nationalism", "Imperialism"], answer: 2, hint: "This feeling grew after the War of 1812.", dok: 1 }
            ],
            grade8: [
                // Unit 1: A Nation in Conflict
                { question: "Who were the 'Exodusters'?", choices: ["Gold miners from California", "African Americans who migrated to Kansas", "Irish railroad construction workers", "German farmers settling in the plains"], answer: 1, hint: "They were seeking to escape the Jim Crow South after Reconstruction.", dok: 1 },
                { question: "Who wrote 'The Significance of the Frontier in American History,' arguing that the West shaped the nation's character?", choices: ["President Theodore Roosevelt", "Industrialist Andrew Carnegie", "Historian Frederick Jackson Turner", "Activist W.E.B. Du Bois"], answer: 2, hint: "He was a famous historian who presented his 'Frontier Thesis'.", dok: 1 },
                { question: "What 1876 battle, also known as 'Custer's Last Stand,' was a major victory for the Lakota and Cheyenne?", choices: ["Battle of Wounded Knee", "Battle of the Alamo", "Battle of Little Bighorn", "Battle of Gettysburg"], answer: 2, hint: "It resulted in the defeat of the U.S. 7th Cavalry.", dok: 1 },
                { question: "The massacre of Lakota men, women, and children by the U.S. Army in 1890 is known as the...", choices: ["Sand Creek Massacre", "Battle of Little Bighorn", "Wounded Knee Massacre", "Fetterman Fight"], answer: 2, hint: "This event is considered the end of the major Indian Wars.", dok: 1 },
                { question: "What was a primary motivation for many white settlers migrating to the West?", choices: ["To live in large, established cities", "To work in the eastern shipping industry", "To acquire inexpensive farm land", "To experience European high culture"], answer: 2, hint: "The Homestead Act offered 160 acres to settlers.", dok: 2 },
                { question: "The near-extermination of which animal was devastating to the way of life for Plains Indians?", choices: ["The wild horse", "The American buffalo", "The bald eagle", "The grey wolf"], answer: 1, hint: "They relied on this animal for food, shelter, and tools.", dok: 2 },
                { question: "What was the U.S. government's 'reservation system' designed to do?", choices: ["Give all western land back to tribes", "Confine tribes to specific areas of land", "Help tribes continue a nomadic lifestyle", "Create a new national park system"], answer: 1, hint: "This policy made it easier for the government to control native populations.", dok: 2 },
                { question: "Who was the civil rights leader who co-founded the NAACP and advocated for immediate political equality?", choices: ["Booker T. Washington", "W.E.B. Du Bois", "Frederick Douglass", "Marcus Garvey"], answer: 1, hint: "He was a critic of the 'Atlanta Compromise'.", dok: 1 },
                { question: "Who was the leader who founded the Tuskegee Institute and promoted vocational education for African Americans?", choices: ["W.E.B. Du Bois", "Ida B. Wells", "Booker T. Washington", "Mary Church Terrell"], answer: 2, hint: "He believed economic progress should come before seeking political equality.", dok: 1 },
                { question: "Who was the journalist and activist who led a national crusade against the practice of lynching?", choices: ["Mary Church Terrell", "Madam C.J. Walker", "Harriet Tubman", "Ida B. Wells"], answer: 3, hint: "She used investigative reporting to expose the brutality of racial violence.", dok: 1 },
                { question: "What organization used legal action to fight for civil rights and was co-founded by W.E.B. Du Bois?", choices: ["The Niagara Movement", "The Tuskegee Institute", "The NAACP", "The Urban League"], answer: 2, hint: "Its full name is the National Association for the Advancement of Colored People.", dok: 1 },
                { question: "What was the system of laws in the South that enforced racial segregation and discrimination?", choices: ["The old Black Codes", "The Jim Crow system", "The American System", "The new Spoils System"], answer: 1, hint: "These laws mandated separate facilities for Black and white people.", dok: 1 },
                { question: "The Supreme Court case Plessy v. Ferguson (1896) established what legal doctrine?", choices: ["The 'separate but equal' doctrine", "The 'all men are created equal' idea", "The 'with malice toward none' policy", "The 'innocent until proven guilty' rule"], answer: 0, hint: "This decision legalized segregation for over 50 years.", dok: 2 },
                { question: "What type of school is Southern University in Louisiana, founded to provide higher education for African Americans?", choices: ["A private religious college", "A federal military academy", "A Historically Black College (HBCU)", "A land-grant agricultural school"], answer: 2, hint: "These institutions were crucial during the Jim Crow era.", dok: 1 },
                { question: "How did the Jim Crow system primarily affect Black Americans?", choices: ["It provided them with better opportunities", "It had no significant effect on their lives", "It enforced segregation and denied them rights", "It encouraged them to run for political office"], answer: 2, hint: "Consider the impact of 'separate but equal' on voting, education, and public life.", dok: 2 },

                // Unit 2: The Changing Nation
                { question: "What economic system is based on private ownership of businesses and competition in a free market?", choices: ["Communism", "Socialism", "Capitalism", "Mercantilism"], answer: 2, hint: "This system drove the Industrial Revolution in the U.S.", dok: 1 },
                { question: "The method of making large quantities of products quickly and cheaply is called...", choices: ["Custom crafting", "Mass production", "Vertical integration", "Horizontal integration"], answer: 1, hint: "The assembly line is a key example of this.", dok: 1 },
                { question: "Who was the industrialist who built a monopoly in the steel industry?", choices: ["John D. Rockefeller", "Andrew Carnegie", "J.P. Morgan", "Cornelius Vanderbilt"], answer: 1, hint: "His company used the Bessemer process to make steel efficiently.", dok: 1 },
                { question: "Who was the industrialist who created the Standard Oil trust, a monopoly in the oil industry?", choices: ["Andrew Carnegie", "Cornelius Vanderbilt", "J.P. Morgan", "John D. Rockefeller"], answer: 3, hint: "His company controlled about 90% of the oil refining in the U.S.", dok: 1 },
                { question: "When a company buys out all of its competitors in the same industry, it is called...", choices: ["Vertical integration", "Horizontal integration", "A large corporation", "A small partnership"], answer: 1, hint: "Think of moving 'horizontally' to take over similar companies.", dok: 2 },
                { question: "A company that has complete control over an industry by eliminating all competition is called a...", choices: ["Partnership", "Corporation", "Monopoly", "Grange"], answer: 2, hint: "This often leads to higher prices for consumers.", dok: 1 },
                { question: "The growth of cities, often due to people moving from farms to find factory jobs, is called...", choices: ["Industrialization", "Urbanization", "Assimilation", "Populism"], answer: 1, hint: "This led to problems like overcrowding and poor sanitation.", dok: 1 },
                { question: "What was a major reason for the struggles of factory workers in the late 1800s?", choices: ["The work was far too easy", "The wages were far too high", "The hours were far too short", "The conditions were unsafe"], answer: 3, hint: "Workplaces often had dangerous machinery and poor ventilation.", dok: 2 },
                { question: "What is a 'muckraker'?", choices: ["A type of factory machine", "A farmer who supported populism", "A journalist who exposes corruption", "A politician who opposed reforms"], answer: 2, hint: "They 'raked the muck' of society to show it to the public.", dok: 1 },
                { question: "What law was passed after Upton Sinclair's 'The Jungle' exposed unsanitary conditions in the food industry?", choices: ["The Sherman Antitrust Act", "The Pure Food and Drug Act", "The Seventeenth Amendment", "The Interstate Commerce Act"], answer: 1, hint: "This law required truth in labeling and halted the sale of contaminated foods.", dok: 2 },
                { question: "What did the Seventeenth (17th) Amendment do?", choices: ["Gave women the right to vote", "Created the federal income tax", "Allowed direct election of senators", "Banned the sale of alcohol"], answer: 2, hint: "Before this, senators were chosen by state legislatures, which led to corruption.", dok: 2 },
                { question: "Who was the muckraker who used political cartoons to expose the corruption of 'Boss' Tweed in New York City?", choices: ["Jacob Riis", "Upton Sinclair", "Ida Tarbell", "Thomas Nast"], answer: 3, hint: "His cartoons were powerful because even illiterate people could understand them.", dok: 1 },
                { question: "Who used photography in 'How the Other Half Lives' to show the poverty of city tenements?", choices: ["Thomas Nast", "Ida Tarbell", "Jacob Riis", "Upton Sinclair"], answer: 2, hint: "His photos shocked the nation and led to housing reforms.", dok: 2 },
                { question: "Which U.S. President was known as a 'trust buster' for his efforts to break up powerful monopolies?", choices: ["William McKinley", "Theodore Roosevelt", "Woodrow Wilson", "William Howard Taft"], answer: 1, hint: "His progressive reform program was called the 'Square Deal'.", dok: 1 },
                { question: "What was 'populism'?", choices: ["A movement supporting ordinary people", "A strategy to create a monopoly", "A style of art in the Gilded Age", "A new type of farming technique"], answer: 0, hint: "It was a movement of farmers and workers against the interests of big business.", dok: 1 },
                { question: "The political party formed by farmers and labor unions to push for reforms was called the...", choices: ["Republican Party", "Democratic Party", "Federalist Party", "People's Party"], answer: 3, hint: "They were also known as the Populists.", dok: 1 },

                // Unit 3: The Changing World
                { question: "What 1898 conflict marked the emergence of the U.S. as a world power?", choices: ["The Civil War", "World War I", "The Spanish-American War", "The Mexican-American War"], answer: 2, hint: "The sinking of the USS Maine was a key event leading to this war.", dok: 1 },
                { question: "The man-made waterway built by the U.S. to connect the Atlantic and Pacific oceans is the...", choices: ["Suez Canal", "Erie Canal", "Panama Canal", "Great Lakes Seaway"], answer: 2, hint: "It was a major foreign policy achievement for Theodore Roosevelt.", dok: 1 },
                { question: "What were the four MAIN causes of World War I?", choices: ["Monarchy, Isolationism, Nativism, Alliances", "Militarism, Alliances, Imperialism, Nationalism", "Mercantilism, Alliances, Industrialism, Nativism", "Monopolies, Anarchy, Imperialism, Neutrality"], answer: 1, hint: "Remember the acronym M.A.I.N.", dok: 1 },
                { question: "What event sparked the beginning of World War I in Europe?", choices: ["The sinking of the Lusitania", "The invasion of Poland", "The Bolshevik Revolution", "The assassination of Archduke Franz Ferdinand"], answer: 3, hint: "He was the heir to the Austro-Hungarian throne.", dok: 1 },
                { question: "What was the initial foreign policy of the United States at the start of World War I?", choices: ["Immediate intervention", "An alliance with Germany", "Neutrality and isolationism", "Economic sanctions on all of Europe"], answer: 2, hint: "President Wilson wanted to keep the U.S. out of the war.", dok: 2 },
                { question: "The sinking of which British passenger ship by a German submarine outraged Americans?", choices: ["The Titanic", "The Lusitania", "The USS Maine", "The Queen Mary"], answer: 1, hint: "Over 100 Americans were killed in this 1915 event.", dok: 1 },
                { question: "What was the Zimmermann Telegram?", choices: ["A peace proposal from Germany to the U.S.", "A German proposal of an alliance with Mexico", "A British request for U.S. military aid", "A declaration of war from Austria-Hungary"], answer: 1, hint: "It was intercepted and published, angering the American public.", dok: 2 },
                { question: "How did the U.S. government primarily fund the war effort during World War I?", choices: ["By raising income taxes on the poor", "By selling war supplies to Germany", "By selling Liberty Bonds to the public", "By taking loans from other countries"], answer: 2, hint: "These were a way for citizens to loan money to the government.", dok: 2 },
                { question: "What was the purpose of the Committee on Public Information during WWI?", choices: ["To censor all negative news about the war", "To create propaganda to build public support", "To negotiate a peace treaty with Germany", "To organize protests against the war"], answer: 1, hint: "It used posters, speeches, and movies to 'sell' the war to Americans.", dok: 2 },
                { question: "What was the primary style of fighting on the Western Front in World War I?", choices: ["Guerilla warfare", "Naval battles", "Trench warfare", "Aerial dogfights"], answer: 2, hint: "This led to a long and deadly stalemate.", dok: 1 },
                { question: "What was President Woodrow Wilson's peace plan at the end of World War I called?", choices: ["The New Deal", "The Square Deal", "The Fourteen Points", "The Treaty of Versailles"], answer: 2, hint: "It included the creation of a League of Nations.", dok: 1 },
                { question: "What was the name of the international peacekeeping organization created after World War I?", choices: ["The United Nations", "The League of Nations", "The North Atlantic Treaty Organization (NATO)", "The World Health Organization"], answer: 1, hint: "It was part of Wilson's Fourteen Points, but the U.S. never joined.", dok: 1 },
                { question: "What was the 'Red Scare' in the United States after World War I?", choices: ["A fear of a widespread influenza outbreak", "A fear of communist revolution in the U.S.", "A popular new fashion trend involving red clothing", "A concern about the growing power of labor unions"], answer: 1, hint: "It was fueled by the Bolshevik Revolution in Russia.", dok: 1 },
                { question: "What did the 19th Amendment, ratified in 1920, accomplish?", choices: ["It banned the sale of alcohol", "It created the federal income tax", "It gave women the right to vote", "It limited the president to two terms"], answer: 2, hint: "This was the culmination of the long women's suffrage movement.", dok: 1 },
                { question: "Who was a key leader of the women's suffrage movement, arrested for illegally voting in 1872?", choices: ["Ida B. Wells", "Susan B. Anthony", "Madam C.J. Walker", "Jane Addams"], answer: 1, hint: "Her face is on the dollar coin.", dok: 1 },
                { question: "What was the 'Great Migration'?", choices: ["The movement of settlers to the West", "The movement of immigrants from Europe", "The movement of African Americans from the South to the North", "The movement of people from cities to farms"], answer: 2, hint: "They were seeking factory jobs and escaping Jim Crow.", dok: 1 },
                { question: "The 1921 destruction of a prosperous Black neighborhood in Oklahoma by a white mob is known as the...", choices: ["Chicago Riot of 1919", "Atlanta Race Riot", "Tulsa Massacre", "Rosewood Massacre"], answer: 2, hint: "This event destroyed the area known as 'Black Wall Street'.", dok: 1 },
                { question: "The flourishing of African American art, music, and literature in the 1920s was known as the...", choices: ["The Gilded Age", "The Progressive Era", "The Harlem Renaissance", "The Roaring Twenties"], answer: 2, hint: "This cultural movement was centered in a neighborhood of New York City.", dok: 1 },
                { question: "How did the widespread availability of the automobile change American society in the 1920s?", choices: ["It made people more isolated in their homes", "It had little impact outside of major cities", "It led to the growth of suburbs and a new sense of freedom", "It caused a major decline in the oil industry"], answer: 2, hint: "People were no longer tied to where they worked or to railroad lines.", dok: 3 },
                { question: "What was a major consequence of the social and economic tensions after World War I?", choices: ["A period of national unity and peace", "A decline in prices for all consumer goods", "A resurgence of the Ku Klux Klan", "The end of all labor union activity"], answer: 2, hint: "Nativism and racial tensions increased during this period.", dok: 2 }
            ]
        };

        // NEW HARD MODE QUESTIONS
        const allHardQuestions = {
            grade6: [
                // Unit 1: Exploration and Settlement
                { question: "How did the economic motivations of France (fur trade) and Spain (gold) lead to different patterns of colonization and relationships with Native Americans?", choices: ["France built large cities, while Spain created small farms.", "France created trading posts and partnerships; Spain built missions and used forced labor.", "Both focused exclusively on large-scale agriculture and displacing tribes.", "Spain focused on trade, while France focused on military conquest."], answer: 1, hint: "Analyze how what they were looking for (furs vs. gold) determined how they interacted with the native population.", dok: 4 },
                { question: "Which statement best compares the primary challenges faced by the English at Jamestown with the Pilgrims at Plymouth?", choices: ["Both suffered from a lack of support from their home country.", "Jamestown faced internal strife and starvation; Plymouth faced harsh winters and disease.", "Both had peaceful relations with all Native American tribes from the start.", "Jamestown's challenge was mountains; Plymouth's was desert terrain."], answer: 1, hint: "Consider the different initial goals, leadership, and environmental conditions of each settlement.", dok: 4 },
                { question: "Evaluate the most significant, long-term effect of European colonization on Native Americans.", choices: ["The introduction of new technologies like metal tools and firearms.", "The creation of new and profitable trade opportunities for all tribes.", "The massive loss of life from new diseases and the loss of ancestral land.", "The establishment of permanent, lasting peace treaties across the continent."], answer: 2, hint: "Which effect had the most devastating and lasting impact on their societies, culture, and population?", dok: 6 },
                { question: "Explain the importance of the Mayflower Compact in the development of American government.", choices: ["It established the king of England as the ultimate authority in all matters.", "It was the first official plan for a national government for all 13 colonies.", "It was an early, influential example of self-governance based on the consent of the governed.", "It guaranteed religious freedom for all future colonists, including non-Christians."], answer: 2, hint: "How did this agreement about making 'just and equal laws' influence later documents like the Constitution?", dok: 5 },
                { question: "Analyze the primary cause of conflict in both Bacon's Rebellion and King Philip's War.", choices: ["Disputes over differing religious beliefs and practices.", "Tension over land, expansion, and government policies on the colonial frontier.", "Competition for control of the lucrative fur trade with the French.", "Arguments about the leadership of the colonial governors and their loyalty to the king."], answer: 1, hint: "What common issue fueled the anger of both the Virginia frontiersmen and the Wampanoag people?", dok: 4 },
                { question: "How did the contributions of John Smith (leadership) and John Rolfe (economics) combine to ensure the survival and success of Jamestown?", choices: ["Smith provided strong leadership and discipline; Rolfe provided an economic base with tobacco.", "Both men were primarily focused on building military defenses against the Spanish.", "Smith found gold, while Rolfe established the House of Burgesses.", "Both men focused exclusively on building peaceful relations with the Powhatan tribe."], answer: 0, hint: "One provided order and discipline to a struggling colony, while the other introduced a profitable cash crop that gave it a purpose.", dok: 5 },
                { question: "Compare the reasons for the founding of Massachusetts (by Puritans) and Pennsylvania (by Quakers).", choices: ["Both colonies were founded for purely economic reasons to trade with Native Americans.", "MA sought to build a strict religious society; PA sought to create a haven for religious freedom.", "Both were founded as military outposts to defend against the French in Canada.", "MA sought religious freedom for all; PA sought to build a strict Puritan society."], answer: 1, hint: "One group wanted to build a model 'city upon a hill' for their own beliefs, while the other wanted a safe place for all beliefs.", dok: 4 },
                { question: "Analyze the different perspectives of a Puritan leader like John Winthrop and a dissenter like Roger Williams on the role of government and religion.", choices: ["Both believed in a strict separation of church and state to protect religion.", "Winthrop saw government as upholding religious law; Williams believed this corrupted both.", "Williams saw government as upholding religious law; Winthrop believed in separation.", "Both believed government had no role in people's daily lives, religious or otherwise."], answer: 1, hint: "One was banished from the colony founded by the other over this very issue of 'forced worship'.", dok: 5 },
                { question: "What was the most significant long-term consequence of King Philip's War for the Native Americans of New England?", choices: ["They gained a large amount of new territory from the defeated colonists.", "They formed a permanent, lasting alliance with the French against the English.", "Their political and military power in the region was devastated, ending large-scale resistance.", "They successfully drove all English settlers out of the New England region for decades."], answer: 2, hint: "Consider the outcome of the war and its effect on the tribes' ability to resist further English expansion.", dok: 5 },
                { question: "Evaluate the role of Pocahontas as a cultural intermediary between the Powhatan and the Jamestown settlers.", choices: ["She was an insignificant figure whose story has been greatly exaggerated.", "Her actions, like her marriage to John Rolfe, helped create a period of peace and cooperation.", "She was primarily a military leader for the Powhatan tribe who fought against the English.", "She actively worked to create conflict and mistrust between the two groups."], answer: 1, hint: "How did her interactions with leaders like John Smith and her marriage to John Rolfe affect relations between the two very different cultures?", dok: 6 },

                // Unit 2: Colonial America
                { question: "Which factor was MOST significant in shaping the different economic developments of the New England and Southern colonies?", choices: ["The religious beliefs of their original founders.", "Their distinct physical geographies and climates.", "The level of education and literacy of the first colonists.", "Their political relationship with the King of England."], answer: 1, hint: "Evaluate how the land (rocky vs. fertile), climate (long vs. short growing season), and resources influenced what was possible in each region.", dok: 6 },
                { question: "How did the geography of the Middle Colonies, with its good harbors and fertile land, lead to a more balanced economy than other regions?", choices: ["It allowed for a mix of both large-scale farming and commercial trade centers like Philadelphia.", "It forced them to focus only on the fishing and whaling industry, like New England.", "The lack of rivers prevented any significant form of economic activity.", "It led to an economy based only on harvesting lumber for the shipbuilding industry."], answer: 0, hint: "Unlike New England (rocky soil) or the South (cash crop plantations), this region could successfully do both.", dok: 4 },
                { question: "Contrast the government of a typical New England town with the government of the Southern colonies.", choices: ["New England used town meetings for local issues; the South was governed by an elite group of planters in county-based systems.", "Both were ruled directly by the king with no local control or representative assemblies.", "The South had democratic town meetings; New England was run by an aristocracy of planters.", "Both regions used the exact same system of government established by the Mayflower Compact."], answer: 0, hint: "Think about the difference between direct democracy in small towns and a representative government run by a small, powerful elite.", dok: 4 },
                { question: "Explain how the Quaker belief in equality influenced the social structure and religious climate of the Middle Colonies.", choices: ["It created a very rigid class system based on personal wealth and land ownership.", "It led to more religious tolerance and social diversity compared to other regions.", "It resulted in the complete and immediate absence of slavery in Pennsylvania.", "It meant that only Quaker church members could hold political office or vote."], answer: 1, hint: "How would a belief that everyone has an 'inner light' affect how you treat people of different religions and backgrounds?", dok: 5 },
                { question: "Compare the experience of an indentured servant with the experience of an enslaved person in colonial Virginia.", choices: ["Both were considered legal property for their entire life and their children were born into servitude.", "The servant worked for a limited term to pay a debt and could expect freedom, while the enslaved person was held in bondage for life.", "Both had full political rights and could vote as citizens once their service was complete.", "The enslaved person could expect freedom after a few years, while the indentured servant could not."], answer: 1, hint: "What was the key difference in their legal status, the duration of their servitude, and their future prospects?", dok: 4 },
                { question: "Analyze how the environment of New England (fishing, lumber) and the South (cash crops) led to economic interdependence between the regions.", choices: ["The regions were economically isolated and did not trade with each other at all.", "They competed to see who could grow the most tobacco and rice.", "They developed specialized economies that traded with each other (e.g., Southern food for New England ships).", "The South's economy failed because of its poor environment, making it dependent on New England."], answer: 2, hint: "Instead of direct competition in all areas, how did their differences in production lead to a complex trade relationship?", dok: 4 },
                { question: "Explain the contribution of the Puritans' emphasis on reading the Bible to the development of education in New England.", choices: ["It led them to discourage education for most common people to maintain control.", "It had no impact on their views on education, which they saw as unimportant.", "It led to the creation of the first public schools and colleges (like Harvard) to ensure a literate populace.", "It led them to believe only religious leaders should be educated, not the general public."], answer: 2, hint: "If everyone needs to be able to read the Bible for themselves, what must everyone be taught how to do?", dok: 5 },
                { question: "Analyze the most significant consequence of the triangular trade system on the American colonies.", choices: ["It decreased the colonial population by a significant amount due to constant warfare.", "It made the colonies economically independent from England.", "It led to a permanent alliance with France against Spanish trade routes.", "It deeply embedded the institution of chattel slavery into the social and economic fabric of the colonies."], answer: 3, hint: "Which effect of this trade network had the most lasting and profound impact on American society, economy, and its future conflicts?", dok: 5 },
                { question: "Explain how the New England colonies, which had few enslaved people, still profited from the institution of slavery.", choices: ["They did not profit at all and actively worked to end slavery in the South.", "Their merchants, shipbuilders, and distillers were key parts of the triangular trade that transported enslaved people and slave-produced goods.", "They collected taxes on all enslaved people sold in the Southern colonies.", "Their profits came only from trading with Europe, not the West Indies or the South."], answer: 1, hint: "Consider the interconnectedness of the triangular trade. Who built the ships? Who traded the rum for people? Who sold goods to the slave plantations?", dok: 4 },
                { question: "Analyze the cause-and-effect relationship between the growth of the plantation economy in the South and the forced migration of Africans.", choices: ["The forced migration of Africans caused the plantation economy to fail due to high costs.", "The massive demand for cheap labor on plantations drove the expansion and brutality of the transatlantic slave trade.", "The plantation economy was developed specifically to give jobs to the thousands of enslaved Africans arriving.", "There was no significant relationship between these two major historical developments."], answer: 1, hint: "Which one was the cause, and which was the effect? Did the plantations need labor, or did the labor need plantations?", dok: 4 },

                // Unit 3: Colonial Louisiana
                { question: "Compare and contrast the primary economic focus of early French Louisiana with that of the British colony of Virginia.", choices: ["Both colonies were founded with the primary goal of religious freedom for Catholics.", "French Louisiana focused on the fur trade and strategic control; Virginia focused on large-scale tobacco agriculture.", "Both colonies had identical economies based on fishing and shipbuilding.", "French Louisiana focused on tobacco agriculture, while Virginia focused on the fur trade."], answer: 1, hint: "Consider the geography and the initial goals of the French (controlling the Mississippi) versus the English Virginia Company (profit from cash crops).", dok: 4 },
                { question: "Analyze the importance of New Orleans' physical geography to the growth and development of colonial Louisiana.", choices: ["Its location in a swampy, disease-prone area prevented any significant growth.", "Its strategic location near the mouth of the Mississippi River made it a vital center for trade and military control.", "Its inland location, far from any major waterways, made it difficult to access.", "Its geography was identical to other colonial cities like Boston and had no unique importance."], answer: 1, hint: "Why would controlling the 'door' to the entire Mississippi River valley be so important for an empire?", dok: 4 },
                { question: "Explain how the Code Noir, established by the French, influenced the institution of slavery and the lives of 'Gens de Couleur Libres' in Louisiana.", choices: ["It immediately abolished slavery and gave all people equal rights.", "It was a harsh set of laws regulating slavery, but also provided some limited rights for free people of color, creating a unique social class.", "It was a set of laws that only applied to white colonists, not enslaved people.", "It was identical to the slave laws in the British colonies with no unique provisions."], answer: 1, hint: "Consider how this legal code both controlled the enslaved population and created a distinct three-tiered social structure (white, free people of color, enslaved).", dok: 5 },
                { question: "Evaluate the success of John Law's Company of the West in populating and developing the Louisiana colony.", choices: ["It was a complete success, making Louisiana the most prosperous colony in North America.", "It was a massive failure, creating a 'bubble' that burst and damaged France's economy, though it did bring some settlers.", "It had no real impact, as very few people were persuaded to move to Louisiana.", "It was a Spanish company that had no involvement in French Louisiana."], answer: 1, hint: "Consider the 'Mississippi Bubble.' Did the company's advertising match the reality of the colony? What were the long-term results?", dok: 6 },
                { question: "Analyze the shift in power from French to Spanish rule in Louisiana. Why did France give the colony to Spain with the Treaty of Fontainebleau?", choices: ["Spain conquered Louisiana from France in a major war.", "France sold Louisiana to Spain for a massive profit.", "France gave Louisiana to Spain to compensate them for losing Florida and to keep it from falling into British hands.", "The colonists in Louisiana voted to join the Spanish empire."], answer: 2, hint: "Think about the outcome of the French and Indian War. Who won, who lost, and what did France want to prevent?", dok: 4 },
                { question: "Create an argument from the perspective of a French Creole in New Orleans protesting the arrival of the first Spanish governor, Antonio de Ulloa.", choices: ["'We welcome our new Spanish leaders and their superior form of government.'", "'We are loyal French subjects and refuse to be handed over to Spain without our consent! We will not follow Spanish trade laws.'", "'We demand that the British take control of our colony instead of the Spanish.'", "'We will only accept a Spanish governor if he agrees to abolish slavery immediately.'"], answer: 1, hint: "Focus on the colonists' sense of French identity and their anger at being treated like property to be traded between kings.", dok: 6 },
                { question: "Explain the significance of Alejandro O'Reilly's actions in re-establishing Spanish authority in Louisiana after the Rebellion of 1768.", choices: ["He negotiated a peaceful compromise, allowing the French colonists to govern themselves.", "He used overwhelming military force and executed the rebel leaders, earning the name 'Bloody O'Reilly' and cementing Spanish control.", "He was defeated by the French rebels and forced to flee the colony.", "He ignored the rebellion and focused on mapping the territory's geography."], answer: 1, hint: "How did his response differ from the first Spanish governor's? What message did it send?", dok: 5 },
                { question: "Compare the migration of the Acadians to Louisiana with the migration of the Isle√±os.", choices: ["Both groups came from France to establish fur trading posts.", "The Acadians were forcibly expelled by the British; the Isle√±os were recruited by the Spanish to populate the colony.", "Both groups were wealthy aristocrats who became plantation owners.", "The Acadians were Spanish-speaking, and the Isle√±os were French-speaking."], answer: 1, hint: "One group was fleeing persecution (a 'push' factor), while the other was actively brought in by the government (a 'pull' factor).", dok: 4 },
                { question: "Analyze how the contributions of enslaved Africans were essential to the economic survival and cultural development of colonial Louisiana.", choices: ["Enslaved Africans had a minimal role, as the colony's economy was based on trade, not agriculture.", "Their forced labor was crucial for building infrastructure and farming, while their culture heavily influenced Louisiana's music, food, and language.", "Their main contribution was serving as soldiers in the colonial militia.", "The culture of colonial Louisiana was purely French and was not influenced by other groups."], answer: 1, hint: "Consider both their economic impact (labor) and their cultural impact (Gumbo, Zydeco music, Voodoo).", dok: 4 },
                { question: "Evaluate the long-term influence of French and Spanish rule on modern-day Louisiana.", choices: ["French and Spanish rule had no lasting influence; Louisiana is identical to other states.", "The influence is minimal, seen only in a few street names.", "The influence is profound, seen in its civil law system (Napoleonic Code), parish system, architecture, and unique culture.", "The only lasting influence is the food; all other aspects are British-American."], answer: 2, hint: "Think about what makes Louisiana unique compared to other states. Where did those unique features come from?", dok: 5 }
            ],
            grade7: [
                // Unit 1: Governing the New Nation
                { question: "Analyze how the differing philosophies of Alexander Hamilton and Thomas Jefferson on federal power and the economy laid the groundwork for the first American political parties.", choices: ["Their agreement on all policies led to a period of unity.", "Their contrasting views created the Federalist and Democratic-Republican factions.", "Both supported a weak central government but disagreed on foreign policy.", "Their personal rivalry, not their philosophies, caused the party divisions."], answer: 1, hint: "Consider their fundamental beliefs about government size, the National Bank, and the ideal American economy (industrial vs. agrarian).", dok: 4 },
                { question: "Evaluate the significance of Washington's response to the Whiskey Rebellion as a critical test of federal power under the new Constitution.", choices: ["It showed the weakness of the federal government, which had to negotiate.", "It proved the federal government could and would enforce its laws, unlike under the Articles of Confederation.", "It led to the immediate repeal of the whiskey tax to appease the rebels.", "It caused several states to threaten secession in support of the farmers."], answer: 1, hint: "How did Washington's decisive action contrast with the government's inability to handle Shays' Rebellion?", dok: 6 },
                { question: "Explain how the debate over the assumption of state debts by the federal government highlighted the fundamental disagreements between Hamilton and Jefferson.", choices: ["It showed their complete agreement on the need for a strong national economy.", "It revealed their different views on federal versus state power and the role of government.", "Both men opposed the assumption of debt, but for different personal reasons.", "The debate was purely economic and had no political or philosophical implications."], answer: 1, hint: "Consider who would gain power if the federal government took on the states' debts. How did this fit into Hamilton's vision versus Jefferson's?", dok: 4 },
                { question: "Analyze the political consequences of the Alien and Sedition Acts.", choices: ["The acts were popular and unified the country against France.", "They were seen as an attack on the First Amendment and were used to rally support for the Democratic-Republicans.", "The acts were immediately declared unconstitutional by the Supreme Court.", "They had no real political consequences and were quickly forgotten."], answer: 1, hint: "How would a law that could be used to jail your political opponents affect an election?", dok: 4 },
                { question: "Create an argument defending the Federalist position on the National Bank, using a 'loose construction' interpretation of the Constitution.", choices: ["'The Constitution does not explicitly forbid a bank, so the government does not have the power to create one.'", "'A bank is 'necessary and proper' for the government to carry out its duties of taxing and regulating commerce.'", "'The bank is unconstitutional because the power to create one is not listed in the Constitution.'", "'State banks are more effective, so a national bank is a poor economic choice.'"], answer: 1, hint: "Focus on the 'Necessary and Proper' clause (or Elastic Clause) and how it could be used to justify the bank's creation.", dok: 6 },
                { question: "Evaluate the long-term impact of the 'peaceful revolution' of 1800.", choices: ["It proved that political power could not be transferred peacefully between parties.", "It had little impact, as the Federalists quickly regained power in the next election.", "It established the crucial precedent of a peaceful transfer of power, strengthening the new republic.", "It led to a constitutional crisis that permanently weakened the presidency."], answer: 2, hint: "What did it mean for the stability of the United States that one ruling party could lose an election and hand over power without a war?", dok: 5 },

                // Unit 2: Growth of the New Nation
                { question: "Analyze the constitutional dilemma Thomas Jefferson faced with the Louisiana Purchase and how he ultimately justified the action.", choices: ["He believed the purchase was clearly constitutional from the start.", "He sought a constitutional amendment before agreeing to the purchase.", "He used a loose interpretation of the Constitution, setting aside his strict constructionist views for the good of the nation.", "He ignored the Constitution entirely and made the purchase by executive decree."], answer: 2, hint: "Jefferson believed in a limited government, but the Constitution didn't explicitly grant the power to buy land. How did he reconcile this?", dok: 5 },
                { question: "Evaluate the most significant long-term consequence of the War of 1812 for the United States.", choices: ["The U.S. gained a large amount of territory from Great Britain, including Canada.", "The war led to a severe economic depression that lasted for decades.", "The war destroyed American manufacturing, making the U.S. dependent on Britain.", "The war fostered a strong sense of nationalism and encouraged domestic manufacturing."], answer: 3, hint: "Consider the political (national pride), economic (industrial growth), and diplomatic (respect from Europe) outcomes of the war.", dok: 6 },
                { question: "Compare the motivations of Native American groups who allied with Britain during the War of 1812 (like Tecumseh's confederacy) with those who allied with the U.S.", choices: ["All Native American groups allied with Britain to fight the U.S.", "British-allied tribes saw Britain as a barrier to U.S. expansion, while U.S.-allied tribes often sought protection or had rivalries with other tribes.", "All Native American groups remained strictly neutral during the war.", "Motivations were purely economic, based on who offered better trade goods."], answer: 1, hint: "Think about the primary threat to Native American land and sovereignty at the time. Which nation represented that threat?", dok: 4 },
                { question: "Explain how the Battle of New Orleans, though fought after the peace treaty was signed, had a profound political and psychological effect on the United States.", choices: ["The battle was a minor defeat that was largely ignored by the American public.", "It was a decisive victory that created a powerful symbol of American strength and made Andrew Jackson a national hero.", "Jackson lost the battle but gained popularity through effective propaganda.", "The battle was seen as embarrassing because it was fought unnecessarily after the war had ended."], answer: 1, hint: "Focus on the symbolic importance of a major victory over the British, even if it didn't affect the war's outcome.", dok: 4 },
                { question: "Synthesize how the events leading to Louisiana's statehood, such as the West Florida Controversy and the capture of the fort at Baton Rouge, demonstrated American expansionist desires.", choices: ["These events show that the U.S. was hesitant to expand its territory.", "They were isolated incidents with no connection to American expansion.", "American settlers' actions and U.S. government responses showed a clear pattern of wanting to secure and control the region.", "These events were orchestrated by Spain to encourage the U.S. to annex the territory."], answer: 2, hint: "Connect the actions of American settlers in Spanish-held territory with the overall goal of solidifying U.S. control over the mouth of the Mississippi.", dok: 5 },
                { question: "Analyze the primary causes of the War of 1812, distinguishing between maritime issues and western concerns.", choices: ["The war was solely caused by the American desire to conquer Canada.", "Maritime issues like impressment and trade restrictions were the main causes; western concerns about Native Americans were secondary.", "Both maritime grievances and western fears of British-backed Native American attacks were significant causes.", "The war was a misunderstanding with no real underlying causes."], answer: 2, hint: "Consider the anger of both eastern merchants losing ships and western settlers facing frontier conflicts.", dok: 4 },

                // Unit 3: The Developing and Expanding Nation
                { question: "Analyze the purpose of the Monroe Doctrine and its long-term influence on U.S. foreign policy.", choices: ["Its purpose was to encourage new European colonization in the Americas.", "It was a declaration of American isolationism but also established the U.S. as a protector of the Western Hemisphere.", "It was a military alliance with Great Britain to control Atlantic trade.", "It had no long-term influence and was quickly abandoned by future presidents."], answer: 1, hint: "Consider the dual message: the U.S. would stay out of European affairs, and Europe should stay out of American affairs.", dok: 4 },
                { question: "Evaluate the Supreme Court's decision in Worcester v. Georgia and President Andrew Jackson's reaction to it. What did this conflict reveal about the balance of power?", choices: ["The decision was fully enforced, demonstrating the Supreme Court's ultimate power.", "Jackson's defiance of the Court's ruling showed the limitations of judicial power when opposed by the executive branch.", "The case had no impact on the balance of power between the branches of government.", "The Supreme Court ruled against the Cherokee, supporting Jackson's removal policy."], answer: 1, hint: "What happened to the Cherokee despite the Court ruling in their favor? What does this say about the Court's ability to enforce its decisions?", dok: 6 },
                { question: "Compare the economic development of the North and the South during the First Industrial Revolution. How did the cotton gin affect both regions?", choices: ["Both regions developed identical industrial and agricultural economies.", "The North industrialized while the South's agrarian economy became more entrenched in slavery, partly due to the cotton gin's profitability.", "The cotton gin led to the South industrializing faster than the North.", "The North remained agrarian while the South developed a factory-based economy."], answer: 1, hint: "How did one invention reinforce the economic systems of two different regions simultaneously?", dok: 4 },
                { question: "Analyze the connection between the concept of Manifest Destiny and the policy of Indian Removal.", choices: ["Manifest Destiny was a belief that promoted peaceful coexistence and integration with Native American tribes.", "The two concepts were unrelated and developed in different time periods.", "The belief that the U.S. was destined to expand westward provided a justification for removing Native Americans from their lands.", "Indian Removal policies were designed to stop the westward expansion associated with Manifest Destiny."], answer: 2, hint: "If you believe you are 'destined' to have the land, what does that imply about the people already living on it?", dok: 4 },
                { question: "Create an argument from the perspective of Chief John Ross, explaining why the Indian Removal Act was unjust and a violation of past treaties.", choices: ["'We must move west, as the U.S. government has offered us better land and resources.'", "'Our treaties with the U.S. are sacred, and this act illegally seizes our ancestral lands, which the Supreme Court has affirmed are ours.'", "'We should accept this act, as armed resistance is our only hope for survival.'", "'This act is fair because it provides financial compensation for all of our lands.'"], answer: 1, hint: "Focus on the Cherokee's strategy of using the U.S. legal system and the idea of treaty rights.", dok: 6 },
                { question: "Analyze the multiple causes of the Mexican-American War, including the annexation of Texas and border disputes.", choices: ["The war was caused solely by an unprovoked Mexican invasion of U.S. territory.", "The annexation of Texas, the dispute over the Rio Grande border, and American expansionist ambitions were all key causes.", "The U.S. entered the war to help Mexico defend itself against European powers.", "The war was a minor conflict over a single trade disagreement."], answer: 1, hint: "Consider the sequence of events: Texas's independence, its annexation by the U.S., and the subsequent clash in the disputed territory.", dok: 4 },
                { question: "Evaluate the impact of the First Industrial Revolution on American society, considering both its positive and negative effects.", choices: ["The revolution only had positive effects, such as new technologies and wealth for all.", "It had no significant impact on society, which remained largely agrarian.", "It led to economic growth and new innovations, but also to poor working conditions, child labor, and urbanization problems.", "The revolution only had negative effects, such as pollution and the destruction of the family farm."], answer: 2, hint: "A balanced evaluation considers both the benefits (cheaper goods, new jobs) and the drawbacks (urban poverty, exploitation of labor).", dok: 5 },
                { question: "Synthesize the impact of key transportation advancements of the early 19th century, such as steamboats and canals, on the American economy.", choices: ["These advancements made transportation slower and more expensive, hurting the economy.", "They had little impact, as most trade continued to be local.", "They connected different regions of the country, making trade faster and cheaper, which fueled economic growth and westward expansion.", "These advancements only benefited the Southern states, while harming the Northern economy."], answer: 2, hint: "How does the ability to move goods cheaply and quickly up and down rivers and across states change a nation's economy?", dok: 5 },
                { question: "Analyze the long-term impact of the Supreme Court's decision in McCulloch v. Maryland on the balance of power between the federal and state governments.", choices: ["It significantly weakened federal power by declaring the National Bank unconstitutional.", "It strengthened federal power by affirming the doctrine of 'implied powers' and the supremacy of federal law over state law.", "It had no lasting impact on the balance of power between federal and state governments.", "It gave states the power to tax any part of the federal government within their borders."], answer: 1, hint: "Recall the two key questions: Could Congress create a bank? And could a state tax it? The answers defined federalism.", dok: 5 },
                { question: "Explain how the Homestead Act and the Pacific Railway Act worked together to encourage settlement of the West.", choices: ["Both acts were designed to discourage settlement and preserve the land for Native Americans.", "The Homestead Act gave land to settlers, while the Pacific Railway Act provided the transportation to get there and connect them to markets.", "The two acts were in conflict, as the railroad took land away from potential homesteaders.", "These acts only applied to the eastern states and had no impact on western settlement."], answer: 1, hint: "Think of it as a 'push' and 'pull' from the government: one act provided the land (the pull), and the other provided the means to get there (the push).", dok: 4 },
                { question: "Evaluate the effectiveness of the Seminole resistance to removal, led by figures like Osceola, compared to the Cherokee's legal challenges.", choices: ["The Seminole's armed resistance was completely successful, and they were never removed from Florida.", "Both strategies were equally and immediately successful in preventing removal.", "The Cherokee's legal strategy was more successful, as they were allowed to keep all their land.", "While neither ultimately prevented removal, the Seminole's long and costly resistance demonstrated a different form of opposition to U.S. policy."], answer: 3, hint: "Consider the outcomes of the Seminole Wars versus the Trail of Tears. Was either strategy truly 'successful' in the long run?", dok: 5 },
                { question: "Analyze how the Treaty of Guadalupe Hidalgo and the Gadsden Purchase collectively shaped the modern-day map of the American Southwest.", choices: ["These agreements returned all land west of Texas to Mexico.", "They had no impact on the map of the American Southwest.", "The treaty provided the bulk of the territory (CA, NV, UT), while the purchase finalized the southern border for a railroad.", "These agreements primarily dealt with the border between the U.S. and Canada."], answer: 2, hint: "Look at a map. The Mexican Cession from the treaty is the huge area, and the Gadsden Purchase is the small piece at the very bottom of Arizona/New Mexico.", dok: 4 },
                { question: "Synthesize the various 'push' and 'pull' factors that drove both internal migration (to cities) and international immigration to the U.S. in the early-to-mid 1800s.", choices: ["There were no significant migrations or immigration during this period.", "The only factor was the promise of free land in the West for everyone.", "Push factors like famine (Ireland) and revolution (Germany) combined with pull factors like factory jobs and land opportunities.", "The U.S. government banned all immigration, so only internal migration occurred."], answer: 2, hint: "Connect events in Europe (push) with developments in America, like the Industrial Revolution and westward expansion (pull).", dok: 5 }
            ],
            grade8: [
                // Unit 1: A Nation in Conflict
                { question: "Analyze how Frederick Jackson Turner's 'Frontier Thesis' might be viewed differently from the perspective of a Native American versus a white settler.", choices: ["Both would see it as a celebration of their shared history.", "A settler saw progress; a Native American saw conquest.", "Both would view it as an inaccurate portrayal of western life.", "A settler would criticize it, while a Native American would praise it."], answer: 1, hint: "Consider how the 'closing of the frontier' represented opportunity for one group and the end of a way of life for another.", dok: 5 },
                { question: "Evaluate the long-term effectiveness of the Dawes Act in achieving its stated goal of 'assimilating' Native Americans into American society.", choices: ["It was highly effective, leading to widespread prosperity.", "It was a failure, resulting in the loss of tribal land and culture.", "It had no significant long-term effects on Native American life.", "It was effective only in the short term but was later reversed."], answer: 1, hint: "Did the act lead to the outcomes its supporters promised, or did it create new problems?", dok: 6 },
                { question: "Synthesize the connection between the extermination of the buffalo and the U.S. government's ability to enforce the reservation system.", choices: ["The loss of the buffalo made tribes wealthier and able to resist.", "Destroying their food source made tribes more dependent.", "The two events were unrelated and had no impact on each other.", "The government protected the buffalo to help tribes on reservations."], answer: 1, hint: "How did the removal of a key resource for survival change the power dynamic between Plains tribes and the U.S. government?", dok: 5 },
                { question: "Compare the motivations of the Exodusters migrating to Kansas with those of white settlers moving west under the Homestead Act.", choices: ["Both groups were primarily seeking religious freedom.", "Exodusters fled violence; white settlers sought opportunity.", "Both groups were motivated by the discovery of gold in Kansas.", "Exodusters sought to build cities; white settlers were farmers."], answer: 1, hint: "While both sought a better life, what specific 'push' and 'pull' factors were different for each group?", dok: 4 },
                { question: "Analyze the cause-and-effect relationship between the Battle of Little Bighorn and subsequent U.S. policy towards the Lakota (Sioux).", choices: ["The U.S. victory led to a peaceful treaty with the Lakota.", "The Lakota victory was ignored by the U.S. government.", "The defeat led to an intensified U.S. military campaign.", "The battle caused the U.S. to abandon its reservation policy."], answer: 2, hint: "How does a nation typically respond when its military suffers a shocking and widely publicized defeat?", dok: 4 },
                { question: "Evaluate the Wounded Knee Massacre not as a battle, but as a symbol of the end of the 'Indian Wars'.", choices: ["It was a fair battle between two equally matched armies.", "It symbolized the final, brutal crushing of native resistance.", "It was an insignificant event with no symbolic meaning.", "It symbolized a new era of peaceful cooperation with tribes."], answer: 1, hint: "Consider the context: the Ghost Dance movement, the death of Sitting Bull, and the killing of unarmed men, women, and children.", dok: 6 },
                { question: "Compare and contrast the strategies for achieving civil rights proposed by Booker T. Washington and W.E.B. Du Bois.", choices: ["Both advocated for immediate and radical political protest.", "Washington focused on economics; Du Bois on immediate rights.", "Du Bois focused on economics; Washington on immediate rights.", "They had identical strategies but disliked each other personally."], answer: 1, hint: "Think about the difference between the 'Atlanta Compromise' and the goals of the Niagara Movement.", dok: 4 },
                { question: "Evaluate the long-term consequences of the 'separate but equal' doctrine established by Plessy v. Ferguson.", choices: ["It led to the creation of truly equal, though separate, facilities.", "It had no real impact, as it was never enforced in the South.", "It legitimized decades of segregation and systemic inequality.", "It was immediately overturned by a constitutional amendment."], answer: 2, hint: "In practice, what did 'separate' actually look like for African Americans in the Jim Crow South?", dok: 6 },
                { question: "Analyze how the Louisiana Constitution of 1898, with its 'grandfather clause,' was a direct response to the 15th Amendment.", choices: ["It was designed to strengthen and enforce the 15th Amendment.", "It was a loophole to disenfranchise Black voters.", "It had no connection to the 15th Amendment or voting rights.", "It gave all grandfathers, regardless of race, the right to vote."], answer: 1, hint: "The 15th Amendment said you can't deny the vote based on race. How did this clause get around that?", dok: 5 },
                { question: "Analyze the cause-and-effect relationship between the end of Reconstruction and the emergence of the Jim Crow system.", choices: ["The end of Reconstruction led to immediate racial equality.", "The withdrawal of federal troops allowed for segregationist laws.", "The Jim Crow system emerged before Reconstruction began.", "The two events are not historically connected in any way."], answer: 1, hint: "What was preventing Southern states from passing segregation laws *during* Reconstruction?", dok: 4 },

                // Unit 2: The Changing Nation
                { question: "Analyze the connection between the government's laissez-faire policy and the rise of powerful monopolies during the Gilded Age.", choices: ["Government regulations encouraged the growth of monopolies.", "A lack of government interference allowed monopolies to form.", "Laissez-faire policies successfully prevented any monopolies.", "The government actively worked to break up monopolies."], answer: 1, hint: "If there are no rules in a game, what happens to the most powerful players?", dok: 5 },
                { question: "Evaluate the statement: 'The expansion of railroads was the single most important factor in the industrialization of the United States.'", choices: ["This is accurate, as railroads created a national market.", "This is inaccurate, as the telephone was more important.", "This is inaccurate, as railroads slowed industrial growth.", "This is accurate, as railroads were the only new technology."], answer: 0, hint: "Consider how railroads connected raw materials, factories, and consumers on a national scale.", dok: 6 },
                { question: "Compare the business strategies of Andrew Carnegie (vertical integration) and John D. Rockefeller (horizontal integration).", choices: ["Both used the exact same strategy of vertical integration.", "Carnegie controlled production; Rockefeller bought competitors.", "Rockefeller controlled production; Carnegie bought competitors.", "Neither used any specific business strategy to grow."], answer: 1, hint: "One controlled the whole process from top to bottom; the other controlled one level of the process by spreading sideways.", dok: 4 },
                { question: "Explain how agricultural advancements, like the mechanical reaper, paradoxically contributed to urbanization.", choices: ["The new machines required more workers, emptying cities.", "The machines were built in rural areas, creating farm towns.", "Increased farm efficiency meant fewer farm laborers were needed.", "Agricultural advancements had no effect on where people lived."], answer: 2, hint: "If one machine can do the work of ten people, what happens to the other nine people?", dok: 4 },
                { question: "Evaluate the term 'Robber Baron' versus 'Captain of Industry.' How can both terms be accurately applied to a figure like John D. Rockefeller?", choices: ["He was only a 'Robber Baron' because he was a criminal.", "He was only a 'Captain of Industry' because he was a leader.", "He was a 'Robber Baron' for his tactics and a 'Captain' for his innovation.", "The terms are interchangeable and mean the same thing."], answer: 2, hint: "Consider the negative methods he used to build his monopoly versus the positive impact of his business efficiency and later charitable giving.", dok: 6 },
                { question: "Analyze the reasons for the high rates of child labor during the Gilded Age.", choices: ["Children were considered the most skilled and valuable workers.", "Family poverty and the demand for cheap labor were key causes.", "There were strict laws requiring all children to work in factories.", "There was a severe shortage of adult workers to fill factory jobs."], answer: 1, hint: "Consider the issue from both the perspective of a desperate family and a profit-driven factory owner.", dok: 5 },
                { question: "Analyze the role of muckrakers in the Progressive Era. How did they create the political will for reform?", choices: ["They ran for office and passed the reform laws themselves.", "They exposed problems, creating public pressure for reform.", "They were wealthy industrialists who funded reform movements.", "They were government officials in charge of creating new laws."], answer: 1, hint: "How does exposing a problem (like in 'The Jungle') lead to a solution (like the Meat Inspection Act)?", dok: 5 },
                { question: "Evaluate the effectiveness of the Sherman Antitrust Act of 1890 in its early years.", choices: ["It was immediately successful, breaking up dozens of trusts.", "It was initially weak and often used against labor unions.", "It was never used and had no impact on the U.S. economy.", "It was declared unconstitutional by the Supreme Court."], answer: 1, hint: "The law's language was vague. How did the courts interpret it at first, and who did they apply it to?", dok: 6 },
                { question: "Compare the goals of the Sherman Antitrust Act with the Clayton Antitrust Act. How did the later act improve upon the first?", choices: ["The Clayton Act was weaker and gave more power to monopolies.", "The Clayton Act was more specific and exempted labor unions.", "The two acts were identical in their language and their goals.", "The Sherman Act focused on railroads; Clayton on food."], answer: 1, hint: "What were the loopholes or weaknesses in the Sherman Act that the Clayton Act tried to fix?", dok: 4 },
                { question: "Synthesize the goals of the Progressive movement. What underlying belief about the role of government united reformers like Theodore Roosevelt and the muckrakers?", choices: ["They believed the government should have no role in society.", "They believed the government should be an active agent of reform.", "They believed the government should be controlled by industrialists.", "They believed the U.S. should return to an agricultural economy."], answer: 1, hint: "Was the Progressive answer to the problems of the Gilded Age more government intervention or less?", dok: 5 },
                { question: "Analyze the significance of the 17th Amendment. How did it shift the balance of power in the American political system?", choices: ["It shifted power from the people to the state legislatures.", "It shifted power from state legislatures to the voting public.", "It had no impact on the balance of power in the government.", "It gave the President the power to appoint all U.S. senators."], answer: 1, hint: "Who had the power to choose senators before the amendment, and who had it after?", dok: 5 },
                { question: "Evaluate Theodore Roosevelt's legacy as a 'trust buster.' Was he trying to destroy capitalism or save it?", choices: ["He was a socialist who wanted to destroy capitalism entirely.", "He sought to preserve capitalism by eliminating 'bad' trusts.", "He was a puppet of the monopolies and never took any action.", "He only broke up small, insignificant companies, not trusts."], answer: 1, hint: "Did he go after all big businesses, or did he distinguish between those that were harmful and those that were simply large?", dok: 6 },
                { question: "Analyze the reasons for the rise of the Populist movement. What specific economic challenges were farmers facing?", choices: ["Farmers were earning too much money and wanted lower prices.", "High railroad rates, debt, and falling crop prices fueled anger.", "Farmers were primarily concerned with foreign policy issues.", "The movement was started by bankers to help out farmers."], answer: 1, hint: "Consider who controlled the transportation of crops and the loans farmers needed to survive.", dok: 5 },
                { question: "Evaluate the platform of the People's Party. Why might their proposals, like government ownership of railroads, be seen as radical in the Gilded Age?", choices: ["Their platform was identical to that of the other major parties.", "Proposing government control challenged laissez-faire ideas.", "Their proposals were seen as not radical enough to solve problems.", "They only proposed minor tax adjustments, which was not radical."], answer: 1, hint: "How does the idea of government ownership conflict with the principles of a 'free market'?", dok: 6 },

                // Unit 3: The Changing World
                { question: "Analyze the primary causes of U.S. imperialism in the late 19th century.", choices: ["A desire to return to an isolationist foreign policy.", "A need for new markets, military bases, and a sense of cultural superiority.", "A response to a direct military invasion of the U.S. mainland.", "A plan to give all acquired territories immediate independence."], answer: 1, hint: "Consider economic, military, and ideological motivations for expansion.", dok: 4 },
                { question: "Evaluate the role of 'yellow journalism' in leading the United States into the Spanish-American War.", choices: ["It had no role, as most Americans did not read newspapers.", "It accurately reported the facts without any bias.", "It was a minor factor compared to economic interests.", "It inflamed public opinion against Spain, creating war fever."], answer: 3, hint: "How did sensationalized headlines and stories about Spanish atrocities affect public perception?", dok: 6 },
                { question: "Analyze the impact of the Treaty of Paris (1898) on the United States' role in the world.", choices: ["It forced the U.S. to give up its existing overseas territories.", "It had no impact on the U.S. role in the world.", "It marked the emergence of the U.S. as an imperial world power.", "It led to the U.S. adopting a policy of strict isolationism."], answer: 2, hint: "Consider what it meant for the U.S. to acquire territories like the Philippines, Guam, and Puerto Rico.", dok: 4 },
                { question: "Create an argument for why the construction of the Panama Canal was Theodore Roosevelt's most significant foreign policy achievement.", choices: ["The canal was a failure and damaged U.S. prestige.", "The canal shortened sea travel, projected U.S. power, and boosted trade.", "The Great White Fleet was a more significant achievement.", "The canal was built peacefully with Colombia's full cooperation."], answer: 1, hint: "Focus on the long-term economic and military benefits of connecting the Atlantic and Pacific oceans.", dok: 6 },
                { question: "Analyze how German unrestricted submarine warfare was the most significant factor leading to U.S. entry into World War I.", choices: ["It was a minor issue that was resolved through diplomacy.", "It directly threatened American lives and violated neutrality rights.", "The Zimmermann Telegram was a more significant factor.", "The U.S. entered the war primarily to gain new territory."], answer: 1, hint: "Compare the impact of this policy to other causes like the Zimmermann Telegram or economic ties to the Allies.", dok: 5 },
                { question: "Evaluate the effectiveness of the U.S. government's mobilization efforts on the home front during World War I.", choices: ["The efforts were a complete failure and did not support the war.", "The government was unable to mobilize any public support.", "Mobilization was highly effective through propaganda and economic controls.", "The home front had no role in the U.S. war effort."], answer: 2, hint: "Consider the roles of the Committee on Public Information, Liberty Bonds, and victory gardens.", dok: 6 },
                { question: "Compare the message of U.S. wartime propaganda with the reality of the Espionage and Sedition Acts.", choices: ["Propaganda promoted unity, while the acts suppressed dissent.", "Both the propaganda and the acts promoted free speech.", "Propaganda suppressed dissent, while the acts promoted unity.", "There was no contradiction between the two; both supported freedom."], answer: 0, hint: "How does a poster promoting '100% Americanism' contrast with laws that punish criticism of the government?", dok: 4 },
                { question: "Analyze the U.S. Senate's reasons for rejecting the Treaty of Versailles and the League of Nations.", choices: ["The Senate believed the treaty was too lenient on Germany.", "The Senate fully supported the treaty without any changes.", "The Senate feared the League would entangle the U.S. in future wars.", "The Senate rejected the treaty because it did not give the U.S. enough new territory."], answer: 2, hint: "Focus on the desire to return to isolationism and avoid being drawn into European conflicts.", dok: 4 },
                { question: "Synthesize the causes of the first Red Scare in the United States following World War I.", choices: ["It was caused by a widespread economic boom and national unity.", "It was caused by the success of labor unions in winning all their demands.", "It was caused by the Bolshevik Revolution, labor strikes, and anarchist bombings.", "It was a government-created hoax with no real underlying causes."], answer: 2, hint: "Combine the fear of communism from abroad with social unrest at home.", dok: 5 },
                { question: "Evaluate the most significant long-term social change in the United States resulting from World War I.", choices: ["The return to a purely agricultural economy.", "The granting of voting rights to women (19th Amendment).", "The end of all racial discrimination in the country.", "The decline of cities and a return to rural life."], answer: 1, hint: "Consider the major social movements of the era and how the war impacted them.", dok: 6 },
                { question: "Analyze the connection between the Great Migration and the Harlem Renaissance.", choices: ["The Great Migration caused the Harlem Renaissance to end.", "The two events were unrelated and occurred in different decades.", "The migration of Black artists and intellectuals fueled the Harlem Renaissance.", "The Harlem Renaissance was a movement of white artists celebrating Black culture."], answer: 2, hint: "How did the concentration of a large, vibrant African American population in northern cities like Harlem create a fertile ground for a cultural explosion?", dok: 4 },
                { question: "Create an argument that the social and economic tensions of the post-WWI era, such as the Red Scare and race riots, were a direct consequence of the war itself.", choices: ["The post-war era was peaceful, with no major social or economic tensions.", "These tensions were caused by the Great Depression, not WWI.", "The war's disruption led to fear, competition for jobs, and social upheaval.", "These tensions existed before the war and were not affected by it."], answer: 2, hint: "Connect the dots between returning soldiers, economic disruption, wartime propaganda, and the resulting social conflicts.", dok: 6 },
                { question: "Analyze how new technologies like the automobile and radio contributed to the creation of a mass national culture in the 1920s.", choices: ["These technologies reinforced regional differences and isolation.", "They allowed people across the country to share the same experiences.", "Only the wealthiest Americans had access to these technologies.", "These technologies had a greater impact on Europe than the U.S."], answer: 1, hint: "How does hearing the same broadcast or being able to travel to the same places break down localism?", dok: 4 },
                { question: "Compare the strategies of the 'old' suffragists like Susan B. Anthony with the 'new' suffragists like Alice Paul.", choices: ["Both groups used the exact same tactics of quiet lobbying.", "Anthony focused on a state-by-state approach; Paul used more radical protests.", "Paul focused on a state-by-state approach; Anthony used more radical protests.", "Neither group was successful in achieving women's suffrage."], answer: 1, hint: "Consider the difference between lobbying and parades, picketing the White House, and hunger strikes.", dok: 4 },
                { question: "Evaluate the impact of the 1918 influenza outbreak on American society.", choices: ["The outbreak had a minimal impact and was contained quickly.", "It led to major social and economic disruption, killing millions.", "It only affected soldiers in Europe, not civilians in the U.S.", "The government's response was praised as a model of public health."], answer: 1, hint: "Consider how a pandemic that was more deadly than the war itself would affect a nation.", dok: 5 }
            ],
        };
        // NEW SKIBIDI MODE QUESTIONS
        const allSkibidiQuestions = {
            grade6: [
                { question: "The first permanent English settlement in North America was called ___.", answer: "Jamestown", hint: "It was founded in Virginia in 1607." },
                { question: "The cash crop that saved the Jamestown colony was ___.", answer: "tobacco", hint: "John Rolfe introduced a popular variety of it." },
                { question: "The first representative assembly in the American colonies was the ___.", answer: "House of Burgesses", hint: "It was established in Virginia in 1619." },
                { question: "The Pilgrims signed the ___ to establish a form of self-government.", answer: "Mayflower Compact", hint: "It was an agreement to create fair laws for the general good." },
                { question: "The Wampanoag man who taught the Pilgrims to farm was ___.", answer: "Squanto", hint: "He was a member of the Patuxet tribe." },
                { question: "The New England colonies' economy was based on shipbuilding, fishing, and ___.", answer: "trade", hint: "Their rocky soil was not good for large-scale farming." },
                { question: "The Middle Colonies were known as the '___' because they grew so much wheat.", answer: "breadbasket colonies", hint: "Their fertile soil was ideal for growing grains." },
                { question: "The Southern Colonies' economy was based on large farms called ___.", answer: "plantations", hint: "These farms grew cash crops like tobacco and rice." },
                { question: "A person who worked for a period of time to pay off a debt was an ___.", answer: "indentured servant", hint: "They were not enslaved for life." },
                { question: "The brutal sea journey that brought enslaved Africans to the Americas was the ___.", answer: "Middle Passage", hint: "It was the middle leg of the triangular trade route." },
                { question: "The founder of Pennsylvania who believed in religious tolerance was ___.", answer: "William Penn", hint: "He was a leader of the Quakers." },
                { question: "Roger Williams and Anne Hutchinson were banished from Massachusetts for challenging ___ authority.", answer: "Puritan", hint: "They advocated for greater religious freedom." },
                { question: "The uprising of Virginia frontiersmen against the colonial government was called ___.", answer: "Bacon's Rebellion", hint: "It was led by Nathaniel Bacon in 1676." },
                { question: "The major conflict between New England colonists and Native Americans in 1675 was ___.", answer: "King Philip's War", hint: "The Wampanoag leader Metacom was also known by this English name." },
                { question: "The English document from 1215 that limited the king's power was the ___.", answer: "Magna Carta", hint: "It introduced the concept of the 'rule of law'." },
                { question: "The Enlightenment philosopher who wrote about 'natural rights' was ___.", answer: "John Locke", hint: "His ideas influenced Thomas Jefferson." },
                { question: "The religious revival movement in the colonies during the 1730s and 1740s was the ___.", answer: "Great Awakening", hint: "It encouraged people to challenge traditional authority." },
                { question: "The British law forbidding settlement west of the Appalachian Mountains was the ___.", answer: "Proclamation of 1763", hint: "It was meant to prevent conflict with Native Americans." },
                { question: "The slogan 'No taxation without ___' was the main colonial argument against British taxes.", answer: "representation", hint: "Colonists had no members in Parliament." },
                { question: "The secret group of Patriot activists who organized protests like the Boston Tea Party were the ___.", answer: "Sons of Liberty", hint: "Samuel Adams was a famous leader." },
                { question: "The event where British soldiers fired on a crowd of colonists, killing five, was the ___.", answer: "Boston Massacre", hint: "Crispus Attucks was the first to die." },
                { question: "The protest where colonists dumped tea into Boston Harbor was the ___.", answer: "Boston Tea Party", hint: "It was a protest against the Tea Act." },
                { question: "The harsh laws passed by Britain to punish Massachusetts for the Tea Party were the ___.", answer: "Intolerable Acts", hint: "The colonists also called them the Coercive Acts." },
                { question: "The pamphlet written by Thomas Paine that urged colonists to support independence was ___.", answer: "Common Sense", hint: "It was written in simple language for all to understand." },
                { question: "The first shots of the American Revolution were fired at Lexington and ___.", answer: "Concord", hint: "This was the 'shot heard 'round the world'." },
                //25 more
                { question: "What system of trade involved the exchange of goods and enslaved people between Europe, Africa, and the Americas?", answer: "triangular trade", hint: "It formed a three-pointed route across the Atlantic." },
                { question: "A large farm, especially in the South, that relied on slave labor was called a ___.", answer: "plantation", hint: "Cash crops like tobacco were grown there." },
                { question: "What is the economic theory that a country's power depends on its wealth?", answer: "mercantilism", hint: "Colonies existed to benefit the mother country under this system." },
                { question: "What type of government did the Puritans establish in Massachusetts Bay?", answer: "theocracy", hint: "It means a government ruled by religious leaders." },
                { question: "The leader of the Powhatan Confederacy and father of Pocahontas was Chief ___.", answer: "Powhatan", hint: "He was a powerful leader in early Virginia." },
                { question: "The first successful cash crop grown in the English colonies was ___.", answer: "tobacco", hint: "Its cultivation saved Jamestown." },
                { question: "The journey of enslaved Africans across the Atlantic was known as the ___.", answer: "Middle Passage", hint: "The conditions were horrific." },
                { question: "The French and Indian War was fought between Great Britain and ___.", answer: "France", hint: "They were rivals for control of North America." },
                { question: "What act required colonists to provide housing and supplies for British soldiers?", answer: "Quartering Act", hint: "This was a major grievance for the colonists." },
                { question: "Who was the main author of the Declaration of Independence?", answer: "Thomas Jefferson", hint: "He was a delegate from Virginia." },
                { question: "The idea that government gets its power from the people is called ___.", answer: "consent of the governed", hint: "This is a key principle in the Declaration of Independence." },
                { question: "Colonists who remained loyal to Great Britain during the Revolution were called ___.", answer: "loyalists", hint: "They were also known as Tories." },
                { question: "The winter encampment where Washington's army suffered greatly was at ___.", answer: "Valley Forge", hint: "It was a time of great hardship and training." },
                { question: "What battle is considered the turning point of the American Revolution?", answer: "Saratoga", hint: "This victory convinced France to become an American ally." },
                { question: "The final major battle of the American Revolution was at ___.", answer: "Yorktown", hint: "Cornwallis surrendered here." },
                { question: "The first constitution of the United States was the ___.", answer: "Articles of Confederation", hint: "It created a weak central government." },
                { question: "What event showed the weakness of the Articles of Confederation?", answer: "Shays' Rebellion", hint: "It was an uprising of farmers in Massachusetts." },
                { question: "The agreement to create a two-house legislature was the ___.", answer: "Great Compromise", hint: "It combined the Virginia and New Jersey plans." },
                { question: "The first ten amendments to the Constitution are called the ___.", answer: "Bill of Rights", hint: "They protect individual freedoms." },
                { question: "The branch of government that makes the laws is the ___ branch.", answer: "legislative", hint: "It includes the House and Senate (Congress)." },
                { question: "The branch of government that enforces the laws is the ___ branch.", answer: "executive", hint: "The President is the head of this branch." },
                { question: "The branch of government that interprets the laws is the ___ branch.", answer: "judicial", hint: "The Supreme Court is the highest court in this branch." },
                { question: "The system that prevents any one branch from becoming too powerful is called ___.", answer: "checks and balances", hint: "Each branch has powers over the others." },
                { question: "The sharing of power between the national and state governments is called ___.", answer: "federalism", hint: "This is a key principle of the U.S. Constitution." },
                { question: "What document formally ended the American Revolution?", answer: "Treaty of Paris", hint: "It was signed in 1783." }
            ],
            grade7: [
                { question: "The uprising of Pennsylvania farmers against a federal tax on liquor was the ___.", answer: "Whiskey Rebellion", hint: "It tested the power of the new federal government." },
                { question: "In his Farewell Address, George Washington warned against political parties and foreign ___.", answer: "alliances", hint: "He advised the nation to remain neutral." },
                { question: "The scandal involving French agents demanding a bribe from American diplomats was the ___.", answer: "XYZ Affair", hint: "It led to an undeclared naval war with France." },
                { question: "The laws passed during John Adams' presidency that targeted immigrants and critics of the government were the ___.", answer: "Alien and Sedition Acts", hint: "They were seen as a violation of the First Amendment." },
                { question: "The peaceful transfer of power from one political party to another in 1800 is called the ___.", answer: "Revolution of 1800", hint: "It happened when Jefferson defeated Adams." },
                { question: "Thomas Jefferson purchased the Louisiana Territory from ___ in 1803.", answer: "France", hint: "The leader of this country was Napoleon Bonaparte." },
                { question: "The Supreme Court case that established the principle of judicial review was ___.", answer: "Marbury v Madison", hint: "This power allows the court to declare laws unconstitutional." },
                { question: "The British practice of forcing American sailors to serve in the British navy was called ___.", answer: "impressment", hint: "It was a major cause of the War of 1812." },
                { question: "The group of young congressmen who pushed for war with Britain were known as the ___.", answer: "War Hawks", hint: "Henry Clay was a famous leader of this group." },
                { question: "The Shawnee chief who tried to unite Native American tribes against U.S. expansion was ___.", answer: "Tecumseh", hint: "He was defeated at the Battle of Tippecanoe." },
                { question: "Francis Scott Key wrote 'The Star-Spangled Banner' during the bombardment of Fort ___.", answer: "McHenry", hint: "This fort protected the city of Baltimore." },
                { question: "The American general who became a national hero at the Battle of New Orleans was ___.", answer: "Andrew Jackson", hint: "This battle was fought after the peace treaty was signed." },
                { question: "The period of national unity after the War of 1812 was called the ___.", answer: "Era of Good Feelings", hint: "James Monroe was president during this time." },
                { question: "Henry Clay's plan to promote American industry through tariffs and internal improvements was the ___.", answer: "American System", hint: "It also included a national bank." },
                { question: "The foreign policy statement that declared the Americas closed to further European colonization was the ___.", answer: "Monroe Doctrine", hint: "It was issued in 1823." },
                { question: "The belief that the United States was destined to expand across the continent was known as ___.", answer: "Manifest Destiny", hint: "This idea was used to justify westward expansion." },
                { question: "The law signed by Andrew Jackson that forced the relocation of southeastern Native American tribes was the ___.", answer: "Indian Removal Act", hint: "It led to the Trail of Tears." },
                { question: "The forced march of the Cherokee people from Georgia to Oklahoma is known as the ___.", answer: "Trail of Tears", hint: "Thousands died during the journey." },
                { question: "The invention by Eli Whitney that greatly increased the profitability of cotton was the ___.", answer: "cotton gin", hint: "It also led to a massive increase in the demand for enslaved labor." },
                { question: "The lawless territory located between Spanish Texas and Louisiana was known as the ___.", answer: "Neutral Strip", hint: "It was a haven for outlaws." },
                //30 more
                { question: "Who was the first Secretary of the Treasury, known for his financial plan?", answer: "Alexander Hamilton", hint: "He favored a strong central government and a national bank." },
                { question: "Which political party was led by Thomas Jefferson and favored states' rights?", answer: "Democratic-Republicans", hint: "They opposed the Federalists." },
                { question: "The expedition sent to explore the Louisiana Purchase was led by Lewis and ___.", answer: "Clark", hint: "Sacagawea was their essential guide." },
                { question: "What treaty ended the War of 1812?", answer: "Treaty of Ghent", hint: "It was signed in Belgium in 1814." },
                { question: "The Supreme Court case McCulloch v. Maryland affirmed the federal government's ___ powers.", answer: "implied", hint: "It upheld the constitutionality of the National Bank." },
                { question: "The Missouri Compromise of 1820 admitted Missouri as a slave state and ___ as a free state.", answer: "Maine", hint: "It also drew a line at 36¬∞30‚Ä≤ to divide future slave and free territories." },
                { question: "Andrew Jackson's practice of rewarding his political supporters with government jobs was called the ___.", answer: "spoils system", hint: "The phrase 'to the victor belong the spoils' is associated with it." },
                { question: "The political crisis where South Carolina threatened to secede over a tariff was the ___.", answer: "Nullification Crisis", hint: "John C. Calhoun was a key figure." },
                { question: "The war fought between the U.S. and Mexico from 1846-1848 was the ___.", answer: "Mexican-American War", hint: "It resulted in the U.S. acquiring a vast amount of territory." },
                { question: "The treaty that ended the Mexican-American War was the ___.", answer: "Treaty of Guadalupe Hidalgo", hint: "Mexico ceded California, Nevada, Utah, and other territories." },
                { question: "The rapid migration of people to California in 1849 was known as the ___.", answer: "Gold Rush", hint: "The migrants were called 'Forty-Niners'." },
                { question: "The network of secret routes and safe houses used by enslaved people to escape to freedom was the ___.", answer: "Underground Railroad", hint: "Harriet Tubman was its most famous 'conductor'." },
                { question: "The period of reform and social activism in the mid-1800s is known as the ___.", answer: "Second Great Awakening", hint: "It fueled movements like abolitionism and women's rights." },
                { question: "The movement to end slavery was called ___.", answer: "abolitionism", hint: "Famous leaders included Frederick Douglass and William Lloyd Garrison." },
                { question: "The first women's rights convention was held at ___.", answer: "Seneca Falls", hint: "They issued the 'Declaration of Sentiments'." },
                { question: "The idea that states could choose whether or not to allow slavery was called ___.", answer: "popular sovereignty", hint: "It was a key part of the Kansas-Nebraska Act." },
                { question: "The violent clashes between pro-slavery and anti-slavery settlers in a certain territory earned it the nickname '___ Kansas'.", answer: "Bleeding", hint: "It was a small-scale civil war." },
                { question: "The Supreme Court decision that declared African Americans were not citizens and that Congress could not ban slavery in the territories was the ___ case.", answer: "Dred Scott", hint: "It further divided the nation." },
                { question: "The abolitionist who led a raid on the federal arsenal at Harpers Ferry was ___.", answer: "John Brown", hint: "He was seen as a martyr by the North and a terrorist by the South." },
                { question: "The election of ___ in 1860 led directly to the secession of the first Southern states.", answer: "Abraham Lincoln", hint: "He was the candidate of the Republican Party." },
                { question: "The first state to secede from the Union was ___.", answer: "South Carolina", hint: "It seceded in December 1860." },
                { question: "The Southern states that seceded formed a new nation called the ___.", answer: "Confederate States of America", hint: "Jefferson Davis was their president." },
                { question: "The Civil War began with the Confederate attack on Fort ___.", answer: "Sumter", hint: "It is located in Charleston Harbor." },
                { question: "The Union's three-part strategy to win the war was called the ___.", answer: "Anaconda Plan", hint: "It involved a blockade, controlling the Mississippi, and capturing Richmond." },
                { question: "The bloodiest single-day battle in American history was the Battle of ___.", answer: "Antietam", hint: "Lincoln issued the Emancipation Proclamation after this battle." }
            ],
            grade8: [
                // Unit 1: A Nation in Conflict
                { question: "African Americans who migrated from the South to Kansas after Reconstruction were called ___.", answer: "Exodusters", hint: "They were seeking freedom from the Jim Crow South." },
                { question: "The historian who wrote 'The Significance of the Frontier in American History' was ___.", answer: "Frederick Jackson Turner", hint: "His 'Frontier Thesis' was very influential." },
                { question: "The 1876 battle where General Custer's forces were defeated by the Lakota and Cheyenne was the Battle of ___.", answer: "Little Bighorn", hint: "It is also known as 'Custer's Last Stand'." },
                { question: "The 1890 massacre of Lakota people by the U.S. Army is considered the end of the Indian Wars and is known as the ___ Massacre.", answer: "Wounded Knee", hint: "It followed the Ghost Dance movement." },
                { question: "The U.S. policy of trying to make Native Americans adopt white culture was called ___.", answer: "assimilation", hint: "The Dawes Act and boarding schools were part of this policy." },
                { question: "The civil rights leader who co-founded the NAACP and demanded immediate political equality was ___.", answer: "WEB Du Bois", hint: "He was a critic of Booker T. Washington." },
                { question: "The leader who founded the Tuskegee Institute and promoted vocational education was ___.", answer: "Booker T Washington", hint: "He gave the 'Atlanta Compromise' speech." },
                { question: "The journalist who led a national crusade against lynching was ___.", answer: "Ida B Wells", hint: "She used investigative reporting to expose racial violence." },
                { question: "The early civil rights group founded by W.E.B. Du Bois that was a forerunner to the NAACP was the ___.", answer: "Niagara Movement", hint: "They met on the Canadian side of a famous waterfall." },
                { question: "The system of laws in the South that enforced racial segregation was called the ___ system.", answer: "Jim Crow", hint: "These laws were named after a racist caricature." },
                { question: "The Supreme Court case that established the 'separate but equal' doctrine was ___.", answer: "Plessy v Ferguson", hint: "This 1896 decision legalized segregation." },
                { question: "A college or university founded to provide higher education for African Americans is known as an ___.", answer: "HBCU", hint: "Southern University is an example of a Historically Black College and University." },

                // Unit 2: The Changing Nation
                { question: "The economic system based on private ownership and free competition is known as ___.", answer: "capitalism", hint: "It is also called a 'free market' economy." },
                { question: "A company that has complete control over an industry, eliminating all competition, is a ___.", answer: "monopoly", hint: "Standard Oil was a famous example." },
                { question: "Andrew Carnegie was a captain of the ___ industry.", answer: "steel", hint: "He used the Bessemer process to make it cheaply." },
                { question: "John D. Rockefeller's powerful oil monopoly was named ___.", answer: "Standard Oil", hint: "It was eventually broken up by the government." },
                { question: "The business strategy of owning all the steps in the production process is ___ integration.", answer: "vertical", hint: "Carnegie owned the mines, the ships, and the mills." },
                { question: "The business strategy of buying out all competing companies in the same industry is ___ integration.", answer: "horizontal", hint: "Rockefeller used this method to control 90% of the oil refineries." },
                { question: "The powerful Gilded Age banker and financier who formed companies like General Electric was ___.", answer: "JP Morgan", hint: "His bank is still a major financial institution today." },
                { question: "The self-made millionaire entrepreneur who built a hair care empire for African American women was ___.", answer: "Madam CJ Walker", hint: "She is considered the first female self-made millionaire in America." },
                { question: "The process of moving from farms to cities is called ___.", answer: "urbanization", hint: "Industrial jobs were the main cause of this trend." },
                { question: "Journalists who exposed corruption and social problems during the Progressive Era were called ___.", answer: "muckrakers", hint: "They 'raked the muck' of society." },
                { question: "Upton Sinclair's novel 'The Jungle' led to the passage of the ___ Act.", answer: "Meat Inspection", hint: "It exposed the unsanitary conditions in the food industry." },
                { question: "The muckraker who wrote 'The History of the Standard Oil Company' was ___.", answer: "Ida Tarbell", hint: "Her work helped lead to the breakup of the monopoly." },
                { question: "The first federal law passed in 1890 to break up trusts and monopolies was the ___ Act.", answer: "Sherman Antitrust", hint: "It was named after a senator from Ohio." },
                { question: "The political movement of farmers in the late 1800s that demanded reforms was ___.", answer: "Populism", hint: "The People's Party represented this movement." },
                { question: "An organization for farmers that was a key part of the Populist movement was called a ___.", answer: "Grange", hint: "These started as social clubs for isolated farmers." },

                // Unit 3: The Changing World
                { question: "The war fought between the U.S. and Spain in 1898 was the ___ War.", answer: "Spanish-American", hint: "The sinking of the USS Maine was a major cause." },
                { question: "The policy of a stronger nation extending its control over weaker territories is called ___.", answer: "imperialism", hint: "The U.S. engaged in this at the end of the 19th century." },
                { question: "The man-made waterway that connects the Atlantic and Pacific oceans is the ___.", answer: "Panama Canal", hint: "Its construction was a major engineering feat for Theodore Roosevelt." },
                { question: "The acronym for the four main causes of World War I is ___.", answer: "MAIN", hint: "Militarism, Alliances, Imperialism, Nationalism." },
                { question: "The event that sparked World War I was the assassination of ___.", answer: "Archduke Franz Ferdinand", hint: "He was the heir to the Austro-Hungarian throne." },
                { question: "The initial U.S. policy at the start of WWI was ___.", answer: "neutrality", hint: "President Wilson wanted to keep the U.S. out of the war." },
                { question: "The sinking of the British passenger ship ___ by a German U-boat outraged Americans.", answer: "Lusitania", hint: "Over 100 Americans were killed." },
                { question: "The secret message from Germany proposing an alliance with Mexico was the ___.", answer: "Zimmermann Telegram", hint: "Its publication helped push the U.S. into the war." },
                { question: "The U.S. government sold ___ to the public to help fund the war.", answer: "Liberty Bonds", hint: "This was a way for citizens to loan money to the government." },
                { question: "The government agency that created propaganda to build support for WWI was the Committee on ___.", answer: "Public Information", hint: "It was led by George Creel." },
                { question: "The style of fighting on the Western Front characterized by long, defensive ditches was ___ warfare.", answer: "trench", hint: "This led to a deadly stalemate." },
                { question: "President Wilson's peace plan at the end of WWI was called the ___.", answer: "Fourteen Points", hint: "It included the creation of a League of Nations." },
                { question: "The international peacekeeping organization created after WWI was the ___.", answer: "League of Nations", hint: "The U.S. Senate voted against joining it." },
                { question: "The intense fear of communism in the U.S. after WWI was known as the ___.", answer: "Red Scare", hint: "It was fueled by the Bolshevik Revolution in Russia." },
                { question: "The amendment that granted women the right to vote is the ___ Amendment.", answer: "19th", hint: "It was ratified in 1920 after a long suffrage movement." },
                { question: "A key leader of the women's suffrage movement was ___.", answer: "Susan B Anthony", hint: "She was arrested for voting and her face is on a dollar coin." },
                { question: "The movement of millions of African Americans from the rural South to the urban North was the ___.", answer: "Great Migration", hint: "They were seeking industrial jobs and escaping Jim Crow." },
                { question: "The 1921 race massacre in Oklahoma destroyed a prosperous Black community known as 'Black ___.'", answer: "Wall Street", hint: "This event occurred in the city of Tulsa." },
                { question: "The flourishing of African American art and literature in the 1920s was called the ___.", answer: "Harlem Renaissance", hint: "It was centered in a neighborhood of New York City." },
                { question: "The deadly global pandemic that struck in 1918 was the ___ outbreak.", answer: "influenza", hint: "It killed more people than World War I." }
            ],
        };

        // NEW MYTH DEBUNKER QUESTIONS
        const allMythQuestions = {
            grade6: [
                { question: "MYTH or FACT: Christopher Columbus was the first European to reach the Americas.", isFact: false, explanation: "MYTH: While Columbus's voyages were significant, Vikings like Leif Erikson had established settlements in North America centuries earlier." },
                { question: "MYTH or FACT: The Pilgrims wore all black clothing with large buckles on their hats and shoes.", isFact: false, explanation: "MYTH: This popular image is a 19th-century invention. Historical records show the Pilgrims wore a variety of colorful clothing, typical of English people of their time." },
                { question: "MYTH or FACT: The first representative assembly in the American colonies was Virginia's House of Burgesses.", isFact: true, explanation: "FACT: Established in 1619 in Jamestown, the House of Burgesses was the first elected legislative body in colonial America, setting a precedent for representative government." },
                { question: "MYTH or FACT: The Spanish were the first Europeans to establish a permanent settlement in what is now the United States.", isFact: true, explanation: "FACT: St. Augustine, Florida, founded by the Spanish in 1565, is the oldest continuously inhabited European-established settlement in the United States." },
                { question: "MYTH or FACT: Pocahontas and John Smith had a romantic relationship.", isFact: false, explanation: "MYTH: There is no historical evidence of a romance. Pocahontas was a child (around 10-12 years old) when she knew John Smith, who was an adult. Their relationship was more of a cultural exchange." },
                { question: "MYTH or FACT: The 'First Thanksgiving' in 1621 was a peaceful, happy feast that started a yearly tradition.", isFact: false, explanation: "MYTH: The 1621 harvest meal was a one-time event born of temporary diplomacy. Relations between the colonists and Wampanoag later deteriorated into conflict, like King Philip's War." },
                { question: "MYTH or FACT: The Declaration of Independence was approved on July 4, 1776.", isFact: true, explanation: "FACT: The Second Continental Congress formally approved the final wording of the Declaration of Independence on July 4, 1776, which is why it's the date we celebrate, even though most delegates signed it later in August." },
                { question: "MYTH or FACT: The primary motivation for the Puritans settling Massachusetts Bay was to find gold.", isFact: false, explanation: "MYTH: The Puritans' primary motivation was to create a model religious society‚Äîa 'City upon a Hill'‚Äîwhere they could practice their form of Protestantism without persecution." },
                { question: "MYTH or FACT: Early European settlements like Jamestown were immediately successful and profitable.", isFact: false, explanation: "MYTH: Early settlements like Jamestown suffered greatly from disease, starvation ('The Starving Time'), and conflict, leading to extremely high death rates in the first few years." },
                { question: "MYTH or FACT: Native Americans had no concept of land ownership before Europeans arrived.", isFact: false, explanation: "MYTH: While they did not view land as private property to be bought and sold, Native American tribes had complex systems of land use, with clear territorial boundaries for hunting, farming, and living." },
                { question: "MYTH or FACT: The Mayflower Compact was an early example of self-government in the American colonies.", isFact: true, explanation: "FACT: Signed by the male passengers of the Mayflower in 1620, it was an agreement to create a government and abide by its laws, setting a precedent for democratic rule." },
                { question: "MYTH or FACT: The introduction of tobacco as a cash crop by John Rolfe was crucial for the economic survival of the Jamestown colony.", isFact: true, explanation: "FACT: John Rolfe's successful cultivation of a new strain of tobacco provided Jamestown with a profitable export, ensuring its economic viability after years of struggle." },
                { question: "MYTH or FACT: Roger Williams founded the colony of Rhode Island based on principles of religious freedom and separation of church and state.", isFact: true, explanation: "FACT: Banished from Massachusetts for his dissenting views, Williams established Rhode Island as a haven for religious minorities, advocating for a government that did not interfere with religious beliefs." },
                { question: "MYTH or FACT: The New England colonies had rich, fertile soil that was ideal for large-scale plantation farming.", isFact: false, explanation: "MYTH: New England's rocky soil and short growing season made large-scale farming difficult. Their economy instead focused on shipbuilding, fishing, whaling, and trade." },
                { question: "MYTH or FACT: The Middle Colonies were known for their religious and ethnic diversity, attracting settlers from many different European countries.", isFact: true, explanation: "FACT: Colonies like Pennsylvania, founded by Quakers, promoted religious tolerance, which attracted a wide variety of immigrants including Germans, Scots-Irish, and Dutch, making the region very diverse." }
            ],
            grade7: [
                { question: "MYTH or FACT: George Washington chopped down a cherry tree and said, 'I cannot tell a lie.'", isFact: false, explanation: "MYTH: This famous story was invented by an early biographer, Mason Locke Weems, after Washington's death to illustrate his honesty. There is no historical evidence it ever happened." },
                { question: "MYTH or FACT: The Whiskey Rebellion demonstrated the new federal government's power to enforce its laws.", isFact: true, explanation: "FACT: When President Washington personally led a militia to put down the uprising of tax-protesting farmers, it sent a clear message that the new constitutional government was strong, unlike the weak government under the Articles of Confederation." },
                { question: "MYTH or FACT: Alexander Hamilton and Thomas Jefferson's disagreements led to the formation of the first political parties.", isFact: true, explanation: "FACT: Their profound disagreements on the economy (manufacturing vs. agriculture) and the power of the federal government led to the creation of the Federalist Party (led by Hamilton) and the Democratic-Republican Party (led by Jefferson)." },
                { question: "MYTH or FACT: The Alien and Sedition Acts were created to protect free speech for immigrants.", isFact: false, explanation: "MYTH: These acts did the opposite. They were used by the Federalist party to restrict speech critical of the government and to make it harder for immigrants, who often supported the rival Democratic-Republicans, to become citizens." },
                { question: "MYTH or FACT: The Supreme Court's decision in Marbury v. Madison established the principle of judicial review.", isFact: true, explanation: "FACT: This landmark 1803 case gave the Supreme Court the power to declare an act of Congress unconstitutional, significantly strengthening the judicial branch." },
                { question: "MYTH or FACT: The U.S. fought a long and difficult war against France to acquire the Louisiana Territory.", isFact: false, explanation: "MYTH: The U.S. purchased the Louisiana Territory from France in 1803. Napoleon, needing money for his wars in Europe, sold the vast territory for about $15 million, doubling the size of the United States." },
                { question: "MYTH or FACT: The main goal of the Lewis and Clark expedition was to find a large city of gold.", isFact: false, explanation: "MYTH: The expedition's primary goals were to explore the new Louisiana Territory, find a water route to the Pacific, establish trade with Native Americans, and document plants and animals." },
                { question: "MYTH or FACT: The War of 1812 was a decisive victory for the United States, resulting in the acquisition of Canada.", isFact: false, explanation: "MYTH: The war was largely a stalemate. The Treaty of Ghent, which ended the war, resulted in no territorial changes. The U.S. failed in its invasions of Canada." },
                { question: "MYTH or FACT: The Battle of New Orleans was the decisive final battle that won the War of 1812.", isFact: false, explanation: "MYTH: While a huge American victory, the battle was fought after the Treaty of Ghent, which officially ended the war, had already been signed in Europe. News of the peace treaty had not yet arrived." },
                { question: "MYTH or FACT: The 'Era of Good Feelings' was a time of national unity and pride following the War of 1812.", isFact: true, explanation: "FACT: With the Federalist party collapsing, there was only one major political party (the Democratic-Republicans), leading to a temporary decrease in partisan strife and a surge in American nationalism." },
                { question: "MYTH or FACT: The Monroe Doctrine was a treaty signed with European powers to divide the Americas.", isFact: false, explanation: "MYTH: The Monroe Doctrine was a unilateral declaration by the United States. It warned European powers not to interfere with or create new colonies in the Western Hemisphere." },
                { question: "MYTH or FACT: Henry Clay's 'American System' was a plan to promote economic self-sufficiency through tariffs, a national bank, and internal improvements.", isFact: true, explanation: "FACT: The American System was an economic plan designed to unite the country by protecting American industry, providing national currency and credit, and building roads and canals to link different regions." },
                { question: "MYTH or FACT: The Supreme Court supported the Cherokee Nation's right to their land in Worcester v. Georgia.", isFact: true, explanation: "FACT: The Supreme Court ruled in favor of the Cherokee. However, President Andrew Jackson famously defied the ruling and proceeded with the removal anyway, showing the limits of the Court's power." },
                { question: "MYTH or FACT: The invention of the cotton gin made slavery less necessary in the South.", isFact: false, explanation: "MYTH: The cotton gin made processing cotton far more profitable, which massively increased the demand for enslaved labor to plant and pick it, further entrenching slavery in the Southern economy." },
                { question: "MYTH or FACT: The U.S. annexed Texas immediately after it won its independence from Mexico in 1836.", isFact: false, explanation: "MYTH: The U.S. waited nearly a decade to annex Texas, largely due to fears that adding a large new slave state would upset the political balance in the country and lead to war with Mexico." }
            ],
            grade8: [
                { question: "MYTH or FACT: The 'Wild West' was a lawless place where gunfights happened every day.", isFact: false, explanation: "MYTH: While the frontier could be dangerous, most western towns had strict gun control laws. Gunfights were rare and not the dramatic 'high noon' duels seen in movies." },
                { question: "MYTH or FACT: The 'Exodusters' were African Americans who migrated from the South to Kansas after Reconstruction to escape oppression.", isFact: true, explanation: "FACT: This mass migration in the late 1870s was one of the first major movements of African Americans out of the post-Reconstruction South, seeking land and freedom from Jim Crow violence." },
                { question: "MYTH or FACT: The U.S. government used the Sherman Antitrust Act to break up monopolies.", isFact: true, explanation: "FACT: Although it was weak at first, the Sherman Antitrust Act was later used by presidents like Theodore Roosevelt to break up powerful trusts, including John D. Rockefeller's Standard Oil company." },
                { question: "MYTH or FACT: The sinking of the USS Maine was proven to be a direct attack by Spain.", isFact: false, explanation: "MYTH: While 'yellow journalism' blamed Spain, investigations have concluded the explosion was likely accidental, caused by an internal fire. There was no evidence of a Spanish mine." },
                { question: "MYTH or FACT: Henry Ford invented the automobile.", isFact: false, explanation: "MYTH: Karl Benz is credited with inventing the first practical automobile in 1886. Ford's major contribution was the moving assembly line, which made cars affordable for the masses." },
                { question: "MYTH or FACT: Muckraking journalists helped bring about reforms during the Progressive Era.", isFact: true, explanation: "FACT: Journalists like Upton Sinclair ('The Jungle') and Ida Tarbell ('The History of the Standard Oil Company') exposed corruption and social problems, leading to public outcry and new laws like the Pure Food and Drug Act." },
                { question: "MYTH or FACT: The 'separate but equal' doctrine from Plessy v. Ferguson led to facilities for Black Americans that were truly equal to those for whites.", isFact: false, explanation: "MYTH: In reality, 'separate' almost always meant 'unequal.' Facilities for African Americans under Jim Crow were consistently underfunded, inferior, and poorly maintained." },
                { question: "MYTH or FACT: The U.S. government actively worked to preserve the buffalo herds for Native American tribes during westward expansion.", isFact: false, explanation: "MYTH: The extermination of the buffalo was encouraged by some U.S. officials as a way to subdue Plains tribes by destroying their primary resource for food, shelter, and tools." },
                { question: "MYTH or FACT: Booker T. Washington and W.E.B. Du Bois were close allies who agreed on the best strategies for Black advancement.", isFact: false, explanation: "MYTH: They had famously different views. Washington advocated for economic advancement before seeking political equality (the 'Atlanta Compromise'), while Du Bois demanded immediate political and social equality." },
                { question: "MYTH or FACT: Most immigrants who came to the U.S. during the Gilded Age found it easy to get high-paying, safe factory jobs.", isFact: false, explanation: "MYTH: Most industrial jobs for new immigrants involved long hours, low wages, and dangerous working conditions. Child labor was also common due to family poverty." },
                { question: "MYTH or FACT: The 19th Amendment, which granted women the right to vote, was passed with very little opposition.", isFact: false, explanation: "MYTH: The women's suffrage movement struggled for decades. Activists like Susan B. Anthony and Alice Paul faced arrest, imprisonment, and violent opposition before the amendment was finally ratified in 1920." },
                { question: "MYTH or FACT: The United States joined the League of Nations after World War I to help prevent future wars.", isFact: false, explanation: "MYTH: Although President Woodrow Wilson was the main advocate for the League of Nations, the U.S. Senate refused to ratify the treaty, and the United States never joined. The country returned to a policy of isolationism." },
                { question: "MYTH or FACT: The Populist Party was a political movement created to support the interests of wealthy bankers and industrialists.", isFact: false, explanation: "MYTH: The Populist (or People's) Party was a movement of farmers and laborers created to fight against the power of big business, banks, and railroads, which they felt were exploiting them." },
                { question: "MYTH or FACT: The United States acquired Hawaii by signing a mutual treaty with the Hawaiian queen.", isFact: false, explanation: "MYTH: The Hawaiian monarchy, led by Queen Lili ªuokalani, was overthrown in 1893 by a group of American businessmen with the help of U.S. Marines. The U.S. then annexed the islands a few years later." },
                { question: "MYTH or FACT: The Zimmermann Telegram was a secret message from Germany to Mexico proposing an alliance against the United States during WWI.", isFact: true, explanation: "FACT: Intercepted by British intelligence, the telegram promised to help Mexico recover territory lost to the U.S. Its publication outraged Americans and was a major factor in the U.S. decision to enter the war." }
            ]
        };


        // --- GAME STATE ---
        let playerState = {};
        let timerInterval = null;
        let timeLeft = 300; 
        let storeNotificationInterval = null;
        let currentQuestionIndex = -1;
        let questionsCopy = [];
        let activeQuestionSet = [];
        let wrongAnswers = [];
        let abilities = {};
        let notificationQueue = []; 
        let isModalActive = false; 
        let isGamePaused = false;
        let notificationTimer = null;
        let isMuted = false;
        let lastNotificationMessage = '';
        let reviewIndex = 0;
        let gameMode = 'EASY';
        let sigmaStage = 1;
        let sigmaCorrectInStage = 0;
        let timeHistory = [];
        const correctMessages = [
            "Excellent!",
            "Great job!",
            "You're on fire!",
            "That's right!",
            "Keep it up!",
            "Awesome!",
            "Correct! You've got this.",
            "Nice one!",
            "Brilliant!",
            "You're a history whiz!"
        ];

        // --- DOM ELEMENTS ---
        const bodyEl = document.body;
        const timerEl = document.getElementById('timer');
        const timeCardEl = document.getElementById('timeCard');
        const scoreEl = document.getElementById('score');
        const streakEl = document.getElementById('streak');
        const correctAnswersEl = document.getElementById('correctAnswers');
        const gameAreaEl = document.getElementById('gameArea');
        const questionTextEl = document.getElementById('questionText');
        const answerChoices = document.querySelectorAll('.answer-choice');
        const headerGridEl = document.getElementById('headerGrid');
        
        // Modals
        const difficultyModal = document.getElementById('difficultyModal');
        const gradeModal = document.getElementById('gradeModal');
        const endGameModal = document.getElementById('endGameModal');
        const reviewModal = document.getElementById('reviewModal');
        const easyRulesModal = document.getElementById('easyRulesModal');
        const hardRulesModal = document.getElementById('hardRulesModal');
        const mythRulesModal = document.getElementById('mythRulesModal');
        const skibidiRulesModal = document.getElementById('skibidiRulesModal');
        const aboutModal = document.getElementById('aboutModal');
        const resetConfirmModal = document.getElementById('resetConfirmModal');
        const hintModal = document.getElementById('hintModal');
        const settingsModal = document.getElementById('settingsModal');
        const streakModal = document.getElementById('streakModal');
        const streakTextEl = document.getElementById('streakText');
        const abilityInfoModal = document.getElementById('abilityInfoModal');
        const pantherBuckModal = document.getElementById('pantherBuckModal');
        const storeModal = document.getElementById('storeModal');
        const hunchUpgradeStoreItem = document.getElementById('hunchUpgradeStoreItem');
        const sigmaRulesModal = document.getElementById('sigmaRulesModal');
        const skibidiIncorrectModal = document.getElementById('skibidiIncorrectModal');
        const firstLetterModal = document.getElementById('firstLetterModal');
        
        const explanationModal = document.getElementById('explanationModal');
        const explanationTextEl = document.getElementById('explanationText');
        const sigmaStageUpModal = document.getElementById('sigmaStageUpModal');
        const dokLabel = document.getElementById('dokLabel');
        const closeSigmaStageUpBtn = document.getElementById('closeSigmaStageUpBtn');
        // Sigma Mode UI
        const sigmaProgressContainer = document.getElementById('sigmaProgressContainer');
        const sigmaProgressBar = document.getElementById('sigmaProgressBar');
        const sigmaProgressText = document.getElementById('sigmaProgressText');
        const sigmaStageDisplay = document.getElementById('sigmaStageDisplay');


        // Buttons
        const easyModeBtn = document.getElementById('easyModeBtn');
        const hardModeBtn = document.getElementById('hardModeBtn');
        const skibidiModeBtn = document.getElementById('skibidiModeBtn');
        const acceptEasyBtn = document.getElementById('acceptEasyBtn');
        const declineEasyBtn = document.getElementById('declineEasyBtn');
        const acceptHardBtn = document.getElementById('acceptHardBtn');
        const declineHardBtn = document.getElementById('declineHardBtn');
        const acceptSkibidiBtn = document.getElementById('acceptSkibidiBtn');
        const declineSkibidiBtn = document.getElementById('declineSkibidiBtn');
        const mythModeBtn = document.getElementById('mythModeBtn');
        const acceptMythBtn = document.getElementById('acceptMythBtn');
        const declineMythBtn = document.getElementById('declineMythBtn');
        const sigmaModeBtn = document.getElementById('sigmaModeBtn');
        const acceptSigmaBtn = document.getElementById('acceptSigmaBtn');
        const declineSigmaBtn = document.getElementById('declineSigmaBtn');
        const backToDifficultyBtn = document.getElementById('backToDifficultyBtn');
        const gradeLevelSelect = document.getElementById('gradeLevelSelect');
        const startGameBtn = document.getElementById('startGameBtn');
        const newGameBtn = document.getElementById('newGameBtn');
        const storeBtn = document.getElementById('storeBtn');
        const reviewMistakesBtn = document.getElementById('reviewMistakesBtn');
        const closeReviewBtn = document.getElementById('closeReviewBtn');
        const nextReviewBtn = document.getElementById('nextReviewBtn');
        const prevReviewBtn = document.getElementById('prevReviewBtn');
        const endTurnBtn = document.getElementById('endTurnBtn');
        const resetAllBtn = document.getElementById('resetAllBtn');
        const aboutBtn = document.getElementById('aboutBtn');
        const hintBtn = document.getElementById('hintBtn');
        const closeAboutBtn = document.getElementById('closeAboutBtn');
        const settingsBtn = document.getElementById('settingsBtn');
        const closeSettingsBtn = document.getElementById('closeSettingsBtn');
        const soundToggle = document.getElementById('soundToggle');
        const confirmResetBtn = document.getElementById('confirmResetBtn');
        const cancelResetBtn = document.getElementById('cancelResetBtn');
        const closeHintBtn = document.getElementById('closeHintBtn');
        const closeStreakBtn = document.getElementById('closeStreakBtn');
        const closeAbilityInfoBtn = document.getElementById('closeAbilityInfoBtn');
        const closePantherBuckBtn = document.getElementById('closePantherBuckBtn');
        const closeStoreBtn = document.getElementById('closeStoreBtn');
        const buyBtns = document.querySelectorAll('.buy-btn');
        const closeSkibidiIncorrectBtn = document.getElementById('closeSkibidiIncorrectBtn');
        const closeExplanationBtn = document.getElementById('closeExplanationBtn');
        const firstLetterBtn = document.getElementById('firstLetterBtn');
        const closeFirstLetterBtn = document.getElementById('closeFirstLetterBtn');
        const sigmaStageUpText = document.getElementById('sigmaStageUpText');

        // Modal Content
        const finalScoreEl = document.getElementById('finalScore');
        const mistakesReviewTextEl = document.getElementById('mistakesReviewText');
        const reviewQuestionEl = document.getElementById('reviewQuestion');
        const reviewChoicesEl = document.getElementById('reviewChoices');
        const reviewUserAnswerEl = document.getElementById('reviewUserAnswer');
        const reviewUserAnswerTextEl = document.getElementById('reviewUserAnswerText');
        const hintTextEl = document.getElementById('hintText');
        const storeScoreDisplay = document.getElementById('storeScoreDisplay');
        const skibidiCorrectAnswerTextEl = document.getElementById('skibidiCorrectAnswerText');
        const firstLetterTextEl = document.getElementById('firstLetterText');
        
        // Ability & Notification Elements
        const abilitySkipEl = document.getElementById('abilitySkip');
        const abilityRedoEl = document.getElementById('abilityRedo');
        const abilityBoostEl = document.getElementById('abilityBoost');
        const abilityInfoBtn = document.getElementById('abilityInfoBtn');
        const skipUsesEl = document.getElementById('skipUses');
        const redoUsesEl = document.getElementById('redoUses');
        const hunchAbilityEl = document.getElementById('hunchAbility');
        const tinkerAbilityEl = document.getElementById('tinkerAbility');
        const pantherBuckAbilityEl = document.getElementById('pantherBuckAbility');
        const hunchProgressEl = document.getElementById('hunchProgress');
        const tinkerProgressEl = document.getElementById('tinkerProgress');
        const pantherBuckProgressEl = document.getElementById('pantherBuckProgress');
        const pantherBuckCounterEl = document.getElementById('pantherBuckCounter');
        const notificationTextEl = document.getElementById('notificationText');

        // Skibidi Mode elements
        const answerAreaEl = document.getElementById('answerArea');
        const skibidiFormEl = document.getElementById('skibidi-form');
        const skibidiInputEl = document.getElementById('skibidi-input');
        const answerGridEl = document.querySelector('.answer-grid');
        // NEW Myth Mode elements
        const mythAnswerButtons = document.getElementById('mythAnswerButtons');
        const factBtn = document.getElementById('factBtn');
        const mythBtn = document.getElementById('mythBtn');


        // --- SOUND ENGINE ---
        const filter = new Tone.Filter(400, "lowpass").toDestination();
        const filterEnv = new Tone.FrequencyEnvelope({
            attack: 0.01,
            decay: 0.1,
            sustain: 0,
            release: 0.1,
            baseFrequency: 200,
            octaves: 2
        });
        filterEnv.connect(filter.frequency);
        const synth = new Tone.PolySynth(Tone.Synth).toDestination();
        const pluckSynth = new Tone.PluckSynth().connect(filter);

        function playCorrectSound() {
            if (isMuted) return;
            const now = Tone.now();
            synth.triggerAttackRelease("C4", "8n", now);
            synth.triggerAttackRelease("E4", "8n", now + 0.1);
            synth.triggerAttackRelease("G4", "8n", now + 0.2);
            synth.triggerAttackRelease("C5", "8n", now + 0.3);
        }
        function playIncorrectSound() { if (isMuted) return;
            const now = Tone.now();
            synth.triggerAttackRelease("C2", "8n", now);
        }
        function playClickSound() { if (isMuted) return;
            pluckSynth.triggerAttack("C4", Tone.now());
            filterEnv.triggerAttack();
        }
        function playPurchaseSound() { if (isMuted) return;
            const now = Tone.now();
            synth.triggerAttackRelease("E5", "16n", now);
            synth.triggerAttackRelease("G5", "16n", now + 0.1);
        }
        function playStartSound() { if (isMuted) return;
            const now = Tone.now();
            synth.triggerAttackRelease("G3", "8n", now);
            synth.triggerAttackRelease("C4", "8n", now + 0.1);
        }
        function playStreakSound() { if (isMuted) return;
            const now = Tone.now();
            synth.triggerAttackRelease("G4", "8n", now);
            synth.triggerAttackRelease("C5", "8n", now + 0.1);
            synth.triggerAttackRelease("E5", "4n", now + 0.2);
        }
        function playPantherBuckSound() {
            const now = Tone.now();
            if (!isMuted) synth.triggerAttackRelease("A5", "8n", now);
        }

        // --- HELPER & NOTIFICATION FUNCTIONS ---
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        function adjustFontSize(element) {
            let fontSize = 150; // Start with a very large font size
            element.style.fontSize = `${fontSize}px`;

            // Loop to reduce font size until the text fits within the element's own bounds
            while ((element.scrollHeight > element.clientHeight || element.scrollWidth > element.clientWidth) && fontSize > 10) {
                fontSize--;
                element.style.fontSize = `${fontSize}px`;
            }
        }
        
        function triggerConfetti() {
            confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 }, zIndex: 101 });
        }
        
        function addNotification(notification) {
            notificationQueue.push(notification);
            processNotificationQueue();
        }

        function processNotificationQueue() {
            if (isModalActive || notificationQueue.length === 0) {
                return;
            }
            isModalActive = true;
            const notification = notificationQueue.shift();
            
            triggerConfetti();

            if (notification.type === 'streak') {
                playStreakSound();
                streakTextEl.textContent = notification.text;
                streakModal.classList.remove('hidden');
            } else if (notification.type === 'pantherBuck') {
                playPantherBuckSound();
                pantherBuckModal.classList.remove('hidden');
            }
        }
        
        function updateNotification(message) {
            if (message === lastNotificationMessage) return; 
            lastNotificationMessage = message;

            if (notificationTimer) clearTimeout(notificationTimer);

            // Reset all animations and content
            notificationTextEl.classList.remove('typing', 'glitch');
            notificationTextEl.textContent = '';
            notificationTextEl.dataset.text = '';

            // Force a reflow to restart the animation
            void notificationTextEl.offsetWidth;

            notificationTextEl.textContent = message;
            notificationTextEl.classList.add('typing');

            notificationTimer = setTimeout(() => {
                notificationTextEl.classList.remove('typing');
                notificationTextEl.classList.add('glitch');
                notificationTextEl.dataset.text = message; // Apply text for glitch effect
            }, 1000); // Duration should match the typing animation
        }
        
        // --- STORE LOGIC ---
        const storeItems = {
            timeFreeze: { cost: 3 },
            timeBoost: { cost: 8 },
            chronosReserve: { cost: 10 },
            diplomatsPass: { cost: 8 },
            hunchUpgrade: { cost: 15, permanent: true },
            streakInsurance: { cost: 5 },
            scholarsBookmark: { cost: 4 },
            loreMastersScroll: { cost: 25, permanent: true },
            firstLastLetterUpgrade: { cost: 3, permanent: true }
        };

        function openStore() {
            playClickSound();
            storeScoreDisplay.textContent = Math.floor(playerState.score);

            buyBtns.forEach(btn => {
                let originalItemName = btn.getAttribute('data-item-original') || btn.dataset.item;
                if (!btn.getAttribute('data-item-original')) {
                    btn.setAttribute('data-item-original', originalItemName);
                }

                let itemName = originalItemName;

                // Toggle store items based on game mode
                if (originalItemName === 'hunchUpgrade') {
                    const isSkibidi = gameMode === 'SKIBIDI';
                    hunchUpgradeStoreItem.classList.toggle('hidden', isSkibidi);
                    firstLastLetterStoreItem.classList.toggle('hidden', !isSkibidi);
                    if (isSkibidi) {
                        itemName = 'firstLastLetterUpgrade';
                    } else {
                        itemName = 'hunchUpgrade';
                    }
                    btn.textContent = `Buy (${storeItems[itemName].cost} Pts)`; // Explicitly update text here
                    btn.dataset.item = itemName; // Update the button's current data attribute
                }

                // Re-fetch item after potential name change
                const currentItem = storeItems[itemName];
                if (!currentItem) return;

                // Disable if already purchased (for permanent items)
                if (currentItem.permanent && ((abilities.hunchUpgraded && itemName === 'hunchUpgrade') || (abilities.loreMasterActive && itemName === 'loreMastersScroll') || (abilities.firstLastLetterUpgraded && itemName === 'firstLastLetterUpgrade'))) {
                    btn.disabled = true;
                    btn.textContent = 'Purchased';
                    btn.classList.add('purchased');
                }

                // Disable if already have an active consumable
                else if ( (itemName === 'streakInsurance' && abilities.streakInsurance) || (itemName === 'diplomatsPass' && abilities.diplomatsPass) ) {
                     btn.disabled = true;
                     btn.textContent = 'Active';
                }
                // Disable if not enough points
                else if (playerState.score < currentItem.cost) {
                    btn.disabled = true;
                } else {
                    btn.disabled = false;
                    btn.textContent = `Buy (${currentItem.cost} Pts)`;
                    btn.classList.remove('purchased');
                }
            });

            storeModal.classList.remove('hidden');
        }

        function buyItem(e) {
            const itemName = e.target.dataset.item;
            const item = storeItems[itemName];

            if (playerState.score >= item.cost) {
                playPurchaseSound();
                playerState.score -= item.cost;
                scoreEl.textContent = Math.floor(playerState.score);

                // Apply item effect
                switch (itemName) {
                    case 'timeFreeze':
                        timeLeft += 30;
                        timeCardEl.classList.add('flash-green');
                        setTimeout(() => timeCardEl.classList.remove('flash-green'), 1000);
                        updateNotification("+30 seconds purchased!");
                        break;
                    case 'timeBoost':
                        timeLeft += 60;
                        timeCardEl.classList.add('flash-green');
                        setTimeout(() => timeCardEl.classList.remove('flash-green'), 1000);
                        updateNotification("+60 seconds purchased!");
                        break;
                    case 'chronosReserve':
                        const targetIndex = Math.max(0, timeHistory.length - 60);
                        timeLeft = timeHistory[targetIndex];
                        timeCardEl.classList.add('flash-green');
                        setTimeout(() => timeCardEl.classList.remove('flash-green'), 1000);
                        updateNotification("Time reverted by 60 seconds!");
                        break;
                    case 'diplomatsPass':
                        abilities.diplomatsPass = true;
                        updateNotification("Diplomat's Pass is active!");
                        break;
                    case 'hunchUpgrade':
                        abilities.hunchUpgraded = true;
                        updateNotification("Hunch Upgrade purchased!");
                        break;
                    case 'streakInsurance':
                        abilities.streakInsurance = true;
                        updateNotification("Streak Insurance is active!");
                        break;
                    case 'scholarsBookmark':
                        abilities.skip++;
                        updateAbilitiesUI();
                        updateNotification("Scholar's Bookmark purchased! +1 SKIP.");
                        break;
                    case 'loreMastersScroll':
                        // Ensure score is updated immediately if it's not a whole number
                        if (playerState.score % 1 !== 0) {
                            scoreEl.textContent = playerState.score.toFixed(2);
                        }
                        abilities.loreMasterActive = true;
                        updateNotification("Lore Master's Scroll purchased!");
                        break;
                    case 'firstLastLetterUpgrade':
                        abilities.firstLastLetterUpgraded = true;
                        firstLetterBtn.classList.add('first-letter-btn-glow');
                        updateNotification("Letter Insight purchased!");
                        break;
                }
                openStore(); // Refresh store UI after purchase
            }
        }


        // --- ABILITY LOGIC ---
        function updateAbilitiesUI() {
            const isSkibidi = gameMode === 'SKIBIDI';
            const hunchThreshold = isSkibidi ? 3 : 5;
            const tinkerThreshold = isSkibidi ? 2 : 4;
            const buckStreakThreshold = gameMode === 'HARD' ? 7 : (isSkibidi ? 5 : 10);

            pantherBuckCounterEl.textContent = `${playerState.pantherBucksEarned} üêæ`;
            
            if(isSkibidi) {
                hunchAbilityEl.style.display = 'none';
            } else {
                hunchAbilityEl.style.display = 'block';
                const hunchProgress = (playerState.correctAnswers % hunchThreshold) / hunchThreshold * 100;
                hunchProgressEl.style.width = `${hunchProgress}%`;
                hunchAbilityEl.classList.toggle('ready', hunchProgress >= 80);
                hunchAbilityEl.querySelector('.passive-ability-title').textContent = `Historian's Hunch (Next: ${hunchThreshold})`;
                if (hunchProgress > 50) {
                    hunchAbilityEl.classList.add('jiggle');
                    const duration = 0.4 - ((hunchProgress - 50) / 50) * 0.3; 
                    hunchAbilityEl.style.animationDuration = `${duration}s`;
                } else {
                    hunchAbilityEl.classList.remove('jiggle');
                    hunchAbilityEl.style.animationDuration = '';
                }
            }

            const tinkerProgress = Math.min((playerState.streak / tinkerThreshold) * 100, 100);
            tinkerProgressEl.style.width = `${tinkerProgress}%`;
            tinkerAbilityEl.classList.toggle('ready', playerState.streak >= tinkerThreshold);
            tinkerAbilityEl.querySelector('.passive-ability-title').textContent = `Time Tinkerer (Streak: ${tinkerThreshold})`;
            if (tinkerProgress > 50) {
                tinkerAbilityEl.classList.add('jiggle');
                const duration = 0.4 - ((tinkerProgress - 50) / 50) * 0.3; 
                tinkerAbilityEl.style.animationDuration = `${duration}s`;
            } else {
                tinkerAbilityEl.classList.remove('jiggle');
                tinkerAbilityEl.style.animationDuration = '';
            }

            // Update Panther Buck progress bar based on current streak
            const buckProgress = (playerState.streak % buckStreakThreshold) / buckStreakThreshold * 100;
            pantherBuckProgressEl.style.width = `${buckProgress}%`;
            pantherBuckAbilityEl.querySelector('.passive-ability-title').textContent = `Panther Buck (Streak: ${buckStreakThreshold})`;
            if (abilities.skip > 0) {
                abilitySkipEl.classList.remove('locked');
                abilitySkipEl.classList.add('earned');
                skipUsesEl.textContent = abilities.skip;
                skipUsesEl.classList.remove('hidden');
            } else {
                abilitySkipEl.classList.add('locked');
                abilitySkipEl.classList.remove('earned');
                skipUsesEl.classList.add('hidden');
            }
            if (abilities.redo > 0) {
                abilityRedoEl.classList.remove('locked');
                abilityRedoEl.classList.add('earned');
                redoUsesEl.textContent = abilities.redo;
                redoUsesEl.classList.remove('hidden');
            } else {
                abilityRedoEl.classList.add('locked');
                abilityRedoEl.classList.remove('earned');
                redoUsesEl.classList.add('hidden');
            }
            if (abilities.boost2xActive || abilities.boost3xActive) {
                abilityBoostEl.classList.remove('locked');
                abilityBoostEl.classList.add('active');
            } else {
                abilityBoostEl.classList.remove('active');
                // The 'locked' class is only added if no boost is active and streak is 0
                if (playerState.streak < (isSkibidi ? 4 : 7)) abilityBoostEl.classList.add('locked');
            }
        }
        
        function activateSkip() {
            if (abilities.skip > 0) {
                playClickSound();
                abilities.skip--;
                updateAbilitiesUI();
                updateNotification("Question skipped!");
                displayNextQuestion();
            }
        }

        function activateRedo() {
            if (abilities.redo > 0 && wrongAnswers.length > 0) {
                playClickSound();
                abilities.redo--;
                if (currentQuestionIndex !== -1) {
                    const currentQuestionObject = activeQuestionSet[currentQuestionIndex];
                    questionsCopy.push(currentQuestionObject);
                    shuffleArray(questionsCopy);
                }
                const questionsToRedo = wrongAnswers.map(index => activeQuestionSet[index]);
                questionsCopy.unshift(...questionsToRedo);
                updateNotification(`Second Chance! Answering ${wrongAnswers.length} questions again.`);
                wrongAnswers = [];
                updateAbilitiesUI();
                displayNextQuestion();
            }
        }

        // --- CORE GAME LOGIC ---
        function resetPlayerState() {
             playerState = { 
                score: 0, questionsAnswered: 0, streak: 0, correctAnswers: 0,
                wrongStreak: 0, earned10Streak: false,
                earned3Streak: false, earned4Streak: false, earned5Streak: false, earned7Streak: false, hasSeenStoreInvite: false, pantherBucksAwardedForStreaks: [],
                historiansHunchPending: false, pantherBucksEarned: 0
            };
            abilities = { 
                skip: 0, redo: 0, boost2xActive: false, boost3xActive: false,
                hunchUpgraded: false, streakInsurance: false, // Reset store-bought abilities
                loreMasterActive: false, diplomatsPass: false, historiansArchive: false, firstLastLetterUpgraded: false
            };
            wrongAnswers = [];
        }

        async function startGame() {
            await Tone.start();
            if (storeNotificationInterval) clearInterval(storeNotificationInterval);
            playStartSound();
            resetPlayerState();
            isGamePaused = false; // Explicitly unpause the game at the start
            scoreEl.textContent = '0';
            streakEl.textContent = '0';
            correctAnswersEl.textContent = '0';
            sigmaProgressContainer.classList.add('hidden'); // Hide by default
            gradeModal.classList.add('hidden');

            const selectedGrade = gradeLevelSelect.value;
            let questionBank;
            let initialNotification = "The challenge has begun. Good luck!";

            if (gameMode === 'SIGMA') {
                sigmaStage = 1;
                sigmaCorrectInStage = 0;
                sigmaProgressContainer.classList.remove('hidden');
                // Start with easy questions for stage 1
                activeQuestionSet = allQuestions[selectedGrade];
                questionsCopy = [...activeQuestionSet];
                initialNotification = "SIGMA MODE: Stage 1 - Easy Questions. Good luck!";
            } else {
                if (gameMode === 'SKIBIDI') {
                    questionBank = allSkibidiQuestions;
                } else if (gameMode === 'HARD') {
                    questionBank = allHardQuestions;
                } else if (gameMode === 'MYTH') {
                    questionBank = allMythQuestions;
                } else {
                    questionBank = allQuestions;
                }
                activeQuestionSet = questionBank[selectedGrade];
                questionsCopy = [...activeQuestionSet];
                shuffleArray(questionsCopy);
            }

            shuffleArray(questionsCopy);
            // UI setup based on game mode
            const isSkibidi = gameMode === 'SKIBIDI';
            answerGridEl.classList.toggle('hidden', isSkibidi);
            skibidiFormEl.classList.toggle('hidden', !isSkibidi);
            mythAnswerButtons.classList.add('hidden'); // Hide myth buttons by default
            hunchAbilityEl.classList.toggle('hidden', isSkibidi);
            firstLetterBtn.classList.toggle('hidden', !isSkibidi);
            if (isSkibidi) {
                firstLetterBtn.classList.remove('first-letter-btn-glow');
                hunchUpgradeStoreItem.nextElementSibling.dataset.item = 'firstLastLetterUpgrade';
            } else {
                hunchUpgradeStoreItem.nextElementSibling.dataset.item = 'hunchUpgrade';
            }

            updateAbilitiesUI();
            startTimer();
            updateNotification(initialNotification);
            displayNextQuestion();
            if (gameMode === 'SIGMA') {
                updateSigmaProgress();
            }
            startStoreNotifier();
        }

        function updateSigmaProgress() {
            if (gameMode !== 'SIGMA') return;

            const totalQuestionsInStage = activeQuestionSet.length;
            const requiredForNextStage = Math.ceil(totalQuestionsInStage / 2);

            // Progress is now based on correct answers in the stage
            const progress = (sigmaCorrectInStage / requiredForNextStage) * 100;
            sigmaProgressBar.style.width = `${progress}%`;
            sigmaProgressText.textContent = `${sigmaCorrectInStage} / ${requiredForNextStage} Correct`;
            sigmaStageDisplay.textContent = sigmaStage;
        }
        function startTimer() {
            if (timerInterval) clearInterval(timerInterval);
            timeLeft = gameMode === 'SIGMA' ? 60 : 300;
            timeHistory = [timeLeft];
            const initialMinutes = Math.floor(timeLeft / 60).toString().padStart(2, '0');
            const initialSeconds = (timeLeft % 60).toString().padStart(2, '0');

            timerEl.textContent = `${initialMinutes}:${initialSeconds}`;
            timerInterval = setInterval(() => {
                if (isGamePaused) return;
                timeLeft--;
                timeHistory.push(timeLeft);
                const minutes = Math.floor(timeLeft / 60).toString().padStart(2, '0');
                const seconds = (timeLeft % 60).toString().padStart(2, '0');
                timerEl.textContent = `${minutes}:${seconds}`;

                if (timeLeft === 150) updateNotification("Halfway through! Keep up the pace!");
                else if (timeLeft === 60) updateNotification("Warning: One minute remaining!");

                if (timeLeft <= 0) endGame();
            }, 1000);
        }
        
        function startStoreNotifier() {
            if (storeNotificationInterval) clearInterval(storeNotificationInterval);

            storeNotificationInterval = setInterval(() => {
                if (isGamePaused || isModalActive) return;

                // Find the minimum cost of an available item
                const minCost = Object.values(storeItems)
                    .filter(item => !item.permanent || !isItemPurchased(item))
                    .reduce((min, item) => Math.min(min, item.cost), Infinity);

                if (playerState.score >= minCost) {
                    storeBtn.classList.add('store-ready');
                    updateNotification("You have enough points to buy items in the store! üõçÔ∏è");
                } else {
                    storeBtn.classList.remove('store-ready');
                }
            }, 10000); // Check every 10 seconds
        }

        function isItemPurchased(item) { return false; /* Placeholder for more complex logic if needed */ }

        function displayNextQuestion() {
            gameAreaEl.classList.add('switching');
            setTimeout(() => {
                const totalQuestionsInStage = activeQuestionSet.length;
                const requiredForNextStage = Math.ceil(totalQuestionsInStage / 2);

                // SIGMA Mode Stage Progression
                if (gameMode === 'SIGMA' && sigmaCorrectInStage >= requiredForNextStage) {
                    sigmaStage++;
                    const selectedGrade = gradeLevelSelect.value;
                    let nextQuestionSet = null;
                    let stageName = '';

                    if (sigmaStage === 2) {
                        nextQuestionSet = allHardQuestions[selectedGrade];
                        stageName = 'Hard';
                    } else if (sigmaStage === 3) {
                        nextQuestionSet = allSkibidiQuestions[selectedGrade];
                        stageName = 'Skibidi';
                    }

                    if (nextQuestionSet) {
                        activeQuestionSet = nextQuestionSet;
                        isGamePaused = true;
                        questionsCopy = [...activeQuestionSet];
                        shuffleArray(questionsCopy);
                        sigmaCorrectInStage = 0; // Reset correct counter for new stage
                        
                        sigmaStageUpText.textContent = `Congratulations! You are now entering Stage ${sigmaStage}: ${stageName} Questions!`;
                        sigmaStageUpModal.classList.remove('hidden');

                        updateSigmaProgress();
                        playStreakSound();
                    } else {
                        // All stages are complete
                        endGame();
                        return;
                    }
                }

                if (questionsCopy.length === 0) {
                    endGame();
                    return;
                }

                
                const question = questionsCopy.shift();
                currentQuestionIndex = activeQuestionSet.indexOf(question); // Keep track of the original question
                
                const isMythTypeQuestion = gameMode === 'MYTH';
                const isSkibidiTypeQuestion = gameMode === 'SKIBIDI' || (gameMode === 'SIGMA' && sigmaStage === 3);

                // Reset UI elements for all modes
                answerGridEl.classList.add('hidden');
                skibidiFormEl.classList.add('hidden');
                mythAnswerButtons.classList.add('hidden');
                hintBtn.classList.add('hidden'); // Hide by default, then show if applicable
                firstLetterBtn.classList.add('hidden'); // Hide by default, then show if applicable
                dokLabel.classList.add('hidden'); // Hide by default, then show if applicable

                // DOK Label Logic
                // DOK is only relevant for multiple-choice questions (Easy/Hard/Sigma-MC)
                if (question.dok && (gameMode === 'EASY' || gameMode === 'HARD' || (gameMode === 'SIGMA' && sigmaStage < 3))) {
                    dokLabel.textContent = `DOK ${question.dok}`;
                    dokLabel.classList.remove('hidden');
                } else {
                    dokLabel.classList.add('hidden');
                }


                if (isMythTypeQuestion) {
                    // --- MYTH DEBUNKER LOGIC ---
                    mythAnswerButtons.classList.remove('hidden');
                    factBtn.disabled = false;
                    mythBtn.disabled = false;
                } else if (isSkibidiTypeQuestion) {
                    // --- TYPED ANSWER LOGIC (SKIBIDI/SIGMA-SKIBIDI) ---
                    skibidiFormEl.classList.remove('hidden');
                    firstLetterBtn.classList.remove('hidden'); // Show letter hint button for skibidi
                } else {
                    // --- MULTIPLE CHOICE LOGIC (EASY/HARD/SIGMA-MC) ---
                    answerGridEl.classList.remove('hidden');
                    hintBtn.classList.remove('hidden'); // Show the standard hint button
                }


                if(!isSkibidiTypeQuestion && !isMythTypeQuestion) {
                    // --- MULTIPLE CHOICE LOGIC (EASY/HARD/SIGMA-MC) ---
                    
                    // --- Answer Randomization ---
                    // 1. Create a mappable array of choices with their original index
                    let choicesWithOriginalIndex = question.choices.map((text, index) => ({ text, originalIndex: index }));
                    
                    // 2. Shuffle this new array
                    shuffleArray(choicesWithOriginalIndex);

                    // 3. Find the new position of the correct answer
                    const newCorrectAnswerIndex = choicesWithOriginalIndex.findIndex(choice => choice.originalIndex === question.answer);

                    // Reset UI elements
                    answerChoices.forEach(choice => {
                        choice.classList.remove('correct', 'incorrect', 'removed');
                        choice.style.pointerEvents = 'auto';
                    });

                    // Apply Hunch logic before displaying, using the shuffled positions
                    if (playerState.historiansHunchPending) {
                        let wrongChoiceElements = [0, 1, 2, 3].filter(i => i !== newCorrectAnswerIndex);
                        shuffleArray(wrongChoiceElements);
                        const choicesToRemove = abilities.hunchUpgraded ? 2 : 1;
                        for(let i=0; i < choicesToRemove && i < wrongChoiceElements.length; i++) {
                            answerChoices[wrongChoiceElements[i]].classList.add('removed');
                            answerChoices[wrongChoiceElements[i]].style.pointerEvents = 'none';
                        }
                        playerState.historiansHunchPending = false;
                        const message = abilities.hunchUpgraded ? "Hunch Upgrade: Two wrong answers removed." : "Historian's Hunch: One wrong answer removed.";
                        updateNotification(message);
                    }

                    // 4. Populate the UI with the shuffled choices
                    answerChoices.forEach((choiceEl, index) => {
                        choiceEl.querySelector('p').textContent = choicesWithOriginalIndex[index].text;
                        // Temporarily store the new correct index on the game area for handleAnswerClick
                        gameAreaEl.dataset.correct = newCorrectAnswerIndex;
                    });
                } else { // --- TYPED ANSWER LOGIC (SKIBIDI/SIGMA-SKIBIDI) ---
                }

                // Reset hint button state
                hintBtn.disabled = false; 
                if (gameMode === 'SKIBIDI') {
                    firstLetterBtn.disabled = false;
                }

                const questionText = question.question;
                questionTextEl.textContent = questionText;
                
                // For Skibidi and Myth mode, clear and enable input/buttons
                if (isSkibidiTypeQuestion) {
                    skibidiInputEl.value = '';
                    skibidiInputEl.disabled = false;
                    skibidiInputEl.focus();
                }
                
                adjustFontSize(questionTextEl);

                gameAreaEl.classList.remove('switching');

                // Update progress AFTER the question has been shifted from the array.
                updateSigmaProgress();
            }, 300);
        }

        function normalizeAnswer(answer) {
            return answer.toLowerCase().trim().replace(/[.,\/#!$%\^&\*;:{}=\-_`~()]/g,"");
        }
        
        function handleSkibidiSubmit(e) {
            e.preventDefault();
            const userAnswer = skibidiInputEl.value;
            if (!userAnswer) return;

            const question = activeQuestionSet[currentQuestionIndex]; // This is correct
            const correctAnswers = Array.isArray(question.answer) ? question.answer : [question.answer];
            const isCorrect = correctAnswers.some(ans => normalizeAnswer(userAnswer) === normalizeAnswer(ans));

            skibidiInputEl.disabled = true;
            // Disable hint buttons after answering
            hintBtn.disabled = true;
            firstLetterBtn.disabled = true;
            
            handleAnswer(isCorrect, null);
        }
        

        function handleAnswerClick(e) {
            const selectedChoiceEl = e.currentTarget;
            const selectedAnswer = parseInt(selectedChoiceEl.dataset.choice);
            // Retrieve the correct answer's current position from the dataset
            const correctAnswer = parseInt(gameAreaEl.dataset.correct);

            // Disable hint buttons after answering
            hintBtn.disabled = true;
            firstLetterBtn.disabled = true;

            answerChoices.forEach(choice => choice.style.pointerEvents = 'none');
            selectedChoiceEl.classList.add(selectedAnswer === correctAnswer ? 'correct' : 'incorrect');
            if(selectedAnswer !== correctAnswer) {
                 answerChoices[correctAnswer].classList.add('correct');
            }

            handleAnswer(selectedAnswer === correctAnswer, selectedChoiceEl, selectedChoiceEl.querySelector('p').textContent);
        }

        function handleMythAnswerClick(e) {
            const selectedButton = e.currentTarget;
            const userAnswerIsFact = selectedButton.id === 'factBtn';

            // Disable buttons to prevent double-clicking
            factBtn.disabled = true;
            mythBtn.disabled = true;

            const question = activeQuestionSet[currentQuestionIndex];
            const isCorrect = userAnswerIsFact === question.isFact;

            // Highlight correct/incorrect
            selectedButton.classList.add(isCorrect ? 'correct' : 'incorrect');
            if (!isCorrect) {
                const correctButton = question.isFact ? factBtn : mythBtn;
                correctButton.classList.add('correct');
            }
            handleAnswer(isCorrect, null); // Pass null for selectedChoiceEl as it's not a standard MC
            showExplanation(question.explanation); // Always show explanation in Myth mode
        }

        function showExplanation(explanation, isCorrect) {
            isGamePaused = true;
            explanationTextEl.textContent = explanation;
            explanationModal.classList.remove('hidden');
        }

        function handleAnswer(isCorrect, selectedChoiceEl) {
            let proceedToNextQuestionAutomatically = true;
            playerState.questionsAnswered++; 
            const isSkibidi = gameMode === 'SKIBIDI';
            const hunchThreshold = isSkibidi ? 3 : 5;
            const tinkerThreshold = isSkibidi ? 2 : 4;
            const skipThreshold = isSkibidi ? 2 : 3;
            const redoThreshold = isSkibidi ? 3 : 5;
            const boostThreshold = isSkibidi ? 4 : 7;

            // Update Score Boost button text and fill
            const boost3xThreshold = isSkibidi ? 6 : 10;
            const nextBoostThreshold = abilities.boost2xActive ? boost3xThreshold : boostThreshold;
            const boostText = abilities.boost3xActive ? '3x BOOST' : (abilities.boost2xActive ? '2x BOOST (Next: 3x)' : '2x BOOST');
            abilityBoostEl.querySelector('span').textContent = boostText;


            if (isCorrect) {
                // Add time in SIGMA mode
                if (gameMode === 'SIGMA') {
                    let timeToAdd = 15; // Default for stage 1
                    if (sigmaStage === 2) timeToAdd = 20;
                    if (sigmaStage === 3) timeToAdd = 25;
                    timeLeft += timeToAdd;
                    sigmaCorrectInStage++;
                    timeCardEl.classList.add('flash-green');
                    setTimeout(() => timeCardEl.classList.remove('flash-green'), 1000);
                } else if (isSkibidi) {
                    // This is for the original skibidi mode, not sigma skibidi stage
                    // No time is added here.
                }

                if(skibidiFormEl.style.display !== 'none') skibidiInputEl.classList.add('correct');
                playerState.correctAnswers++;
                playerState.wrongStreak = 0;
                
                let basePoints = abilities.loreMasterActive ? 1.25 : 1;
                let pointsToAdd;

                if (abilities.boost3xActive) {
                    pointsToAdd = basePoints * 3;
                } else if (abilities.boost2xActive) {
                    pointsToAdd = basePoints * 2;
                } else {
                    pointsToAdd = basePoints;
                }

                playerState.score += pointsToAdd; // Always update the actual score
                scoreEl.textContent = Number(playerState.score.toFixed(2)).toString().replace(/\.00$/, ''); // Then update the display
                correctAnswersEl.textContent = playerState.correctAnswers;
                
                if (!isSkibidi && playerState.correctAnswers > 0 && playerState.correctAnswers % hunchThreshold === 0) {
                    playerState.historiansHunchPending = true;
                }

                playerState.streak++;
                streakEl.textContent = playerState.streak;
                
                let specialEventOccurred = false;
                if (playerState.streak === skipThreshold && !playerState.earned3Streak) {
                    abilities.skip++;
                    playerState.earned3Streak = true;
                    addNotification({ type: 'streak', text: "You earned a SKIP!" });
                    specialEventOccurred = true;
                } else if (playerState.streak === tinkerThreshold && !playerState.earned4Streak) {
                    timeLeft += 15;
                    timeCardEl.classList.add('flash-green');
                    setTimeout(() => timeCardEl.classList.remove('flash-green'), 1000);
                    playerState.earned4Streak = true;
                    addNotification({ type: 'streak', text: "TIME BONUS! +15 Seconds!" });
                    specialEventOccurred = true;
                } else if (playerState.streak === redoThreshold && !playerState.earned5Streak) {
                    abilities.redo++;
                    playerState.earned5Streak = true;
                    addNotification({ type: 'streak', text: "You earned a SECOND CHANCE!" });
                    specialEventOccurred = true;
                } else if (playerState.streak === boostThreshold && !abilities.boost2xActive) {
                    abilities.boost2xActive = true;
                    playerState.earned7Streak = true;
                    addNotification({ type: 'streak', text: "2x SCORE BOOST is active!" });
                    specialEventOccurred = true;
                } else if (playerState.streak === boost3xThreshold && !abilities.boost3xActive) {
                    abilities.boost3xActive = true;
                    playerState.earned10Streak = true;
                    addNotification({ type: 'streak', text: "UPGRADE! 3x SCORE BOOST is active!" });
                    specialEventOccurred = true;
                }

                // New Panther Buck Streak Logic
                const buckStreakThreshold = gameMode === 'HARD' ? 7 : (isSkibidi ? 5 : 10);
                if (playerState.streak > 0 && playerState.streak % buckStreakThreshold === 0 && !playerState.pantherBucksAwardedForStreaks.includes(playerState.streak)) {
                    playerState.pantherBucksEarned++;
                    playerState.pantherBucksAwardedForStreaks.push(playerState.streak);
                    addNotification({ type: 'pantherBuck' });
                    updateNotification(`A ${playerState.streak}-streak earned you a Panther Buck!`);
                    specialEventOccurred = true; // This ensures the panther buck modal shows
                }

                if (!specialEventOccurred && notificationQueue.length === 0) {
                    playCorrectSound();
                    triggerConfetti();
                }

                if (abilities.skip > 0) updateNotification("SKIP ability is ready to use.");
                // This notification is no longer relevant with the new streak-based system.
                // else if (buckThreshold - playerState.pantherBuckProgress === 1) updateNotification("One more for a Panther Buck!");
                else if (playerState.streak === 2) updateNotification("Great! That's two in a row.");
                else if (playerState.streak === 6) updateNotification("Incredible 6-question streak!");
                else {
                    const randomMessage = correctMessages[Math.floor(Math.random() * correctMessages.length)];
                    updateNotification(randomMessage);
                }

                if (gameMode === 'SKIBIDI' && !abilities.firstLastLetterUpgraded && playerState.score >= 5) {
                    updateNotification("You can afford Letter Insight in the store!");
                }

            } else { // If the answer is INCORRECT
                playIncorrectSound();
                document.body.classList.add('red-flash');

                // Store the index of the incorrect question, preventing duplicates
                if (currentQuestionIndex !== -1 && !wrongAnswers.includes(currentQuestionIndex)) {
                    wrongAnswers.push(currentQuestionIndex);
                }

                // Streak Insurance Check
                if (abilities.streakInsurance) {
                    abilities.streakInsurance = false; // Use up the insurance
                    updateNotification("Streak Insurance saved your streak!");
                } else {
                    playerState.streak = 0;
                    playerState.earned3Streak = false;
                    playerState.earned4Streak = false;
                    playerState.earned5Streak = false;
                    playerState.earned7Streak = false;
                    playerState.earned10Streak = false;
                    // Resetting streak also means they can earn panther bucks again for those streaks if they reach them.
                    if (abilities.boost2xActive || abilities.boost3xActive) {
                        abilities.boost2xActive = abilities.boost3xActive = false;
                        updateNotification("2x Boost lost! Be careful.");
                    }
                }

                playerState.wrongStreak++;
                streakEl.textContent = playerState.streak;
                
                if (playerState.wrongStreak === 2 && gameMode !== 'MYTH') playerState.wrongStreak = 0; // Only reset wrong streak for non-myth modes
                
                headerGridEl.classList.add('shake');
                gameAreaEl.classList.add('shake');
                
                if (!skibidiFormEl.classList.contains('hidden')) { // Check if it's a typed-answer question
                    proceedToNextQuestionAutomatically = false; // Stop the automatic next question
                    skibidiInputEl.classList.add('incorrect');
                    updateNotification("Incorrect. Review the answer below.");
                    
                    // Show the modal with the correct answer
                    const question = activeQuestionSet[currentQuestionIndex];
                    if (!question) { // Fallback if question is somehow undefined
                        updateNotification("Error: Question not found for review.");
                        return;
                    }
                    const correctAnswer = Array.isArray(question.answer) ? question.answer.join(' / ') : question.answer;
                    skibidiCorrectAnswerTextEl.textContent = correctAnswer;
                    skibidiIncorrectModal.classList.remove('hidden');
                } else {
                    updateNotification("Incorrect. Don't lose focus!");
                }
                
                setTimeout(() => {
                    headerGridEl.classList.remove('shake');
                    gameAreaEl.classList.remove('shake');
                    document.body.classList.remove('red-flash');
                    if(!skibidiFormEl.classList.contains('hidden')) {
                        skibidiInputEl.classList.remove('correct', 'incorrect');
                    }
                }, 500);
            }
            
            updateAbilitiesUI();
            if (proceedToNextQuestionAutomatically && gameMode !== 'MYTH') { // Do not auto-proceed in Myth mode
                setTimeout(displayNextQuestion, 2000);
            }
        }

        function endGame() {
            if (!timerInterval && endGameModal.classList.contains('hidden')) return;
            clearInterval(timerInterval);
            clearInterval(storeNotificationInterval);
            timerInterval = null;
            isGamePaused = true;
            timerEl.textContent = "00:00";
            finalScoreEl.textContent = Math.floor(playerState.score);

            if (wrongAnswers.length > 0) {
                mistakesReviewTextEl.textContent = `You made ${wrongAnswers.length} mistake(s).`;
                reviewMistakesBtn.classList.remove('hidden');
            } else {
                mistakesReviewTextEl.textContent = "You made 0 mistakes. Perfect game!";
                reviewMistakesBtn.classList.add('hidden');
            }

            endGameModal.classList.remove('hidden');
        }


        function setupNewTurn() {
            if(timerInterval) clearInterval(timerInterval);
            if(storeNotificationInterval) clearInterval(storeNotificationInterval);
            timeLeft = 300;
            timerEl.textContent = "05:00";
            endGameModal.classList.add('hidden');
            difficultyModal.classList.remove('hidden'); // Go back to difficulty select
            gradeModal.classList.add('hidden');
            reviewModal.classList.add('hidden');
            scoreEl.textContent = '0';
            streakEl.textContent = '0';
            sigmaProgressContainer.classList.add('hidden');
            correctAnswersEl.textContent = '0';
            questionTextEl.textContent = 'Choose your difficulty to begin!';
            
            if(gameMode !== 'SKIBIDI') {
                answerChoices.forEach(choice => { 
                    choice.querySelector('p').textContent = '';
                    choice.classList.remove('correct', 'incorrect');
                });
            } else {
                // Reset store buttons to their default state on a new turn
                buyBtns.forEach(btn => {
                    btn.disabled = false;
                    btn.classList.remove('purchased');
                    const itemName = btn.dataset.item;
                    if (storeItems[itemName]) {
                        btn.textContent = `Buy (${storeItems[itemName].cost} Pts)`;
                    }
                });
                skibidiInputEl.value = '';
            }

            resetPlayerState();
            updateAbilitiesUI();
            storeBtn.classList.remove('store-ready');
            updateNotification("Welcome! Choose your difficulty to begin.");
        }
        
        function resetAllData() {
            playClickSound();
            resetConfirmModal.classList.add('hidden');
            setupNewTurn();
        }

        function showHint() {
            playClickSound();
            if (currentQuestionIndex > -1) {
                if (abilities.diplomatsPass) {
                    abilities.diplomatsPass = false;
                    updateNotification("Diplomat's Pass used! The timer will not pause.");
                } else {
                    isGamePaused = true;
                }
                const hint = activeQuestionSet[currentQuestionIndex].hint;
                hintTextEl.textContent = hint;
                hintModal.classList.remove('hidden');
            }
        }

        function showFirstLetters() {
            playClickSound();
            const currentQuestion = activeQuestionSet[currentQuestionIndex];
            const isSkibidiTypeQuestion = currentQuestion && !currentQuestion.choices;

            if (currentQuestionIndex > -1 && isSkibidiTypeQuestion) {
                isGamePaused = true;
                const question = activeQuestionSet[currentQuestionIndex];
                // Use the first answer in the array if multiple are possible
                const answer = (Array.isArray(question.answer) ? question.answer[0] : question.answer).trim();
                let hintText;
                if (abilities.firstLastLetterUpgraded) {
                    const first = answer.charAt(0);
                    const last = answer.length > 1 ? answer.charAt(answer.length - 1) : '';
                    hintText = `${first}...${last}`;
                } else {
                    hintText = answer.split(' ').map(word => word.charAt(0)).join(' ');
                }
                firstLetterTextEl.textContent = hintText;
                firstLetterModal.classList.remove('hidden');
            }
        }

        function showHelpModal() {
            playClickSound();
            isGamePaused = true;
            const isSkibidi = gameMode === 'SKIBIDI';

            // Clear existing content
            const helpContainer = document.getElementById('helpContentContainer');
            helpContainer.innerHTML = '';

            // Set title
            abilityInfoModal.querySelector('h2').textContent = "Help Center";

            // Generate content based on game mode
            const helpContent = `
                <div class="grid md:grid-cols-2 gap-4 text-base">
                    <div class="bg-slate-100 p-4 rounded-lg border-2 border-slate-300">
                        <h3 class="font-bold text-lg mb-2 text-blue-600">üéØ Game Goal</h3>
                        <p>Answer as many questions as you can before the timer runs out! Correct answers earn points, and streaks unlock special abilities.</p>
                    </div>
                    <div class="bg-slate-100 p-4 rounded-lg border-2 border-slate-300">
                        <h3 class="font-bold text-lg mb-2 text-yellow-600">üõçÔ∏è The Store</h3>
                        <p>Click the "Store" button to spend points on powerful one-time items and permanent upgrades to help you in your game.</p>
                    </div>
                    <div class="bg-slate-100 p-4 rounded-lg border-2 border-slate-300 ${isSkibidi ? '' : 'md:col-span-2'}">
                        <h3 class="font-bold text-lg mb-2 text-orange-600">${isSkibidi ? '‚å®Ô∏è Skibidi Mode' : '‚ùì Hints'}</h3>
                        ${isSkibidi ? `
                        <ul class="list-disc list-inside space-y-1">
                            <li><strong>Type Your Answers:</strong> No multiple choice! Spelling counts.</li>
                            <li><strong>Letter Hints:</strong> Use the 'A_' button to see the first letter(s) of the answer.</li>
                            <li><strong>Faster Abilities:</strong> All streak and correct-answer requirements are reduced!</li>
                        </ul>
                        ` : `
                        <p>Click the <strong>'?' button</strong> below the question to get a clue. Be careful, the timer will pause while the hint is open unless you have a special item from the store!</p>
                        `}
                    </div>
                    <div class="bg-slate-100 p-4 rounded-lg border-2 border-slate-300 ${isSkibidi ? '' : 'md:col-span-2'}">
                        <h3 class="font-bold text-lg mb-2 text-purple-600">‚ö° Abilities</h3>
                        <p class="mb-2">Abilities are earned through streaks and total correct answers. They are divided into Passive (automatic) and Active (clickable) types.</p>
                        <ul class="list-disc list-inside space-y-1">
                            <li><strong>Time Tinkerer (Passive):</strong> Get a <strong>${isSkibidi ? '2' : '4'}-streak</strong> to add <strong>15 seconds</strong> to the clock.</li>
                            ${!isSkibidi ? `<li><strong>Historian's Hunch (Passive):</strong> For every <strong>5 correct answers</strong>, one wrong choice is removed on the next question.</li>` : ''}
                            <li><strong>Panther Bucks (Streak-Based):</strong> Earn a Panther Buck for achieving a <strong>${gameMode === 'HARD' ? '7' : (isSkibidi ? '5' : '10')}-streak</strong>!</li>
                            <li><strong>SKIP (Active):</strong> Earned at a <strong>${isSkibidi ? '2' : '3'}-streak</strong>. Click to skip a hard question.</li>
                            <li><strong>REDO (Active):</strong> Earned at a <strong>${isSkibidi ? '3' : '5'}-streak</strong>. Brings back all your wrong answers for another try.</li>
                            <li><strong>2x BOOST (Active):</strong> Earned at a <strong>${isSkibidi ? '4' : '7'}-streak</strong>. Doubles your points until you get one wrong.</li>
                        </ul>
                    </div>
                </div>
            `;
            helpContainer.innerHTML = helpContent;
            abilityInfoModal.classList.remove('hidden');
        }

        // --- REVIEW MISTAKES LOGIC ---
        function openReviewModal() {
            playClickSound();
            if (wrongAnswers.length === 0) return;
            reviewIndex = 0;
            endGameModal.classList.add('hidden');
            reviewModal.classList.remove('hidden');
            displayReviewQuestion();
        }

        function displayReviewQuestion() {
            const questionIndex = wrongAnswers[reviewIndex];
            const question = activeQuestionSet[questionIndex];
            
            document.getElementById('reviewCounter').textContent = `${reviewIndex + 1} / ${wrongAnswers.length}`;
            reviewQuestionEl.textContent = question.question;
            reviewChoicesEl.innerHTML = ''; // Clear previous choices

            if (gameMode === 'MYTH') {
                reviewUserAnswerEl.classList.add('hidden');
                const correctAnswerText = question.isFact ? 'Fact' : 'Myth';
                reviewChoicesEl.innerHTML = `
                    <div class="p-3 rounded-lg bg-green-200 border-2 border-green-700 text-green-800 font-bold">Correct Answer: ${correctAnswerText}</div>
                    <div class="p-3 mt-2 rounded-lg bg-yellow-100 border-2 border-yellow-400 text-yellow-800">${question.explanation}</div>
                `;
            } else if (!question.choices) { // Check if it's a skibidi-type question
                reviewUserAnswerEl.classList.add('hidden'); // Not tracking user's typed answer for now
                const correctAnswerText = Array.isArray(question.answer) ? question.answer.join(' / ') : question.answer;
                reviewChoicesEl.innerHTML = `<div class="p-3 rounded-lg bg-green-200 border-2 border-green-700 text-green-800 font-bold">Correct Answer: ${correctAnswerText}</div>`;
            } else { // Standard multiple-choice question
                reviewUserAnswerEl.classList.add('hidden'); // Not tracking user's choice for now
                question.choices.forEach((choiceText, index) => {
                    const choiceDiv = document.createElement('div');
                    choiceDiv.textContent = choiceText;
                    choiceDiv.className = 'p-3 rounded-lg border-2';
                    if (index === question.answer) {
                        choiceDiv.classList.add('bg-green-200', 'border-green-700', 'text-green-800', 'font-bold');
                    } else {
                        choiceDiv.classList.add('bg-gray-100', 'border-gray-400');
                    }
                    reviewChoicesEl.appendChild(choiceDiv);
                });
            }

            prevReviewBtn.disabled = reviewIndex === 0;
            nextReviewBtn.disabled = reviewIndex === wrongAnswers.length - 1;
        }




        // --- EVENT LISTENERS ---
        easyModeBtn.addEventListener('click', () => {
            playClickSound();
            gameMode = 'EASY';
            difficultyModal.classList.add('hidden');
            easyRulesModal.classList.remove('hidden');
        });
        hardModeBtn.addEventListener('click', () => {
            playClickSound();
            gameMode = 'HARD';
            difficultyModal.classList.add('hidden');
            hardRulesModal.classList.remove('hidden');
        });

        acceptEasyBtn.addEventListener('click', () => {
            playClickSound();
            easyRulesModal.classList.add('hidden');
            gradeModal.classList.remove('hidden');
        });
        declineEasyBtn.addEventListener('click', () => {
            playClickSound();
            easyRulesModal.classList.add('hidden');
            difficultyModal.classList.remove('hidden');
        });
        acceptHardBtn.addEventListener('click', () => {
            playClickSound();
            hardRulesModal.classList.add('hidden');
            gradeModal.classList.remove('hidden');
        });
        declineHardBtn.addEventListener('click', () => {
            playClickSound();
            hardRulesModal.classList.add('hidden');
            difficultyModal.classList.remove('hidden');
        });
        skibidiModeBtn.addEventListener('click', () => {
            playClickSound();
            gameMode = 'SKIBIDI';
            difficultyModal.classList.add('hidden');
            skibidiRulesModal.classList.remove('hidden');
        });

        sigmaModeBtn.addEventListener('click', () => {
            playClickSound();
            gameMode = 'SIGMA';
            difficultyModal.classList.add('hidden');
            sigmaRulesModal.classList.remove('hidden');
        });
        acceptSigmaBtn.addEventListener('click', () => {
            playClickSound();
            sigmaRulesModal.classList.add('hidden');
            gradeModal.classList.remove('hidden');
        });
        declineSigmaBtn.addEventListener('click', () => {
            playClickSound();
            sigmaRulesModal.classList.add('hidden');
            difficultyModal.classList.remove('hidden');
        });

        acceptSkibidiBtn.addEventListener('click', () => {
            playClickSound();
            skibidiRulesModal.classList.add('hidden');
            gradeModal.classList.remove('hidden');
        });
        declineSkibidiBtn.addEventListener('click', () => {
            playClickSound();
            skibidiRulesModal.classList.add('hidden');
            difficultyModal.classList.remove('hidden');
        });
        
        mythModeBtn.addEventListener('click', () => {
            playClickSound();
            gameMode = 'MYTH';
            difficultyModal.classList.add('hidden');
            mythRulesModal.classList.remove('hidden');
        });
        acceptMythBtn.addEventListener('click', () => {
            playClickSound();
            mythRulesModal.classList.add('hidden');
            gradeModal.classList.remove('hidden');
        });
        declineMythBtn.addEventListener('click', () => {
            playClickSound();
            mythRulesModal.classList.add('hidden');
            difficultyModal.classList.remove('hidden');
        });

        backToDifficultyBtn.addEventListener('click', () => {
            playClickSound();
            gradeModal.classList.add('hidden');
            difficultyModal.classList.remove('hidden');
        });


        startGameBtn.addEventListener('click', startGame);
        newGameBtn.addEventListener('click', () => { playClickSound(); setupNewTurn(); });
        reviewMistakesBtn.addEventListener('click', openReviewModal);
        closeReviewBtn.addEventListener('click', () => {
            playClickSound();
            reviewModal.classList.add('hidden');
            endGameModal.classList.remove('hidden'); // Show end game modal again
        });
        nextReviewBtn.addEventListener('click', () => {
            playClickSound();
            if (reviewIndex < wrongAnswers.length - 1) { reviewIndex++; displayReviewQuestion(); }
        });
        prevReviewBtn.addEventListener('click', () => {
            playClickSound();
            if (reviewIndex > 0) { reviewIndex--; displayReviewQuestion(); }
        });
        storeBtn.addEventListener('click', openStore);
        endTurnBtn.addEventListener('click', () => { playClickSound(); endGame(); });
        resetAllBtn.addEventListener('click', () => { playClickSound(); resetConfirmModal.classList.remove('hidden'); });
        aboutBtn.addEventListener('click', () => { playClickSound(); aboutModal.classList.remove('hidden'); });
        hintBtn.addEventListener('click', showHint);
        closeAboutBtn.addEventListener('click', () => { playClickSound(); aboutModal.classList.add('hidden'); });
        confirmResetBtn.addEventListener('click', resetAllData);
        cancelResetBtn.addEventListener('click', () => { playClickSound(); resetConfirmModal.classList.add('hidden'); });
        
        // Settings Modal Listeners
        settingsBtn.addEventListener('click', () => {
            playClickSound();
            isGamePaused = true;
            settingsModal.classList.remove('hidden');
        });
        closeSettingsBtn.addEventListener('click', () => {
            playClickSound();
            settingsModal.classList.add('hidden');
            if (timerInterval) isGamePaused = false;
        });
        soundToggle.addEventListener('click', () => {
            isMuted = !isMuted;
            soundToggle.classList.toggle('bg-green-500', !isMuted);
            soundToggle.classList.toggle('bg-gray-300', isMuted);
            document.getElementById('soundToggleKnob').classList.toggle('translate-x-6', !isMuted);
            document.getElementById('soundToggleKnob').classList.toggle('translate-x-1', isMuted);
            if (!isMuted) playClickSound();
        });

        closeHintBtn.addEventListener('click', () => { 
            playClickSound(); 
            hintModal.classList.add('hidden');
            if (timerInterval) isGamePaused = false;
        });
        closeExplanationBtn.addEventListener('click', () => {
            playClickSound();
            explanationModal.classList.add('hidden');
            displayNextQuestion(); // Move to the next question after closing the explanation
        });
        closeStreakBtn.addEventListener('click', () => { 
            playClickSound(); 
            streakModal.classList.add('hidden');
            isModalActive = false;
            processNotificationQueue();
        });
        firstLetterBtn.addEventListener('click', showFirstLetters);
        closeFirstLetterBtn.addEventListener('click', () => {
            playClickSound();
            firstLetterModal.classList.add('hidden');
            isGamePaused = false;
        });
        answerChoices.forEach(choice => choice.addEventListener('click', handleAnswerClick));
        factBtn.addEventListener('click', handleMythAnswerClick);
        mythBtn.addEventListener('click', handleMythAnswerClick);
        skibidiFormEl.addEventListener('submit', handleSkibidiSubmit);
        
        // Listener for the new Skibidi incorrect modal
        closeSkibidiIncorrectBtn.addEventListener('click', () => {
            playClickSound();
            skibidiIncorrectModal.classList.add('hidden');
            displayNextQuestion(); // Proceed to the next question only after closing the modal
        });
        
        closeSigmaStageUpBtn.addEventListener('click', () => {
            playClickSound();
            sigmaStageUpModal.classList.add('hidden');
            isGamePaused = false;
            updateNotification(`Stage ${sigmaStage} has begun. Good luck!`);
        });

        // Store Listeners
        closeStoreBtn.addEventListener('click', () => { playClickSound(); storeModal.classList.add('hidden'); });
        buyBtns.forEach(btn => btn.addEventListener('click', buyItem));

        // Ability Listeners
        abilitySkipEl.addEventListener('click', activateSkip);
        abilityRedoEl.addEventListener('click', activateRedo);
        abilityInfoBtn.addEventListener('click', showHelpModal);
        closeAbilityInfoBtn.addEventListener('click', () => { 
            playClickSound(); 
            abilityInfoModal.classList.add('hidden');
            // Only unpause if the game is actually running and not showing another modal
            if (timerInterval) isGamePaused = false;
        });
        closePantherBuckBtn.addEventListener('click', () => { 
            playClickSound(); 
            pantherBuckModal.classList.add('hidden');
            isModalActive = false;
            processNotificationQueue();
        });

        // Initial setup
        updateNotification("Welcome! Choose your difficulty to begin.");

        window.addEventListener('resize', () => {
            if (currentQuestionIndex > -1) {
                adjustFontSize(questionTextEl);
            }
        });
    </script>
</body>
</html>
